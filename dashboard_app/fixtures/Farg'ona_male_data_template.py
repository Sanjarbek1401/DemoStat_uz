import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_region, _ = Region.objects.get_or_create(name='Farg\'ona', defaults={'svg_id': 'fergana'})

# Data to be imported
navoi_male_data =[
  {
    "Age": "Total",
    "2022": "1964628",
    "2023": "2003640",
    "2024": "2042172",
    "2025": "2079924",
    "2026": "2116961",
    "2027": "2153306",
    "2028": "2188890",
    "2029": "2223703",
    "2030": "2257483",
    "2031": "2290101",
    "2032": "2321392",
    "2033": "2351351",
    "2034": "2380039",
    "2035": "2407359",
    "2036": "2433529",
    "2037": "2458530",
    "2038": "2482629",
    "2039": "2505955",
    "2040": "2528724",
    "2041": "2551206",
    "2042": "2573748",
    "2043": "2596567",
    "2044": "2619750",
    "2045": "2643327",
    "2046": "2667410",
    "2047": "2691958",
    "2048": "2716912",
    "2049": "2742202",
    "2050": "2767702"
  },
  {
    "Age": "0-4",
    "2022": "223244",
    "2023": "234668",
    "2024": "242767",
    "2025": "247667",
    "2026": "248903",
    "2027": "247714",
    "2028": "246464",
    "2029": "244790",
    "2030": "242773",
    "2031": "240232",
    "2032": "237000",
    "2033": "233155",
    "2034": "228784",
    "2035": "224028",
    "2036": "219242",
    "2037": "214600",
    "2038": "210367",
    "2039": "206632",
    "2040": "203718",
    "2041": "201687",
    "2042": "200870",
    "2043": "201230",
    "2044": "202704",
    "2045": "205125",
    "2046": "208328",
    "2047": "211936",
    "2048": "215662",
    "2049": "219372",
    "2050": "222900"
  },
  {
    "Age": "5-9",
    "2022": "190056",
    "2023": "194193",
    "2024": "198539",
    "2025": "204063",
    "2026": "211823",
    "2027": "221948",
    "2028": "233216",
    "2029": "241204",
    "2030": "246050",
    "2031": "247285",
    "2032": "246131",
    "2033": "244928",
    "2034": "243308",
    "2035": "241353",
    "2036": "238883",
    "2037": "235732",
    "2038": "231977",
    "2039": "227700",
    "2040": "223044",
    "2041": "218357",
    "2042": "213811",
    "2043": "209668",
    "2044": "206014",
    "2045": "203171",
    "2046": "201197",
    "2047": "200423",
    "2048": "200811",
    "2049": "202297",
    "2050": "204719"
  },
  {
    "Age": "10-14",
    "2022": "175473",
    "2023": "174031",
    "2024": "176900",
    "2025": "180431",
    "2026": "184081",
    "2027": "189277",
    "2028": "193357",
    "2029": "197649",
    "2030": "203107",
    "2031": "210778",
    "2032": "220795",
    "2033": "231957",
    "2034": "239874",
    "2035": "244691",
    "2036": "245937",
    "2037": "244819",
    "2038": "243661",
    "2039": "242089",
    "2040": "240186",
    "2041": "237775",
    "2042": "234690",
    "2043": "231007",
    "2044": "226809",
    "2045": "222233",
    "2046": "217627",
    "2047": "213158",
    "2048": "209087",
    "2049": "205498",
    "2050": "202710"
  },
  {
    "Age": "15-19",
    "2022": "144093",
    "2023": "150970",
    "2024": "158396",
    "2025": "163107",
    "2026": "170421",
    "2027": "174596",
    "2028": "173142",
    "2029": "175991",
    "2030": "179491",
    "2031": "183111",
    "2032": "188268",
    "2033": "192308",
    "2034": "196564",
    "2035": "201979",
    "2036": "209589",
    "2037": "219523",
    "2038": "230592",
    "2039": "238441",
    "2040": "243228",
    "2041": "244484",
    "2042": "243404",
    "2043": "242291",
    "2044": "240767",
    "2045": "238918",
    "2046": "236564",
    "2047": "233543",
    "2048": "229928",
    "2049": "225802",
    "2050": "221300"
  },
  {
    "Age": "20-24",
    "2022": "144565",
    "2023": "140096",
    "2024": "136244",
    "2025": "137984",
    "2026": "139716",
    "2027": "143578",
    "2028": "150351",
    "2029": "157665",
    "2030": "162285",
    "2031": "169495",
    "2032": "173610",
    "2033": "172166",
    "2034": "175008",
    "2035": "178484",
    "2036": "182072",
    "2037": "187176",
    "2038": "191164",
    "2039": "195375",
    "2040": "200737",
    "2041": "208268",
    "2042": "218085",
    "2043": "229019",
    "2044": "236768",
    "2045": "241513",
    "2046": "242786",
    "2047": "241762",
    "2048": "240716",
    "2049": "239263",
    "2050": "237487"
  },
  {
    "Age": "25-29",
    "2022": "183901",
    "2023": "178266",
    "2024": "170972",
    "2025": "163172",
    "2026": "152697",
    "2027": "144143",
    "2028": "139834",
    "2029": "136084",
    "2030": "137842",
    "2031": "139545",
    "2032": "143333",
    "2033": "149982",
    "2034": "157158",
    "2035": "161665",
    "2036": "168755",
    "2037": "172811",
    "2038": "171390",
    "2039": "174228",
    "2040": "177673",
    "2041": "181217",
    "2042": "186256",
    "2043": "190185",
    "2044": "194347",
    "2045": "199642",
    "2046": "207067",
    "2047": "216729",
    "2048": "227493",
    "2049": "235124",
    "2050": "239824"
  },
  {
    "Age": "30-34",
    "2022": "171762",
    "2023": "176171",
    "2024": "178749",
    "2025": "182358",
    "2026": "184785",
    "2027": "181952",
    "2028": "176470",
    "2029": "169392",
    "2030": "161853",
    "2031": "151687",
    "2032": "143401",
    "2033": "139274",
    "2034": "135639",
    "2035": "137418",
    "2036": "139098",
    "2037": "142813",
    "2038": "149335",
    "2039": "156374",
    "2040": "160775",
    "2041": "167750",
    "2042": "171757",
    "2043": "170372",
    "2044": "173208",
    "2045": "176622",
    "2046": "180127",
    "2047": "185110",
    "2048": "188989",
    "2049": "193103",
    "2050": "198325"
  },
  {
    "Age": "35-39",
    "2022": "146098",
    "2023": "153230",
    "2024": "159783",
    "2025": "162537",
    "2026": "165318",
    "2027": "169310",
    "2028": "173593",
    "2029": "176086",
    "2030": "179616",
    "2031": "182023",
    "2032": "179299",
    "2033": "174019",
    "2034": "167191",
    "2035": "159935",
    "2036": "150090",
    "2037": "142078",
    "2038": "138135",
    "2039": "134617",
    "2040": "136418",
    "2041": "138079",
    "2042": "141729",
    "2043": "148131",
    "2044": "155040",
    "2045": "159346",
    "2046": "166216",
    "2047": "170183",
    "2048": "168841",
    "2049": "171678",
    "2050": "175063"
  },
  {
    "Age": "40-44",
    "2022": "122606",
    "2023": "125136",
    "2024": "128436",
    "2025": "131127",
    "2026": "137002",
    "2027": "143702",
    "2028": "150630",
    "2029": "157022",
    "2030": "159702",
    "2031": "162427",
    "2032": "166343",
    "2033": "170552",
    "2034": "173008",
    "2035": "176497",
    "2036": "178913",
    "2037": "176311",
    "2038": "171230",
    "2039": "164640",
    "2040": "157641",
    "2041": "148090",
    "2042": "140322",
    "2043": "136541",
    "2044": "133131",
    "2045": "134950",
    "2046": "136602",
    "2047": "140198",
    "2048": "146498",
    "2049": "153295",
    "2050": "157526"
  },
  {
    "Age": "45-49",
    "2022": "112602",
    "2023": "112657",
    "2024": "113426",
    "2025": "116762",
    "2026": "118951",
    "2027": "120154",
    "2028": "122621",
    "2029": "125850",
    "2030": "128481",
    "2031": "134227",
    "2032": "140772",
    "2033": "147540",
    "2034": "153805",
    "2035": "156437",
    "2036": "159135",
    "2037": "163004",
    "2038": "167164",
    "2039": "169606",
    "2040": "173060",
    "2041": "175482",
    "2042": "172999",
    "2043": "168107",
    "2044": "161740",
    "2045": "154979",
    "2046": "145709",
    "2047": "138177",
    "2048": "134553",
    "2049": "131254",
    "2050": "133095"
  },
  {
    "Age": "50-54",
    "2022": "97155",
    "2023": "100764",
    "2024": "103320",
    "2025": "105967",
    "2026": "107258",
    "2027": "109352",
    "2028": "109424",
    "2029": "110198",
    "2030": "113468",
    "2031": "115619",
    "2032": "116823",
    "2033": "119250",
    "2034": "122423",
    "2035": "125018",
    "2036": "130642",
    "2037": "137035",
    "2038": "143643",
    "2039": "149777",
    "2040": "152367",
    "2041": "155042",
    "2042": "158869",
    "2043": "162984",
    "2044": "165420",
    "2045": "168833",
    "2046": "171260",
    "2047": "168909",
    "2048": "164222",
    "2049": "158093",
    "2050": "151581"
  },
  {
    "Age": "55-59",
    "2022": "86208",
    "2023": "86582",
    "2024": "87892",
    "2025": "88751",
    "2026": "90514",
    "2027": "92909",
    "2028": "96388",
    "2029": "98870",
    "2030": "101426",
    "2031": "102699",
    "2032": "104768",
    "2033": "104899",
    "2034": "105708",
    "2035": "108917",
    "2036": "111038",
    "2037": "112265",
    "2038": "114653",
    "2039": "117769",
    "2040": "120338",
    "2041": "125817",
    "2042": "132030",
    "2043": "138439",
    "2044": "144408",
    "2045": "146947",
    "2046": "149599",
    "2047": "153381",
    "2048": "157442",
    "2049": "159876",
    "2050": "163225"
  },
  {
    "Age": "60-64",
    "2022": "72650",
    "2023": "76244",
    "2024": "77661",
    "2025": "78935",
    "2026": "79621",
    "2027": "79942",
    "2028": "80352",
    "2029": "81654",
    "2030": "82514",
    "2031": "84244",
    "2032": "86560",
    "2033": "89887",
    "2034": "92291",
    "2035": "94742",
    "2036": "96013",
    "2037": "98060",
    "2038": "98287",
    "2039": "99159",
    "2040": "102287",
    "2041": "104366",
    "2042": "105626",
    "2043": "107959",
    "2044": "110993",
    "2045": "113534",
    "2046": "118816",
    "2047": "124781",
    "2048": "130917",
    "2049": "136651",
    "2050": "139111"
  },
  {
    "Age": "65-69",
    "2022": "43354",
    "2023": "46311",
    "2024": "51628",
    "2025": "56149",
    "2026": "60720",
    "2027": "64384",
    "2028": "67612",
    "2029": "68959",
    "2030": "70175",
    "2031": "70904",
    "2032": "71320",
    "2033": "71807",
    "2034": "73118",
    "2035": "74007",
    "2036": "75711",
    "2037": "77939",
    "2038": "81083",
    "2039": "83397",
    "2040": "85728",
    "2041": "87002",
    "2042": "89014",
    "2043": "89359",
    "2044": "90301",
    "2045": "93313",
    "2046": "95339",
    "2047": "96633",
    "2048": "98893",
    "2049": "101814",
    "2050": "104299"
  },
  {
    "Age": "70-74",
    "2022": "25977",
    "2023": "28196",
    "2024": "29913",
    "2025": "31651",
    "2026": "33414",
    "2027": "36420",
    "2028": "38984",
    "2029": "43568",
    "2030": "47453",
    "2031": "51417",
    "2032": "54636",
    "2033": "57469",
    "2034": "58755",
    "2035": "59918",
    "2036": "60707",
    "2037": "61234",
    "2038": "61812",
    "2039": "63123",
    "2040": "64037",
    "2041": "65688",
    "2042": "67794",
    "2043": "70700",
    "2044": "72891",
    "2045": "75060",
    "2046": "76318",
    "2047": "78260",
    "2048": "78722",
    "2049": "79720",
    "2050": "82561"
  },
  {
    "Age": "75-79",
    "2022": "13487",
    "2023": "13889",
    "2024": "15023",
    "2025": "16564",
    "2026": "18455",
    "2027": "19773",
    "2028": "21525",
    "2029": "22880",
    "2030": "24276",
    "2031": "25762",
    "2032": "28226",
    "2033": "30340",
    "2034": "34068",
    "2035": "37216",
    "2036": "40472",
    "2037": "43166",
    "2038": "45526",
    "2039": "46726",
    "2040": "47803",
    "2041": "48625",
    "2042": "49246",
    "2043": "49891",
    "2044": "51164",
    "2045": "52069",
    "2046": "53623",
    "2047": "55546",
    "2048": "58126",
    "2049": "60125",
    "2050": "62052"
  },
  {
    "Age": "80-84",
    "2022": "8144",
    "2023": "8606",
    "2024": "8552",
    "2025": "8347",
    "2026": "8538",
    "2027": "8746",
    "2028": "9096",
    "2029": "9894",
    "2030": "10956",
    "2031": "12306",
    "2032": "13268",
    "2033": "14528",
    "2034": "15510",
    "2035": "16548",
    "2036": "17714",
    "2037": "19570",
    "2038": "21182",
    "2039": "23963",
    "2040": "26305",
    "2041": "28763",
    "2042": "30845",
    "2043": "32663",
    "2044": "33711",
    "2045": "34647",
    "2046": "35445",
    "2047": "36103",
    "2048": "36763",
    "2049": "37918",
    "2050": "38758"
  },
  {
    "Age": "85+",
    "2022": "3253",
    "2023": "3630",
    "2024": "3970",
    "2025": "4351",
    "2026": "4745",
    "2027": "5404",
    "2028": "5829",
    "2029": "5946",
    "2030": "6015",
    "2031": "6339",
    "2032": "6838",
    "2033": "7288",
    "2034": "7828",
    "2035": "8504",
    "2036": "9517",
    "2037": "10393",
    "2038": "11427",
    "2039": "12341",
    "2040": "13379",
    "2041": "14711",
    "2042": "16399",
    "2043": "18022",
    "2044": "20335",
    "2045": "22425",
    "2046": "24786",
    "2047": "27129",
    "2048": "29249",
    "2049": "31318",
    "2050": "33168"
  }
]
# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_region, gender='erkak').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='erkak',
                    population=population
                )

print("Navoi male data import completed successfully!")
