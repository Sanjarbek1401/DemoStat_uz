import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_region, _ = Region.objects.get_or_create(name='Qoraqalpog\'iston', defaults={'svg_id': 'karakalpakstan'})

# Data to be imported
navoi_male_data =[
  {
    "2021": "978505",
    "2022": "993719",
    "2023": "1008708",
    "2024": "1023263",
    "2025": "1037374",
    "2026": "1050960",
    "2027": "1063962",
    "2028": "1076434",
    "2029": "1088319",
    "2030": "1099603",
    "2031": "1110260",
    "2032": "1120300",
    "2033": "1129716",
    "2034": "1138451",
    "2035": "1146589",
    "2036": "1154107",
    "2037": "1161094",
    "2038": "1167563",
    "2039": "1173561",
    "2040": "1179164",
    "2041": "1184487",
    "2042": "1189619",
    "2043": "1194612",
    "2044": "1199512",
    "2045": "1204393",
    "2046": "1209270",
    "2047": "1214147",
    "2048": "1219018",
    "2049": "1223859",
    "2050": "1228619",
    "Age": "Total"
  },
  {
    "2021": "97941",
    "2022": "102524",
    "2023": "106053",
    "2024": "108533",
    "2025": "111208",
    "2026": "113567",
    "2027": "112862",
    "2028": "111701",
    "2029": "110248",
    "2030": "108526",
    "2031": "106614",
    "2032": "104599",
    "2033": "102435",
    "2034": "100118",
    "2035": "97755",
    "2036": "95371",
    "2037": "93055",
    "2038": "90838",
    "2039": "88839",
    "2040": "87051",
    "2041": "85596",
    "2042": "84482",
    "2043": "83740",
    "2044": "83370",
    "2045": "83375",
    "2046": "83654",
    "2047": "84120",
    "2048": "84724",
    "2049": "85393",
    "2050": "86012",
    "Age": "0-4"
  },
  {
    "2021": "100230",
    "2022": "98323",
    "2023": "98105",
    "2024": "97657",
    "2025": "96478",
    "2026": "96594",
    "2027": "101040",
    "2028": "104436",
    "2029": "106820",
    "2030": "109504",
    "2031": "111730",
    "2032": "111045",
    "2033": "109939",
    "2034": "108555",
    "2035": "106911",
    "2036": "105084",
    "2037": "103157",
    "2038": "101084",
    "2039": "98861",
    "2040": "96592",
    "2041": "94301",
    "2042": "92075",
    "2043": "89944",
    "2044": "88024",
    "2045": "86307",
    "2046": "84913",
    "2047": "83849",
    "2048": "83144",
    "2049": "82801",
    "2050": "82821",
    "Age": "5-9"
  },
  {
    "2021": "93148",
    "2022": "95145",
    "2023": "95364",
    "2024": "95838",
    "2025": "97421",
    "2026": "98939",
    "2027": "97027",
    "2028": "96814",
    "2029": "96372",
    "2030": "95209",
    "2031": "95304",
    "2032": "99668",
    "2033": "102981",
    "2034": "105307",
    "2035": "107945",
    "2036": "110151",
    "2037": "109491",
    "2038": "108435",
    "2039": "107106",
    "2040": "105524",
    "2041": "103763",
    "2042": "101904",
    "2043": "99002",
    "2044": "97752",
    "2045": "95558",
    "2046": "93342",
    "2047": "91187",
    "2048": "89124",
    "2049": "87266",
    "2050": "85603",
    "Age": "10-14"
  },
  {
    "2021": "79418",
    "2022": "80975",
    "2023": "84495",
    "2024": "87391",
    "2025": "90935",
    "2026": "91851",
    "2027": "93786",
    "2028": "93973",
    "2029": "94428",
    "2030": "95981",
    "2031": "97482",
    "2032": "95596",
    "2033": "95408",
    "2034": "94997",
    "2035": "93874",
    "2036": "93971",
    "2037": "98274",
    "2038": "101522",
    "2039": "103801",
    "2040": "106394",
    "2041": "108571",
    "2042": "107928",
    "2043": "106914",
    "2044": "105635",
    "2045": "104108",
    "2046": "102406",
    "2047": "100610",
    "2048": "98672",
    "2049": "96588",
    "2050": "94459",
    "Age": "15-19"
  },
  {
    "2021": "80055",
    "2022": "79122",
    "2023": "78846",
    "2024": "78862",
    "2025": "77173",
    "2026": "78220",
    "2027": "79690",
    "2028": "83092",
    "2029": "85865",
    "2030": "89291",
    "2031": "90132",
    "2032": "92022",
    "2033": "92203",
    "2034": "92665",
    "2035": "94195",
    "2036": "95682",
    "2037": "93836",
    "2038": "93694",
    "2039": "93333",
    "2040": "92271",
    "2041": "92372",
    "2042": "96588",
    "2043": "99741",
    "2044": "101951",
    "2045": "104470",
    "2046": "106599",
    "2047": "105979",
    "2048": "105025",
    "2049": "103816",
    "2050": "102365",
    "Age": "20-24"
  },
  {
    "2021": "83880",
    "2022": "81437",
    "2023": "78531",
    "2024": "78664",
    "2025": "79407",
    "2026": "78615",
    "2027": "77695",
    "2028": "77426",
    "2029": "77470",
    "2030": "75829",
    "2031": "76865",
    "2032": "78258",
    "2033": "81531",
    "2034": "84161",
    "2035": "87459",
    "2036": "88230",
    "2037": "90083",
    "2038": "90266",
    "2039": "90732",
    "2040": "92226",
    "2041": "93695",
    "2042": "91909",
    "2043": "91830",
    "2044": "91533",
    "2045": "90542",
    "2046": "90640",
    "2047": "94737",
    "2048": "97763",
    "2049": "99875",
    "2050": "102299",
    "Age": "25-29"
  },
  {
    "2021": "91992",
    "2022": "91432",
    "2023": "89918",
    "2024": "87589",
    "2025": "85002",
    "2026": "81767",
    "2027": "79455",
    "2028": "76664",
    "2029": "76820",
    "2030": "77553",
    "2031": "76805",
    "2032": "75951",
    "2033": "75726",
    "2034": "75823",
    "2035": "74254",
    "2036": "75291",
    "2037": "76612",
    "2038": "79758",
    "2039": "82249",
    "2040": "85427",
    "2041": "86137",
    "2042": "87950",
    "2043": "88131",
    "2044": "88596",
    "2045": "90054",
    "2046": "91516",
    "2047": "89801",
    "2048": "89783",
    "2049": "89543",
    "2050": "88617",
    "Age": "30-34"
  },
  {
    "2021": "81146",
    "2022": "84822",
    "2023": "87361",
    "2024": "88285",
    "2025": "88289",
    "2026": "88799",
    "2027": "88220",
    "2028": "86772",
    "2029": "84572",
    "2030": "82158",
    "2031": "79121",
    "2032": "76995",
    "2033": "74355",
    "2034": "74562",
    "2035": "75309",
    "2036": "74622",
    "2037": "73844",
    "2038": "73668",
    "2039": "73818",
    "2040": "72316",
    "2041": "73351",
    "2042": "74604",
    "2043": "77625",
    "2044": "79985",
    "2045": "83051",
    "2046": "83709",
    "2047": "85490",
    "2048": "85671",
    "2049": "86134",
    "2050": "87553",
    "Age": "35-39"
  },
  {
    "2021": "64186",
    "2022": "66612",
    "2023": "69324",
    "2024": "71901",
    "2025": "75146",
    "2026": "78287",
    "2027": "81738",
    "2028": "84122",
    "2029": "84988",
    "2030": "84986",
    "2031": "85501",
    "2032": "84975",
    "2033": "83639",
    "2034": "81596",
    "2035": "79361",
    "2036": "76509",
    "2037": "74544",
    "2038": "72038",
    "2039": "72286",
    "2040": "73044",
    "2041": "72409",
    "2042": "71697",
    "2043": "71561",
    "2044": "71753",
    "2045": "70310",
    "2046": "71341",
    "2047": "72537",
    "2048": "75454",
    "2049": "77709",
    "2050": "80685",
    "Age": "40-44"
  },
  {
    "2021": "54742",
    "2022": "55237",
    "2023": "56617",
    "2024": "58879",
    "2025": "60507",
    "2026": "61957",
    "2027": "64246",
    "2028": "66818",
    "2029": "69260",
    "2030": "72354",
    "2031": "75347",
    "2032": "78655",
    "2033": "80952",
    "2034": "81802",
    "2035": "81826",
    "2036": "82369",
    "2037": "81908",
    "2038": "80679",
    "2039": "78768",
    "2040": "76679",
    "2041": "73987",
    "2042": "72162",
    "2043": "69779",
    "2044": "70063",
    "2045": "70831",
    "2046": "70244",
    "2047": "69591",
    "2048": "69488",
    "2049": "69717",
    "2050": "68331",
    "Age": "45-49"
  },
  {
    "2021": "44587",
    "2022": "46917",
    "2023": "48456",
    "2024": "49482",
    "2025": "51059",
    "2026": "52416",
    "2027": "52872",
    "2028": "54184",
    "2029": "56342",
    "2030": "57894",
    "2031": "59283",
    "2032": "61474",
    "2033": "63940",
    "2034": "66281",
    "2035": "69252",
    "2036": "72125",
    "2037": "75308",
    "2038": "77531",
    "2039": "78372",
    "2040": "78425",
    "2041": "78995",
    "2042": "78601",
    "2043": "77477",
    "2044": "75693",
    "2045": "73743",
    "2046": "71211",
    "2047": "69526",
    "2048": "67272",
    "2049": "67591",
    "2050": "68366",
    "Age": "50-54"
  },
  {
    "2021": "38072",
    "2022": "37961",
    "2023": "38644",
    "2024": "39337",
    "2025": "40365",
    "2026": "41982",
    "2027": "44163",
    "2028": "45606",
    "2029": "46568",
    "2030": "48059",
    "2031": "49366",
    "2032": "49817",
    "2033": "51080",
    "2034": "53141",
    "2035": "54629",
    "2036": "55974",
    "2037": "58066",
    "2038": "60425",
    "2039": "62663",
    "2040": "65500",
    "2041": "68239",
    "2042": "71278",
    "2043": "73417",
    "2044": "74245",
    "2045": "74333",
    "2046": "74935",
    "2047": "74621",
    "2048": "73618",
    "2049": "71970",
    "2050": "70170",
    "Age": "55-59"
  },
  {
    "2021": "30435",
    "2022": "31944",
    "2023": "33045",
    "2024": "33881",
    "2025": "34390",
    "2026": "34506",
    "2027": "34426",
    "2028": "35080",
    "2029": "35743",
    "2030": "36703",
    "2031": "38214",
    "2032": "40228",
    "2033": "41572",
    "2034": "42476",
    "2035": "43877",
    "2036": "45136",
    "2037": "45596",
    "2038": "46808",
    "2039": "48746",
    "2040": "50156",
    "2041": "51448",
    "2042": "53411",
    "2043": "55633",
    "2044": "57744",
    "2045": "60409",
    "2046": "62981",
    "2047": "65836",
    "2048": "67864",
    "2049": "68671",
    "2050": "68798",
    "Age": "60-64"
  },
  {
    "2021": "17893",
    "2022": "19277",
    "2023": "20756",
    "2024": "22527",
    "2025": "24218",
    "2026": "26089",
    "2027": "27400",
    "2028": "28363",
    "2029": "29120",
    "2030": "29595",
    "2031": "29762",
    "2032": "29748",
    "2033": "30384",
    "2034": "31031",
    "2035": "31927",
    "2036": "33320",
    "2037": "35146",
    "2038": "36385",
    "2039": "37229",
    "2040": "38524",
    "2041": "39719",
    "2042": "40189",
    "2043": "41334",
    "2044": "43123",
    "2045": "44440",
    "2046": "45664",
    "2047": "47475",
    "2048": "49530",
    "2049": "51485",
    "2050": "53937",
    "Age": "65-69"
  },
  {
    "2021": "11333",
    "2022": "11803",
    "2023": "12425",
    "2024": "13068",
    "2025": "13281",
    "2026": "14374",
    "2027": "15523",
    "2028": "16749",
    "2029": "18219",
    "2030": "19614",
    "2031": "21189",
    "2032": "22309",
    "2033": "23145",
    "2034": "23830",
    "2035": "24279",
    "2036": "24504",
    "2037": "24566",
    "2038": "25178",
    "2039": "25799",
    "2040": "26617",
    "2041": "27871",
    "2042": "29479",
    "2043": "30592",
    "2044": "31366",
    "2045": "32531",
    "2046": "33640",
    "2047": "34116",
    "2048": "35175",
    "2049": "36782",
    "2050": "37982",
    "Age": "70-74"
  },
  {
    "2021": "5675",
    "2022": "5977",
    "2023": "6456",
    "2024": "7068",
    "2025": "7849",
    "2026": "8086",
    "2027": "8462",
    "2028": "8936",
    "2029": "9430",
    "2030": "9640",
    "2031": "10487",
    "2032": "11394",
    "2033": "12353",
    "2034": "13500",
    "2035": "14582",
    "2036": "15836",
    "2037": "16746",
    "2038": "17435",
    "2039": "18028",
    "2040": "18429",
    "2041": "18699",
    "2042": "18824",
    "2043": "19388",
    "2044": "19964",
    "2045": "20678",
    "2046": "21761",
    "2047": "23104",
    "2048": "24059",
    "2049": "24733",
    "2050": "25728",
    "Age": "75-79"
  },
  {
    "2021": "2812",
    "2022": "3194",
    "2023": "3204",
    "2024": "3071",
    "2025": "3247",
    "2026": "3351",
    "2027": "3588",
    "2028": "3893",
    "2029": "4266",
    "2030": "4784",
    "2031": "4950",
    "2032": "5227",
    "2033": "5557",
    "2034": "5905",
    "2035": "6097",
    "2036": "6692",
    "2037": "7341",
    "2038": "8021",
    "2039": "8831",
    "2040": "9588",
    "2041": "10493",
    "2042": "11165",
    "2043": "11685",
    "2044": "12158",
    "2045": "12492",
    "2046": "12770",
    "2047": "12932",
    "2048": "13410",
    "2049": "13901",
    "2050": "14475",
    "Age": "80-84"
  },
  {
    "2021": "960",
    "2022": "1018",
    "2023": "1108",
    "2024": "1229",
    "2025": "1311",
    "2026": "1561",
    "2027": "1769",
    "2028": "1805",
    "2029": "1790",
    "2030": "1921",
    "2031": "2105",
    "2032": "2338",
    "2033": "2515",
    "2034": "2704",
    "2035": "3057",
    "2036": "3241",
    "2037": "3520",
    "2038": "3799",
    "2039": "4096",
    "2040": "4399",
    "2041": "4842",
    "2042": "5371",
    "2043": "5918",
    "2044": "6555",
    "2045": "7160",
    "2046": "7943",
    "2047": "8635",
    "2048": "9243",
    "2049": "9884",
    "2050": "10417",
    "Age": "85+"
  }
]
# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_region, gender='erkak').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='erkak',
                    population=population
                )

print("Navoi male data import completed successfully!")
