import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_region, _ = Region.objects.get_or_create(name='Surxondaryo', defaults={'svg_id': 'surkhandarya'})

# Data to be imported
navoi_male_data =[
  {
    "Age": "Total",
    "2022": "1386983",
    "2023": "1421880",
    "2024": "1456607",
    "2025": "1490737",
    "2026": "1524225",
    "2027": "1556920",
    "2028": "1588721",
    "2029": "1619754",
    "2030": "1649935",
    "2031": "1679281",
    "2032": "1707743",
    "2033": "1735287",
    "2034": "1761911",
    "2035": "1787502",
    "2036": "1812272",
    "2037": "1836253",
    "2038": "1859664",
    "2039": "1882610",
    "2040": "1905254",
    "2041": "1927823",
    "2042": "1950615",
    "2043": "1973838",
    "2044": "1997589",
    "2045": "2021924",
    "2046": "2046951",
    "2047": "2072626",
    "2048": "2098860",
    "2049": "2125595",
    "2050": "2152678"
  },
  {
    "Age": "0-4",
    "2022": "179763",
    "2023": "189710",
    "2024": "198383",
    "2025": "204511",
    "2026": "207670",
    "2027": "208517",
    "2028": "206907",
    "2029": "204607",
    "2030": "201978",
    "2031": "199097",
    "2032": "196084",
    "2033": "193019",
    "2034": "189775",
    "2035": "186329",
    "2036": "182879",
    "2037": "179520",
    "2038": "176506",
    "2039": "173961",
    "2040": "172157",
    "2041": "171115",
    "2042": "171087",
    "2043": "172067",
    "2044": "174043",
    "2045": "176911",
    "2046": "180547",
    "2047": "184613",
    "2048": "188823",
    "2049": "193010",
    "2050": "196986"
  },
  {
    "Age": "5-9",
    "2022": "152032",
    "2023": "155696",
    "2024": "160672",
    "2025": "165293",
    "2026": "170276",
    "2027": "178199",
    "2028": "187967",
    "2029": "196492",
    "2030": "202530",
    "2031": "205658",
    "2032": "206527",
    "2033": "204979",
    "2034": "202762",
    "2035": "200224",
    "2036": "197439",
    "2037": "194526",
    "2038": "191560",
    "2039": "188418",
    "2040": "185075",
    "2041": "181727",
    "2042": "178466",
    "2043": "175545",
    "2044": "173083",
    "2045": "171351",
    "2046": "170366",
    "2047": "170381",
    "2048": "171387",
    "2049": "173374",
    "2050": "176241"
  },
  {
    "Age": "10-14",
    "2022": "130767",
    "2023": "135130",
    "2024": "136327",
    "2025": "140586",
    "2026": "147239",
    "2027": "151046",
    "2028": "154646",
    "2029": "159558",
    "2030": "164114",
    "2031": "169023",
    "2032": "176844",
    "2033": "186495",
    "2034": "194923",
    "2035": "200908",
    "2036": "204026",
    "2037": "204923",
    "2038": "203433",
    "2039": "201286",
    "2040": "198823",
    "2041": "196117",
    "2042": "193283",
    "2043": "190398",
    "2044": "187339",
    "2045": "184080",
    "2046": "180815",
    "2047": "177634",
    "2048": "174788",
    "2049": "172392",
    "2050": "170716"
  },
  {
    "Age": "15-19",
    "2022": "107816",
    "2023": "109162",
    "2024": "114932",
    "2025": "120051",
    "2026": "124645",
    "2027": "129895",
    "2028": "134195",
    "2029": "135362",
    "2030": "139573",
    "2031": "146159",
    "2032": "149920",
    "2033": "153482",
    "2034": "158347",
    "2035": "162860",
    "2036": "167723",
    "2037": "175470",
    "2038": "185025",
    "2039": "193371",
    "2040": "199304",
    "2041": "202410",
    "2042": "203331",
    "2043": "201894",
    "2044": "199815",
    "2045": "197424",
    "2046": "194793",
    "2047": "192035",
    "2048": "189226",
    "2049": "186242",
    "2050": "183058"
  },
  {
    "Age": "20-24",
    "2022": "114961",
    "2023": "109902",
    "2024": "108106",
    "2025": "106585",
    "2026": "105636",
    "2027": "107265",
    "2028": "108578",
    "2029": "114265",
    "2030": "119285",
    "2031": "123785",
    "2032": "128941",
    "2033": "133176",
    "2034": "134321",
    "2035": "138481",
    "2036": "144986",
    "2037": "148689",
    "2038": "152202",
    "2039": "157005",
    "2040": "161465",
    "2041": "166273",
    "2042": "173920",
    "2043": "183344",
    "2044": "191571",
    "2045": "197434",
    "2046": "200525",
    "2047": "201482",
    "2048": "200123",
    "2049": "198141",
    "2050": "195851"
  },
  {
    "Age": "25-29",
    "2022": "131864",
    "2023": "132747",
    "2024": "128246",
    "2025": "125599",
    "2026": "120403",
    "2027": "114235",
    "2028": "109358",
    "2029": "107673",
    "2030": "106236",
    "2031": "105341",
    "2032": "106978",
    "2033": "108260",
    "2034": "113844",
    "2035": "118743",
    "2036": "123131",
    "2037": "128179",
    "2038": "132344",
    "2039": "133465",
    "2040": "137561",
    "2041": "143963",
    "2042": "147595",
    "2043": "151052",
    "2044": "155788",
    "2045": "160190",
    "2046": "164926",
    "2047": "172446",
    "2048": "181706",
    "2049": "189792",
    "2050": "195573"
  },
  {
    "Age": "30-34",
    "2022": "123296",
    "2023": "125479",
    "2024": "128989",
    "2025": "129378",
    "2026": "130831",
    "2027": "130107",
    "2028": "131022",
    "2029": "126653",
    "2030": "124167",
    "2031": "119189",
    "2032": "113271",
    "2033": "108602",
    "2034": "107043",
    "2035": "105698",
    "2036": "104866",
    "2037": "106512",
    "2038": "107763",
    "2039": "113243",
    "2040": "118026",
    "2041": "122312",
    "2042": "127260",
    "2043": "131363",
    "2044": "132469",
    "2045": "136505",
    "2046": "142809",
    "2047": "146382",
    "2048": "149794",
    "2049": "154470",
    "2050": "158812"
  },
  {
    "Age": "35-39",
    "2022": "102068",
    "2023": "107059",
    "2024": "110884",
    "2025": "114027",
    "2026": "117318",
    "2027": "121165",
    "2028": "123247",
    "2029": "126676",
    "2030": "127048",
    "2031": "128511",
    "2032": "127831",
    "2033": "128812",
    "2034": "124602",
    "2035": "122293",
    "2036": "117540",
    "2037": "111872",
    "2038": "107408",
    "2039": "105970",
    "2040": "104718",
    "2041": "103948",
    "2042": "105606",
    "2043": "106834",
    "2044": "112218",
    "2045": "116898",
    "2046": "121096",
    "2047": "125956",
    "2048": "130007",
    "2049": "131105",
    "2050": "135085"
  },
  {
    "Age": "40-44",
    "2022": "78323",
    "2023": "81762",
    "2024": "85406",
    "2025": "89854",
    "2026": "94943",
    "2027": "100157",
    "2028": "104985",
    "2029": "108690",
    "2030": "111744",
    "2031": "114948",
    "2032": "118712",
    "2033": "120745",
    "2034": "124133",
    "2035": "124521",
    "2036": "126008",
    "2037": "125383",
    "2038": "126429",
    "2039": "122375",
    "2040": "120223",
    "2041": "115669",
    "2042": "110214",
    "2043": "105927",
    "2044": "104593",
    "2045": "103423",
    "2046": "102712",
    "2047": "104381",
    "2048": "105594",
    "2049": "110894",
    "2050": "115489"
  },
  {
    "Age": "45-49",
    "2022": "66312",
    "2023": "67022",
    "2024": "68501",
    "2025": "71198",
    "2026": "73918",
    "2027": "76714",
    "2028": "80049",
    "2029": "83583",
    "2030": "87903",
    "2031": "92849",
    "2032": "97922",
    "2033": "102627",
    "2034": "106243",
    "2035": "109237",
    "2036": "112382",
    "2037": "116089",
    "2038": "118094",
    "2039": "121448",
    "2040": "121854",
    "2041": "123365",
    "2042": "122800",
    "2043": "123901",
    "2044": "119991",
    "2045": "117969",
    "2046": "113594",
    "2047": "108337",
    "2048": "104217",
    "2049": "102974",
    "2050": "101879"
  },
  {
    "Age": "50-54",
    "2022": "58562",
    "2023": "61196",
    "2024": "62188",
    "2025": "62386",
    "2026": "63203",
    "2027": "64391",
    "2028": "65093",
    "2029": "66538",
    "2030": "69161",
    "2031": "71803",
    "2032": "74524",
    "2033": "77767",
    "2034": "81201",
    "2035": "85403",
    "2036": "90213",
    "2037": "95150",
    "2038": "99734",
    "2039": "103263",
    "2040": "106200",
    "2041": "109291",
    "2042": "112942",
    "2043": "114926",
    "2044": "118239",
    "2045": "118669",
    "2046": "120205",
    "2047": "119713",
    "2048": "120864",
    "2049": "117107",
    "2050": "115206"
  },
  {
    "Age": "55-59",
    "2022": "48541",
    "2023": "48608",
    "2024": "50028",
    "2025": "52003",
    "2026": "53734",
    "2027": "55976",
    "2028": "58493",
    "2029": "59461",
    "2030": "59680",
    "2031": "60494",
    "2032": "61670",
    "2033": "62384",
    "2034": "63805",
    "2035": "66350",
    "2036": "68910",
    "2037": "71553",
    "2038": "74694",
    "2039": "78015",
    "2040": "82084",
    "2041": "86733",
    "2042": "91510",
    "2043": "95950",
    "2044": "99373",
    "2045": "102244",
    "2046": "105275",
    "2047": "108862",
    "2048": "110825",
    "2049": "114079",
    "2050": "114535"
  },
  {
    "Age": "60-64",
    "2022": "41372",
    "2023": "43160",
    "2024": "44202",
    "2025": "44929",
    "2026": "45224",
    "2027": "44949",
    "2028": "45054",
    "2029": "46427",
    "2030": "48308",
    "2031": "49951",
    "2032": "52063",
    "2033": "54437",
    "2034": "55388",
    "2035": "55651",
    "2036": "56470",
    "2037": "57638",
    "2038": "58378",
    "2039": "59773",
    "2040": "62215",
    "2041": "64667",
    "2042": "67208",
    "2043": "70212",
    "2044": "73385",
    "2045": "77277",
    "2046": "81716",
    "2047": "86280",
    "2048": "90522",
    "2049": "93798",
    "2050": "96576"
  },
  {
    "Age": "65-69",
    "2022": "24393",
    "2023": "26478",
    "2024": "29341",
    "2025": "31921",
    "2026": "34375",
    "2027": "36506",
    "2028": "38115",
    "2029": "39081",
    "2030": "39776",
    "2031": "40104",
    "2032": "39933",
    "2033": "40103",
    "2034": "41422",
    "2035": "43194",
    "2036": "44737",
    "2037": "46698",
    "2038": "48904",
    "2039": "49841",
    "2040": "50163",
    "2041": "50985",
    "2042": "52138",
    "2043": "52904",
    "2044": "54260",
    "2045": "56567",
    "2046": "58884",
    "2047": "61291",
    "2048": "64120",
    "2049": "67102",
    "2050": "70761"
  },
  {
    "Age": "70-74",
    "2022": "13498",
    "2023": "14726",
    "2024": "15862",
    "2025": "17225",
    "2026": "18416",
    "2027": "20371",
    "2028": "22160",
    "2029": "24600",
    "2030": "26804",
    "2031": "28916",
    "2032": "30778",
    "2033": "32200",
    "2034": "33093",
    "2035": "33762",
    "2036": "34129",
    "2037": "34079",
    "2038": "34321",
    "2039": "35569",
    "2040": "37205",
    "2041": "38627",
    "2042": "40407",
    "2043": "42405",
    "2044": "43314",
    "2045": "43690",
    "2046": "44503",
    "2047": "45621",
    "2048": "46403",
    "2049": "47700",
    "2050": "49833"
  },
  {
    "Age": "75-79",
    "2022": "6394",
    "2023": "6759",
    "2024": "7339",
    "2025": "8164",
    "2026": "9393",
    "2027": "10190",
    "2028": "11169",
    "2029": "12049",
    "2030": "13119",
    "2031": "14095",
    "2032": "15664",
    "2033": "17121",
    "2034": "19077",
    "2035": "20853",
    "2036": "22572",
    "2037": "24122",
    "2038": "25321",
    "2039": "26117",
    "2040": "26737",
    "2041": "27127",
    "2042": "27196",
    "2043": "27500",
    "2044": "28642",
    "2045": "30097",
    "2046": "31356",
    "2047": "32898",
    "2048": "34624",
    "2049": "35475",
    "2050": "35888"
  },
  {
    "Age": "80-84",
    "2022": "4336",
    "2023": "4604",
    "2024": "4462",
    "2025": "4211",
    "2026": "4043",
    "2027": "4090",
    "2028": "4394",
    "2029": "4797",
    "2030": "5352",
    "2031": "6198",
    "2032": "6758",
    "2033": "7468",
    "2034": "8090",
    "2035": "8858",
    "2036": "9597",
    "2037": "10747",
    "2038": "11836",
    "2039": "13269",
    "2040": "14580",
    "2041": "15863",
    "2042": "17052",
    "2043": "17988",
    "2044": "18651",
    "2045": "19191",
    "2046": "19575",
    "2047": "19736",
    "2048": "20070",
    "2049": "21049",
    "2050": "22255"
  },
  {
    "Age": "85+",
    "2022": "2685",
    "2023": "2679",
    "2024": "2736",
    "2025": "2818",
    "2026": "2958",
    "2027": "3146",
    "2028": "3289",
    "2029": "3242",
    "2030": "3156",
    "2031": "3161",
    "2032": "3323",
    "2033": "3610",
    "2034": "3841",
    "2035": "4137",
    "2036": "4663",
    "2037": "5103",
    "2038": "5710",
    "2039": "6222",
    "2040": "6864",
    "2041": "7629",
    "2042": "8598",
    "2043": "9628",
    "2044": "10816",
    "2045": "12005",
    "2046": "13254",
    "2047": "14576",
    "2048": "15769",
    "2049": "16891",
    "2050": "17933"
  }
]
# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_region, gender='erkak').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='erkak',
                    population=population
                )

print("Navoi male data import completed successfully!")
