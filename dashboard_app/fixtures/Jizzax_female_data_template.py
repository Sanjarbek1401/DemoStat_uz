import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_city_region, _ = Region.objects.get_or_create(name='Jizzax', defaults={'svg_id': 'jizzakh'})

# Data to be imported
navoi_male_data = [
  {
    "2021": "715807",
    "2022": "732393",
    "2023": "748974",
    "2024": "765398",
    "2025": "781642",
    "2026": "797621",
    "2027": "813261",
    "2028": "828578",
    "2029": "843492",
    "2030": "857939",
    "2031": "871856",
    "2032": "885218",
    "2033": "898031",
    "2034": "910260",
    "2035": "922006",
    "2036": "933294",
    "2037": "944237",
    "2038": "954900",
    "2039": "965372",
    "2040": "975781",
    "2041": "986280",
    "2042": "996977",
    "2043": "1007921",
    "2044": "1019138",
    "2045": "1030680",
    "2046": "1042533",
    "2047": "1054665",
    "2048": "1067048",
    "2049": "1079627",
    "2050": "1092325",
    "Age": "Total"
  },
  {
    "2021": "83579",
    "2022": "89360",
    "2023": "94067",
    "2024": "97175",
    "2025": "99157",
    "2026": "99734",
    "2027": "99393",
    "2028": "98706",
    "2029": "97765",
    "2030": "96526",
    "2031": "95009",
    "2032": "93263",
    "2033": "91272",
    "2034": "89092",
    "2035": "86890",
    "2036": "84764",
    "2037": "82849",
    "2038": "81205",
    "2039": "79963",
    "2040": "79139",
    "2041": "78862",
    "2042": "79127",
    "2043": "79918",
    "2044": "81171",
    "2045": "82813",
    "2046": "84676",
    "2047": "86626",
    "2048": "88587",
    "2049": "90473",
    "2050": "92163",
    "Age": "0-4"
  },
  {
    "2021": "68860",
    "2022": "70474",
    "2023": "72751",
    "2024": "75364",
    "2025": "78289",
    "2026": "82786",
    "2027": "88428",
    "2028": "93024",
    "2029": "96068",
    "2030": "98028",
    "2031": "98619",
    "2032": "98317",
    "2033": "97682",
    "2034": "96798",
    "2035": "95624",
    "2036": "94181",
    "2037": "92514",
    "2038": "90609",
    "2039": "88520",
    "2040": "86411",
    "2041": "84377",
    "2042": "82549",
    "2043": "80986",
    "2044": "79814",
    "2045": "79049",
    "2046": "78814",
    "2047": "79106",
    "2048": "79910",
    "2049": "81164",
    "2050": "82795",
    "Age": "5-9"
  },
  {
    "2021": "63707",
    "2022": "63721",
    "2023": "63133",
    "2024": "63996",
    "2025": "66096",
    "2026": "68441",
    "2027": "70022",
    "2028": "72262",
    "2029": "74826",
    "2030": "77689",
    "2031": "82100",
    "2032": "87642",
    "2033": "92160",
    "2034": "95158",
    "2035": "97103",
    "2036": "97706",
    "2037": "97437",
    "2038": "96846",
    "2039": "96013",
    "2040": "94898",
    "2041": "93521",
    "2042": "91928",
    "2043": "90101",
    "2044": "88092",
    "2045": "86062",
    "2046": "84101",
    "2047": "82338",
    "2048": "80830",
    "2049": "79703",
    "2050": "78970",
    "Age": "10-14"
  },
  {
    "2021": "55614",
    "2022": "56779",
    "2023": "59605",
    "2024": "61421",
    "2025": "62651",
    "2026": "63244",
    "2027": "63254",
    "2028": "62684",
    "2029": "63559",
    "2030": "65647",
    "2031": "67965",
    "2032": "69511",
    "2033": "71709",
    "2034": "74230",
    "2035": "77051",
    "2036": "81398",
    "2037": "86850",
    "2038": "91283",
    "2039": "94229",
    "2040": "96154",
    "2041": "96771",
    "2042": "96543",
    "2043": "96005",
    "2044": "95232",
    "2045": "94181",
    "2046": "92869",
    "2047": "91341",
    "2048": "89579",
    "2049": "87634",
    "2050": "85664",
    "Age": "15-19"
  },
  {
    "2021": "55951",
    "2022": "55100",
    "2023": "54980",
    "2024": "55430",
    "2025": "55710",
    "2026": "56143",
    "2027": "57277",
    "2028": "59977",
    "2029": "61657",
    "2030": "62769",
    "2031": "63285",
    "2032": "63342",
    "2033": "62922",
    "2034": "63893",
    "2035": "65926",
    "2036": "68081",
    "2037": "69451",
    "2038": "71511",
    "2039": "73952",
    "2040": "76682",
    "2041": "80800",
    "2042": "85900",
    "2043": "90019",
    "2044": "92779",
    "2045": "94647",
    "2046": "95328",
    "2047": "95247",
    "2048": "94884",
    "2049": "94293",
    "2050": "93429",
    "Age": "20-24"
  },
  {
    "2021": "66956",
    "2022": "64811",
    "2023": "62701",
    "2024": "60877",
    "2025": "58806",
    "2026": "57251",
    "2027": "56642",
    "2028": "56673",
    "2029": "57210",
    "2030": "57553",
    "2031": "58009",
    "2032": "59033",
    "2033": "61507",
    "2034": "63014",
    "2035": "64083",
    "2036": "64663",
    "2037": "64853",
    "2038": "64539",
    "2039": "65478",
    "2040": "67368",
    "2041": "69412",
    "2042": "70746",
    "2043": "72746",
    "2044": "75056",
    "2045": "77569",
    "2046": "81354",
    "2047": "86074",
    "2048": "89906",
    "2049": "92517",
    "2050": "94351",
    "Age": "25-29"
  },
  {
    "2021": "65037",
    "2022": "66239",
    "2023": "66883",
    "2024": "67175",
    "2025": "67102",
    "2026": "66146",
    "2027": "64288",
    "2028": "62497",
    "2029": "60975",
    "2030": "59184",
    "2031": "57853",
    "2032": "57388",
    "2033": "57492",
    "2034": "58058",
    "2035": "58423",
    "2036": "58886",
    "2037": "59847",
    "2038": "62203",
    "2039": "63640",
    "2040": "64716",
    "2041": "65360",
    "2042": "65654",
    "2043": "65442",
    "2044": "66410",
    "2045": "68266",
    "2046": "70279",
    "2047": "71595",
    "2048": "73539",
    "2049": "75744",
    "2050": "78103",
    "Age": "30-34"
  },
  {
    "2021": "53486",
    "2022": "57731",
    "2023": "59105",
    "2024": "60145",
    "2025": "62399",
    "2026": "63567",
    "2027": "64714",
    "2028": "65363",
    "2029": "65706",
    "2030": "65722",
    "2031": "64919",
    "2032": "63270",
    "2033": "61698",
    "2034": "60377",
    "2035": "58771",
    "2036": "57587",
    "2037": "57217",
    "2038": "57374",
    "2039": "57972",
    "2040": "58372",
    "2041": "58867",
    "2042": "59818",
    "2043": "62128",
    "2044": "63547",
    "2045": "64650",
    "2046": "65348",
    "2047": "65715",
    "2048": "65563",
    "2049": "66531",
    "2050": "68332",
    "Age": "35-39"
  },
  {
    "2021": "41653",
    "2022": "42388",
    "2023": "44919",
    "2024": "47598",
    "2025": "49346",
    "2026": "52442",
    "2027": "56504",
    "2028": "57798",
    "2029": "58794",
    "2030": "60982",
    "2031": "62103",
    "2032": "63232",
    "2033": "63895",
    "2034": "64273",
    "2035": "64343",
    "2036": "63634",
    "2037": "62120",
    "2038": "60692",
    "2039": "59505",
    "2040": "58026",
    "2041": "56948",
    "2042": "56654",
    "2043": "56865",
    "2044": "57501",
    "2045": "57937",
    "2046": "58460",
    "2047": "59406",
    "2048": "61675",
    "2049": "63068",
    "2050": "64168",
    "Age": "40-44"
  },
  {
    "2021": "34371",
    "2022": "35419",
    "2023": "36794",
    "2024": "38223",
    "2025": "39781",
    "2026": "41052",
    "2027": "41745",
    "2028": "44189",
    "2029": "46771",
    "2030": "48438",
    "2031": "51418",
    "2032": "55357",
    "2033": "56602",
    "2034": "57571",
    "2035": "59712",
    "2036": "60804",
    "2037": "61924",
    "2038": "62597",
    "2039": "63002",
    "2040": "63117",
    "2041": "62484",
    "2042": "61075",
    "2043": "59755",
    "2044": "58669",
    "2045": "57287",
    "2046": "56288",
    "2047": "56047",
    "2048": "56286",
    "2049": "56936",
    "2050": "57383",
    "Age": "45-49"
  },
  {
    "2021": "30561",
    "2022": "30938",
    "2023": "31153",
    "2024": "32141",
    "2025": "32946",
    "2026": "33786",
    "2027": "34801",
    "2028": "36132",
    "2029": "37516",
    "2030": "39030",
    "2031": "40270",
    "2032": "40935",
    "2033": "43309",
    "2034": "45812",
    "2035": "47416",
    "2036": "50303",
    "2037": "54133",
    "2038": "55342",
    "2039": "56295",
    "2040": "58401",
    "2041": "59483",
    "2042": "60607",
    "2043": "61297",
    "2044": "61730",
    "2045": "61889",
    "2046": "61320",
    "2047": "59995",
    "2048": "58752",
    "2049": "57735",
    "2050": "56422",
    "Age": "50-54"
  },
  {
    "2021": "29990",
    "2022": "29664",
    "2023": "29550",
    "2024": "29077",
    "2025": "29085",
    "2026": "29775",
    "2027": "30147",
    "2028": "30362",
    "2029": "31323",
    "2030": "32109",
    "2031": "32931",
    "2032": "33914",
    "2033": "35200",
    "2034": "36536",
    "2035": "38005",
    "2036": "39214",
    "2037": "39851",
    "2038": "42154",
    "2039": "44581",
    "2040": "46132",
    "2041": "48929",
    "2042": "52645",
    "2043": "53823",
    "2044": "54769",
    "2045": "56842",
    "2046": "57920",
    "2047": "59046",
    "2048": "59740",
    "2049": "60186",
    "2050": "60374",
    "Age": "55-59"
  },
  {
    "2021": "25324",
    "2022": "26495",
    "2023": "27260",
    "2024": "27974",
    "2025": "28430",
    "2026": "28383",
    "2027": "28094",
    "2028": "28015",
    "2029": "27592",
    "2030": "27632",
    "2031": "28313",
    "2032": "28683",
    "2033": "28903",
    "2034": "29831",
    "2035": "30596",
    "2036": "31401",
    "2037": "32347",
    "2038": "33582",
    "2039": "34868",
    "2040": "36288",
    "2041": "37468",
    "2042": "38082",
    "2043": "40309",
    "2044": "42654",
    "2045": "44151",
    "2046": "46846",
    "2047": "50416",
    "2048": "51556",
    "2049": "52483",
    "2050": "54497",
    "Age": "60-64"
  },
  {
    "2021": "17057",
    "2022": "18004",
    "2023": "19380",
    "2024": "20503",
    "2025": "21904",
    "2026": "23052",
    "2027": "24127",
    "2028": "24836",
    "2029": "25505",
    "2030": "25953",
    "2031": "25941",
    "2032": "25711",
    "2033": "25683",
    "2034": "25330",
    "2035": "25414",
    "2036": "26087",
    "2037": "26459",
    "2038": "26692",
    "2039": "27582",
    "2040": "28328",
    "2041": "29118",
    "2042": "30028",
    "2043": "31208",
    "2044": "32438",
    "2045": "33805",
    "2046": "34949",
    "2047": "35538",
    "2048": "37662",
    "2049": "39895",
    "2050": "41319",
    "Age": "65-69"
  },
  {
    "2021": "11883",
    "2022": "12535",
    "2023": "12996",
    "2024": "13497",
    "2025": "13620",
    "2026": "14772",
    "2027": "15608",
    "2028": "16825",
    "2029": "17817",
    "2030": "19064",
    "2031": "20093",
    "2032": "21068",
    "2033": "21725",
    "2034": "22349",
    "2035": "22793",
    "2036": "22825",
    "2037": "22670",
    "2038": "22702",
    "2039": "22433",
    "2040": "22570",
    "2041": "23229",
    "2042": "23607",
    "2043": "23859",
    "2044": "24703",
    "2045": "25428",
    "2046": "26198",
    "2047": "27060",
    "2048": "28164",
    "2049": "29318",
    "2050": "30606",
    "Age": "70-74"
  },
  {
    "2021": "6918",
    "2022": "6966",
    "2023": "7454",
    "2024": "8192",
    "2025": "9259",
    "2026": "9517",
    "2027": "10064",
    "2028": "10449",
    "2029": "10886",
    "2030": "11035",
    "2031": "12003",
    "2032": "12725",
    "2033": "13762",
    "2034": "14613",
    "2035": "15684",
    "2036": "16579",
    "2037": "17436",
    "2038": "18034",
    "2039": "18601",
    "2040": "19033",
    "2041": "19113",
    "2042": "19039",
    "2043": "19132",
    "2044": "18956",
    "2045": "19147",
    "2046": "19778",
    "2047": "20149",
    "2048": "20414",
    "2049": "21183",
    "2050": "21865",
    "Age": "75-79"
  },
  {
    "2021": "3435",
    "2022": "4269",
    "2023": "4636",
    "2024": "4887",
    "2025": "5027",
    "2026": "4870",
    "2027": "4957",
    "2028": "5333",
    "2029": "5883",
    "2030": "6693",
    "2031": "6876",
    "2032": "7309",
    "2033": "7616",
    "2034": "7981",
    "2035": "8152",
    "2036": "8909",
    "2037": "9500",
    "2038": "10328",
    "2039": "11013",
    "2040": "11876",
    "2041": "12609",
    "2042": "13321",
    "2043": "13836",
    "2044": "14327",
    "2045": "14729",
    "2046": "14846",
    "2047": "14847",
    "2048": "14986",
    "2049": "14901",
    "2050": "15128",
    "Age": "80-84"
  },
  {
    "2021": "1425",
    "2022": "1499",
    "2023": "1607",
    "2024": "1723",
    "2025": "2033",
    "2026": "2661",
    "2027": "3197",
    "2028": "3451",
    "2029": "3639",
    "2030": "3885",
    "2031": "4149",
    "2032": "4518",
    "2033": "4895",
    "2034": "5346",
    "2035": "6019",
    "2036": "6272",
    "2037": "6779",
    "2038": "7206",
    "2039": "7727",
    "2040": "8269",
    "2041": "8931",
    "2042": "9654",
    "2043": "10489",
    "2044": "11287",
    "2045": "12229",
    "2046": "13160",
    "2047": "14119",
    "2048": "15014",
    "2049": "15864",
    "2050": "16756",
    "Age": "85+"
  }
]

# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_city_region, gender='ayol').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_city_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='ayol',
                    population=population
                )

print("Navoi female data import completed successfully!")
