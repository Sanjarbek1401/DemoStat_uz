import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_city_region, _ = Region.objects.get_or_create(name='Surxondaryo', defaults={'svg_id': 'surkhandarya'})

# Data to be imported
navoi_male_data = [
  {
    "Age": "Total",
    "2022": "2743200",
    "2023": "2811791",
    "2024": "2880170",
    "2025": "2947513",
    "2026": "3013712",
    "2027": "3078448",
    "2028": "3141512",
    "2029": "3203122",
    "2030": "3263114",
    "2031": "3321513",
    "2032": "3378217",
    "2033": "3433157",
    "2034": "3486320",
    "2035": "3537471",
    "2036": "3587015",
    "2037": "3635020",
    "2038": "3681907",
    "2039": "3727872",
    "2040": "3773232",
    "2041": "3818428",
    "2042": "3864034",
    "2043": "3910460",
    "2044": "3957893",
    "2045": "4006443",
    "2046": "4056309",
    "2047": "4107408",
    "2048": "4159580",
    "2049": "4212691",
    "2050": "4266459"
  },
  {
    "Age": "0-4",
    "2022": "345390",
    "2023": "365592",
    "2024": "383471",
    "2025": "395624",
    "2026": "402530",
    "2027": "405129",
    "2028": "401995",
    "2029": "397531",
    "2030": "392428",
    "2031": "386839",
    "2032": "380995",
    "2033": "375047",
    "2034": "368753",
    "2035": "362064",
    "2036": "355366",
    "2037": "348844",
    "2038": "342994",
    "2039": "338054",
    "2040": "334555",
    "2041": "332534",
    "2042": "332485",
    "2043": "334392",
    "2044": "338234",
    "2045": "343808",
    "2046": "350870",
    "2047": "358765",
    "2048": "366936",
    "2049": "375061",
    "2050": "382772"
  },
  {
    "Age": "5-9",
    "2022": "292101",
    "2023": "298719",
    "2024": "307567",
    "2025": "316947",
    "2026": "327506",
    "2027": "342418",
    "2028": "362238",
    "2029": "379796",
    "2030": "391758",
    "2031": "398601",
    "2032": "401252",
    "2033": "398268",
    "2034": "394000",
    "2035": "389108",
    "2036": "383738",
    "2037": "378115",
    "2038": "372389",
    "2039": "366318",
    "2040": "359857",
    "2041": "353386",
    "2042": "347087",
    "2043": "341448",
    "2044": "336700",
    "2045": "333370",
    "2046": "331487",
    "2047": "331539",
    "2048": "333510",
    "2049": "337381",
    "2050": "342951"
  },
  {
    "Age": "10-14",
    "2022": "255049",
    "2023": "263494",
    "2024": "265752",
    "2025": "273216",
    "2026": "283855",
    "2027": "290282",
    "2028": "296792",
    "2029": "305522",
    "2030": "314770",
    "2031": "325174",
    "2032": "339879",
    "2033": "359457",
    "2034": "376812",
    "2035": "388666",
    "2036": "395490",
    "2037": "398202",
    "2038": "395345",
    "2039": "391235",
    "2040": "386512",
    "2041": "381317",
    "2042": "375875",
    "2043": "370333",
    "2044": "364452",
    "2045": "358181",
    "2046": "351899",
    "2047": "345777",
    "2048": "340300",
    "2049": "335692",
    "2050": "332477"
  },
  {
    "Age": "15-19",
    "2022": "209855",
    "2023": "211803",
    "2024": "222731",
    "2025": "232723",
    "2026": "242658",
    "2027": "253396",
    "2028": "261698",
    "2029": "263893",
    "2030": "271283",
    "2031": "281820",
    "2032": "288187",
    "2033": "294643",
    "2034": "303285",
    "2035": "312443",
    "2036": "322753",
    "2037": "337314",
    "2038": "356688",
    "2039": "373849",
    "2040": "385583",
    "2041": "392373",
    "2042": "395125",
    "2043": "392389",
    "2044": "388444",
    "2045": "383897",
    "2046": "378881",
    "2047": "373616",
    "2048": "368245",
    "2049": "362529",
    "2050": "356419"
  },
  {
    "Age": "20-24",
    "2022": "223816",
    "2023": "214959",
    "2024": "211473",
    "2025": "209230",
    "2026": "207395",
    "2027": "210389",
    "2028": "212357",
    "2029": "223083",
    "2030": "232686",
    "2031": "242161",
    "2032": "252433",
    "2033": "260436",
    "2034": "262566",
    "2035": "269873",
    "2036": "280256",
    "2037": "286503",
    "2038": "292792",
    "2039": "301227",
    "2040": "310229",
    "2041": "320371",
    "2042": "334589",
    "2043": "353424",
    "2044": "370056",
    "2045": "381463",
    "2046": "388143",
    "2047": "391004",
    "2048": "388598",
    "2049": "385077",
    "2050": "380955"
  },
  {
    "Age": "25-29",
    "2022": "259175",
    "2023": "260393",
    "2024": "251580",
    "2025": "246211",
    "2026": "235794",
    "2027": "224802",
    "2028": "216697",
    "2029": "213712",
    "2030": "211859",
    "2031": "210311",
    "2032": "213427",
    "2033": "215303",
    "2034": "225622",
    "2035": "234720",
    "2036": "243726",
    "2037": "253579",
    "2038": "261373",
    "2039": "263472",
    "2040": "270631",
    "2041": "280777",
    "2042": "286899",
    "2043": "293127",
    "2044": "301448",
    "2045": "310248",
    "2046": "320073",
    "2047": "333782",
    "2048": "351948",
    "2049": "368006",
    "2050": "379104"
  },
  {
    "Age": "30-34",
    "2022": "245696",
    "2023": "248732",
    "2024": "254490",
    "2025": "254638",
    "2026": "257776",
    "2027": "256065",
    "2028": "257509",
    "2029": "249212",
    "2030": "244470",
    "2031": "234800",
    "2032": "224570",
    "2033": "217061",
    "2034": "214464",
    "2035": "212900",
    "2036": "211553",
    "2037": "214741",
    "2038": "216555",
    "2039": "226601",
    "2040": "235384",
    "2041": "244104",
    "2042": "253705",
    "2043": "261396",
    "2044": "263528",
    "2045": "270629",
    "2046": "280650",
    "2047": "286720",
    "2048": "292905",
    "2049": "301103",
    "2050": "309703"
  },
  {
    "Age": "35-39",
    "2022": "205810",
    "2023": "215837",
    "2024": "223606",
    "2025": "229724",
    "2026": "234787",
    "2027": "241376",
    "2028": "244247",
    "2029": "249910",
    "2030": "250086",
    "2031": "253301",
    "2032": "251753",
    "2033": "253455",
    "2034": "245630",
    "2035": "241417",
    "2036": "232360",
    "2037": "222742",
    "2038": "215704",
    "2039": "213404",
    "2040": "212067",
    "2041": "210890",
    "2042": "214152",
    "2043": "215958",
    "2044": "225829",
    "2045": "234408",
    "2046": "242944",
    "2047": "252372",
    "2048": "259981",
    "2049": "262121",
    "2050": "269133"
  },
  {
    "Age": "40-44",
    "2022": "158540",
    "2023": "165501",
    "2024": "173284",
    "2025": "181788",
    "2026": "192165",
    "2027": "202095",
    "2028": "211748",
    "2029": "219250",
    "2030": "225195",
    "2031": "230126",
    "2032": "236604",
    "2033": "239437",
    "2034": "245091",
    "2035": "245345",
    "2036": "248641",
    "2037": "247234",
    "2038": "249123",
    "2039": "241663",
    "2040": "237833",
    "2041": "229229",
    "2042": "220064",
    "2043": "213389",
    "2044": "211323",
    "2045": "210176",
    "2046": "209145",
    "2047": "212464",
    "2048": "214263",
    "2049": "223981",
    "2050": "232388"
  },
  {
    "Age": "45-49",
    "2022": "134628",
    "2023": "136310",
    "2024": "139335",
    "2025": "144431",
    "2026": "149879",
    "2027": "155740",
    "2028": "162475",
    "2029": "170015",
    "2030": "178254",
    "2031": "188332",
    "2032": "197980",
    "2033": "207390",
    "2034": "214721",
    "2035": "220565",
    "2036": "225425",
    "2037": "231833",
    "2038": "234654",
    "2039": "240289",
    "2040": "240606",
    "2041": "243966",
    "2042": "242695",
    "2043": "244729",
    "2044": "237574",
    "2045": "234034",
    "2046": "225801",
    "2047": "217010",
    "2048": "210637",
    "2049": "208744",
    "2050": "207727"
  },
  {
    "Age": "50-54",
    "2022": "117868",
    "2023": "122820",
    "2024": "125106",
    "2025": "127137",
    "2026": "129115",
    "2027": "131404",
    "2028": "133059",
    "2029": "136013",
    "2030": "140977",
    "2031": "146278",
    "2032": "151989",
    "2033": "158544",
    "2034": "165883",
    "2035": "173901",
    "2036": "183719",
    "2037": "193118",
    "2038": "202302",
    "2039": "209472",
    "2040": "215220",
    "2041": "220018",
    "2042": "226364",
    "2043": "229188",
    "2044": "234803",
    "2045": "235195",
    "2046": "238617",
    "2047": "237492",
    "2048": "239638",
    "2049": "232765",
    "2050": "229454"
  },
  {
    "Age": "55-59",
    "2022": "101239",
    "2023": "101670",
    "2024": "103851",
    "2025": "106445",
    "2026": "109306",
    "2027": "113574",
    "2028": "118328",
    "2029": "120547",
    "2030": "122548",
    "2031": "124501",
    "2032": "126775",
    "2033": "128443",
    "2034": "131350",
    "2035": "136184",
    "2036": "141338",
    "2037": "146896",
    "2038": "153255",
    "2039": "160368",
    "2040": "168142",
    "2041": "177666",
    "2042": "186786",
    "2043": "195710",
    "2044": "202694",
    "2045": "208336",
    "2046": "213077",
    "2047": "219353",
    "2048": "222179",
    "2049": "227736",
    "2050": "228187"
  },
  {
    "Age": "60-64",
    "2022": "85201",
    "2023": "89114",
    "2024": "91866",
    "2025": "93616",
    "2026": "94817",
    "2027": "94714",
    "2028": "95184",
    "2029": "97313",
    "2030": "99812",
    "2031": "102565",
    "2032": "106631",
    "2033": "111153",
    "2034": "113322",
    "2035": "115309",
    "2036": "117253",
    "2037": "119524",
    "2038": "121223",
    "2039": "124075",
    "2040": "128744",
    "2041": "133709",
    "2042": "139076",
    "2043": "145186",
    "2044": "152017",
    "2045": "159489",
    "2046": "168638",
    "2047": "177399",
    "2048": "185973",
    "2049": "192694",
    "2050": "198169"
  },
  {
    "Age": "65-69",
    "2022": "50055",
    "2023": "54366",
    "2024": "60229",
    "2025": "65768",
    "2026": "71364",
    "2027": "76128",
    "2028": "79656",
    "2029": "82196",
    "2030": "83854",
    "2031": "85066",
    "2032": "85121",
    "2033": "85685",
    "2034": "87777",
    "2035": "90181",
    "2036": "92825",
    "2037": "96656",
    "2038": "100900",
    "2039": "103018",
    "2040": "104989",
    "2041": "106920",
    "2042": "109182",
    "2043": "110918",
    "2044": "113701",
    "2045": "118159",
    "2046": "122887",
    "2047": "128006",
    "2048": "133790",
    "2049": "140242",
    "2050": "147300"
  },
  {
    "Age": "70-74",
    "2022": "29014",
    "2023": "31329",
    "2024": "33447",
    "2025": "36147",
    "2026": "38211",
    "2027": "42304",
    "2028": "46024",
    "2029": "51062",
    "2030": "55838",
    "2031": "60684",
    "2032": "64872",
    "2033": "67997",
    "2034": "70324",
    "2035": "71903",
    "2036": "73139",
    "2037": "73387",
    "2038": "74063",
    "2039": "76097",
    "2040": "78379",
    "2041": "80882",
    "2042": "84419",
    "2043": "88311",
    "2044": "90358",
    "2045": "92288",
    "2046": "94187",
    "2047": "96410",
    "2048": "98164",
    "2049": "100832",
    "2050": "104994"
  },
  {
    "Age": "75-79",
    "2022": "14060",
    "2023": "14922",
    "2024": "16229",
    "2025": "17971",
    "2026": "20688",
    "2027": "22263",
    "2028": "24128",
    "2029": "25797",
    "2030": "27955",
    "2031": "29684",
    "2032": "33011",
    "2033": "36068",
    "2034": "40159",
    "2035": "44062",
    "2036": "48043",
    "2037": "51559",
    "2038": "54204",
    "2039": "56255",
    "2040": "57709",
    "2041": "58927",
    "2042": "59358",
    "2043": "60119",
    "2044": "62042",
    "2045": "64142",
    "2046": "66437",
    "2047": "69576",
    "2048": "72995",
    "2049": "74902",
    "2050": "76712"
  },
  {
    "Age": "80-84",
    "2022": "9424",
    "2023": "9970",
    "2024": "9822",
    "2025": "9445",
    "2026": "9187",
    "2027": "9223",
    "2028": "9930",
    "2029": "10861",
    "2030": "12058",
    "2031": "13963",
    "2032": "15076",
    "2033": "16455",
    "2034": "17664",
    "2035": "19248",
    "2036": "20599",
    "2037": "23079",
    "2038": "25395",
    "2039": "28438",
    "2040": "31367",
    "2041": "34369",
    "2042": "37091",
    "2043": "39164",
    "2044": "40852",
    "2045": "42111",
    "2046": "43238",
    "2047": "43797",
    "2048": "44580",
    "2049": "46283",
    "2050": "48087"
  },
  {
    "Age": "85+",
    "2022": "6279",
    "2023": "6259",
    "2024": "6330",
    "2025": "6453",
    "2026": "6677",
    "2027": "7148",
    "2028": "7446",
    "2029": "7408",
    "2030": "7285",
    "2031": "7309",
    "2032": "7662",
    "2033": "8316",
    "2034": "8896",
    "2035": "9582",
    "2036": "10791",
    "2037": "11694",
    "2038": "12949",
    "2039": "14037",
    "2040": "15426",
    "2041": "16990",
    "2042": "19081",
    "2043": "21279",
    "2044": "23838",
    "2045": "26509",
    "2046": "29338",
    "2047": "32328",
    "2048": "34939",
    "2049": "37542",
    "2050": "39928"
  }
]

# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_city_region, gender='jami').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_city_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='jami',
                    population=population
                )

print("Navoi female data import completed successfully!")
