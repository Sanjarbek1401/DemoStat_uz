import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_city_region, _ = Region.objects.get_or_create(name='Samarqand', defaults={'svg_id': 'samarkand'})

# Data to be imported
navoi_male_data = [
  {
    "Age": "Total",
    "2022": "2002809",
    "2023": "2046508",
    "2024": "2089923",
    "2025": "2132662",
    "2026": "2174782",
    "2027": "2216188",
    "2028": "2256772",
    "2029": "2296597",
    "2030": "2335387",
    "2031": "2372968",
    "2032": "2409197",
    "2033": "2444055",
    "2034": "2477581",
    "2035": "2509641",
    "2036": "2540442",
    "2037": "2570003",
    "2038": "2598618",
    "2039": "2626435",
    "2040": "2653646",
    "2041": "2680541",
    "2042": "2707518",
    "2043": "2734847",
    "2044": "2762665",
    "2045": "2791062",
    "2046": "2820196",
    "2047": "2850053",
    "2048": "2880568",
    "2049": "2911679",
    "2050": "2943260"
  },
  {
    "Age": "0-4",
    "2022": "228947",
    "2023": "243058",
    "2024": "253627",
    "2025": "262102",
    "2026": "268323",
    "2027": "270773",
    "2028": "269491",
    "2029": "267668",
    "2030": "265444",
    "2031": "262590",
    "2032": "259066",
    "2033": "254971",
    "2034": "250275",
    "2035": "245129",
    "2036": "239931",
    "2037": "234856",
    "2038": "230218",
    "2039": "226119",
    "2040": "222909",
    "2041": "220652",
    "2042": "219714",
    "2043": "220074",
    "2044": "221717",
    "2045": "224536",
    "2046": "228401",
    "2047": "232903",
    "2048": "237705",
    "2049": "242625",
    "2050": "247424"
  },
  {
    "Age": "5-9",
    "2022": "199269",
    "2023": "202314",
    "2024": "207419",
    "2025": "211706",
    "2026": "217599",
    "2027": "227186",
    "2028": "241109",
    "2029": "251530",
    "2030": "259910",
    "2031": "266089",
    "2032": "268556",
    "2033": "267336",
    "2034": "265593",
    "2035": "263455",
    "2036": "260696",
    "2037": "257275",
    "2038": "253289",
    "2039": "248708",
    "2040": "243683",
    "2041": "238607",
    "2042": "233653",
    "2043": "229131",
    "2044": "225140",
    "2045": "222027",
    "2046": "219852",
    "2047": "218977",
    "2048": "219379",
    "2049": "221045",
    "2050": "223869"
  },
  {
    "Age": "10-14",
    "2022": "182267",
    "2023": "185306",
    "2024": "185589",
    "2025": "189454",
    "2026": "193516",
    "2027": "198123",
    "2028": "201127",
    "2029": "206190",
    "2030": "210434",
    "2031": "216270",
    "2032": "225763",
    "2033": "239567",
    "2034": "249894",
    "2035": "258216",
    "2036": "264370",
    "2037": "266853",
    "2038": "265682",
    "2039": "264002",
    "2040": "261934",
    "2041": "259251",
    "2042": "255916",
    "2043": "252024",
    "2044": "247545",
    "2045": "242625",
    "2046": "237652",
    "2047": "232796",
    "2048": "228361",
    "2049": "224447",
    "2050": "221397"
  },
  {
    "Age": "15-19",
    "2022": "152358",
    "2023": "155766",
    "2024": "164809",
    "2025": "171320",
    "2026": "177910",
    "2027": "181055",
    "2028": "184052",
    "2029": "184327",
    "2030": "188187",
    "2031": "192234",
    "2032": "196821",
    "2033": "199800",
    "2034": "204830",
    "2035": "209051",
    "2036": "214857",
    "2037": "224281",
    "2038": "237976",
    "2039": "248207",
    "2040": "256464",
    "2041": "262578",
    "2042": "265063",
    "2043": "263947",
    "2044": "262344",
    "2045": "260359",
    "2046": "257763",
    "2047": "254516",
    "2048": "250714",
    "2049": "246325",
    "2050": "241493"
  },
  {
    "Age": "20-24",
    "2022": "152080",
    "2023": "147375",
    "2024": "146812",
    "2025": "146139",
    "2026": "147501",
    "2027": "151163",
    "2028": "154435",
    "2029": "163203",
    "2030": "169378",
    "2031": "175662",
    "2032": "178596",
    "2033": "181533",
    "2034": "181892",
    "2035": "185807",
    "2036": "189797",
    "2037": "194250",
    "2038": "197087",
    "2039": "202030",
    "2040": "206224",
    "2041": "211961",
    "2042": "221141",
    "2043": "234447",
    "2044": "244325",
    "2045": "252318",
    "2046": "258277",
    "2047": "260799",
    "2048": "259892",
    "2049": "258552",
    "2050": "256822"
  },
  {
    "Age": "25-29",
    "2022": "182608",
    "2023": "179059",
    "2024": "171599",
    "2025": "165932",
    "2026": "157728",
    "2027": "151221",
    "2028": "146936",
    "2029": "146620",
    "2030": "146100",
    "2031": "147490",
    "2032": "151052",
    "2033": "154078",
    "2034": "162435",
    "2035": "168225",
    "2036": "174272",
    "2037": "177126",
    "2038": "180092",
    "2039": "180486",
    "2040": "184324",
    "2041": "188188",
    "2042": "192577",
    "2043": "195411",
    "2044": "200323",
    "2045": "204441",
    "2046": "210002",
    "2047": "218804",
    "2048": "231611",
    "2049": "241088",
    "2050": "248835"
  },
  {
    "Age": "30-34",
    "2022": "175230",
    "2023": "177476",
    "2024": "178394",
    "2025": "180643",
    "2026": "181773",
    "2027": "179519",
    "2028": "176285",
    "2029": "169289",
    "2030": "164122",
    "2031": "156443",
    "2032": "150398",
    "2033": "146430",
    "2034": "146289",
    "2035": "145872",
    "2036": "147277",
    "2037": "150773",
    "2038": "153651",
    "2039": "161762",
    "2040": "167338",
    "2041": "173258",
    "2042": "176086",
    "2043": "179095",
    "2044": "179552",
    "2045": "183399",
    "2046": "187242",
    "2047": "191629",
    "2048": "194464",
    "2049": "199330",
    "2050": "203364"
  },
  {
    "Age": "35-39",
    "2022": "153054",
    "2023": "159709",
    "2024": "165022",
    "2025": "167100",
    "2026": "169358",
    "2027": "171809",
    "2028": "173984",
    "2029": "174891",
    "2030": "177148",
    "2031": "178351",
    "2032": "176284",
    "2033": "173344",
    "2034": "166726",
    "2035": "161944",
    "2036": "154654",
    "2037": "148946",
    "2038": "145204",
    "2039": "145185",
    "2040": "144847",
    "2041": "146274",
    "2042": "149742",
    "2043": "152546",
    "2044": "160512",
    "2045": "165967",
    "2046": "171825",
    "2047": "174654",
    "2048": "177699",
    "2049": "178196",
    "2050": "182020"
  },
  {
    "Age": "40-44",
    "2022": "119834",
    "2023": "124865",
    "2024": "130116",
    "2025": "136195",
    "2026": "143396",
    "2027": "150298",
    "2028": "156744",
    "2029": "161931",
    "2030": "163974",
    "2031": "166216",
    "2032": "168650",
    "2033": "170828",
    "2034": "171769",
    "2035": "174053",
    "2036": "175316",
    "2037": "173381",
    "2038": "170641",
    "2039": "164286",
    "2040": "159763",
    "2041": "152744",
    "2042": "147271",
    "2043": "143698",
    "2044": "143776",
    "2045": "143513",
    "2046": "144971",
    "2047": "148430",
    "2048": "151189",
    "2049": "159044",
    "2050": "164403"
  },
  {
    "Age": "45-49",
    "2022": "100265",
    "2023": "103088",
    "2024": "106626",
    "2025": "110235",
    "2026": "113689",
    "2027": "117862",
    "2028": "122764",
    "2029": "127886",
    "2030": "133821",
    "2031": "140861",
    "2032": "147617",
    "2033": "153940",
    "2034": "159051",
    "2035": "161084",
    "2036": "163326",
    "2037": "165758",
    "2038": "167945",
    "2039": "168915",
    "2040": "171214",
    "2041": "172523",
    "2042": "170699",
    "2043": "168117",
    "2044": "161969",
    "2045": "157649",
    "2046": "150849",
    "2047": "145565",
    "2048": "142125",
    "2049": "142266",
    "2050": "142050"
  },
  {
    "Age": "50-54",
    "2022": "88429",
    "2023": "89920",
    "2024": "90541",
    "2025": "93377",
    "2026": "95358",
    "2027": "98275",
    "2028": "101031",
    "2029": "104492",
    "2030": "108027",
    "2031": "111413",
    "2032": "115509",
    "2033": "120316",
    "2034": "125336",
    "2035": "131153",
    "2036": "138052",
    "2037": "144679",
    "2038": "150887",
    "2039": "155924",
    "2040": "157947",
    "2041": "160192",
    "2042": "162632",
    "2043": "164841",
    "2044": "165850",
    "2045": "168168",
    "2046": "169524",
    "2047": "167807",
    "2048": "165363",
    "2049": "159393",
    "2050": "155236"
  },
  {
    "Age": "55-59",
    "2022": "87457",
    "2023": "86155",
    "2024": "86180",
    "2025": "84970",
    "2026": "84937",
    "2027": "85803",
    "2028": "87271",
    "2029": "87898",
    "2030": "90671",
    "2031": "92617",
    "2032": "95484",
    "2033": "98183",
    "2034": "101567",
    "2035": "105028",
    "2036": "108341",
    "2037": "112358",
    "2038": "117057",
    "2039": "121962",
    "2040": "127644",
    "2041": "134379",
    "2042": "140863",
    "2043": "146941",
    "2044": "151891",
    "2045": "153906",
    "2046": "156161",
    "2047": "158621",
    "2048": "160852",
    "2049": "161896",
    "2050": "164210"
  },
  {
    "Age": "60-64",
    "2022": "75311",
    "2023": "79004",
    "2024": "80943",
    "2025": "82098",
    "2026": "83007",
    "2027": "82783",
    "2028": "81594",
    "2029": "81689",
    "2030": "80594",
    "2031": "80644",
    "2032": "81542",
    "2033": "83001",
    "2034": "83662",
    "2035": "86359",
    "2036": "88273",
    "2037": "91081",
    "2038": "93712",
    "2039": "96999",
    "2040": "100365",
    "2041": "103587",
    "2042": "107507",
    "2043": "112069",
    "2044": "116832",
    "2045": "122347",
    "2046": "128872",
    "2047": "135172",
    "2048": "141074",
    "2049": "145891",
    "2050": "147879"
  },
  {
    "Age": "65-69",
    "2022": "47835",
    "2023": "51278",
    "2024": "56241",
    "2025": "60761",
    "2026": "65115",
    "2027": "68555",
    "2028": "71962",
    "2029": "73784",
    "2030": "74908",
    "2031": "75829",
    "2032": "75725",
    "2033": "74736",
    "2034": "74955",
    "2035": "74047",
    "2036": "74227",
    "2037": "75178",
    "2038": "76632",
    "2039": "77352",
    "2040": "79947",
    "2041": "81825",
    "2042": "84554",
    "2043": "87099",
    "2044": "90261",
    "2045": "93505",
    "2046": "96613",
    "2047": "100401",
    "2048": "104774",
    "2049": "109334",
    "2050": "114607"
  },
  {
    "Age": "70-74",
    "2022": "29683",
    "2023": "31790",
    "2024": "33621",
    "2025": "35740",
    "2026": "37396",
    "2027": "41346",
    "2028": "44390",
    "2029": "48763",
    "2030": "52763",
    "2031": "56625",
    "2032": "59730",
    "2033": "62812",
    "2034": "64525",
    "2035": "65638",
    "2036": "66592",
    "2037": "66647",
    "2038": "65916",
    "2039": "66281",
    "2040": "65604",
    "2041": "65933",
    "2042": "66941",
    "2043": "68377",
    "2044": "69168",
    "2045": "71624",
    "2046": "73451",
    "2047": "76067",
    "2048": "78492",
    "2049": "81474",
    "2050": "84540"
  },
  {
    "Age": "75-79",
    "2022": "15341",
    "2023": "16268",
    "2024": "17638",
    "2025": "19790",
    "2026": "22345",
    "2027": "23448",
    "2028": "25197",
    "2029": "26694",
    "2030": "28475",
    "2031": "29929",
    "2032": "33217",
    "2033": "35796",
    "2034": "39458",
    "2035": "42833",
    "2036": "46100",
    "2037": "48793",
    "2038": "51468",
    "2039": "53036",
    "2040": "54113",
    "2041": "55074",
    "2042": "55296",
    "2043": "54857",
    "2044": "55365",
    "2045": "54952",
    "2046": "55434",
    "2047": "56479",
    "2048": "57855",
    "2049": "58698",
    "2050": "60932"
  },
  {
    "Age": "80-84",
    "2022": "8928",
    "2023": "9851",
    "2024": "10206",
    "2025": "10159",
    "2026": "10385",
    "2027": "10503",
    "2028": "11261",
    "2029": "12272",
    "2030": "13814",
    "2031": "15688",
    "2032": "16503",
    "2033": "17848",
    "2034": "18985",
    "2035": "20381",
    "2036": "21587",
    "2037": "24111",
    "2038": "26142",
    "2039": "28976",
    "2040": "31611",
    "2041": "34167",
    "2042": "36346",
    "2043": "38508",
    "2044": "39858",
    "2045": "40843",
    "2046": "41759",
    "2047": "42116",
    "2048": "41960",
    "2049": "42562",
    "2050": "42402"
  },
  {
    "Age": "85+",
    "2022": "3913",
    "2023": "4225",
    "2024": "4540",
    "2025": "4941",
    "2026": "5446",
    "2027": "6466",
    "2028": "7140",
    "2029": "7470",
    "2030": "7618",
    "2031": "8018",
    "2032": "8682",
    "2033": "9538",
    "2034": "10338",
    "2035": "11366",
    "2036": "12775",
    "2037": "13656",
    "2038": "15019",
    "2039": "16205",
    "2040": "17716",
    "2041": "19349",
    "2042": "21517",
    "2043": "23665",
    "2044": "26236",
    "2045": "28882",
    "2046": "31548",
    "2047": "34318",
    "2048": "37056",
    "2049": "39514",
    "2050": "41774"
  }
]

# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_city_region, gender='ayol').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_city_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='ayol',
                    population=population
                )

print("Navoi female data import completed successfully!")
