import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Respublika region
respublika_region, _ = Region.objects.get_or_create(name='Respublika', defaults={'svg_id': 'respublika'})

# Data to be imported
navoi_male_data = [
  {
    "2021": "35271296",
    "2022": "35990940",
    "2023": "36705435",
    "2024": "37407540",
    "2025": "38097457",
    "2026": "38773179",
    "2027": "39433052",
    "2028": "40078492",
    "2029": "40705647",
    "2030": "41312375",
    "2031": "41896264",
    "2032": "42456863",
    "2033": "42994509",
    "2034": "43506838",
    "2035": "43997722",
    "2036": "44467446",
    "2037": "44920521",
    "2038": "45359151",
    "2039": "45786856",
    "2040": "46208537",
    "2041": "46630525",
    "2042": "47057175",
    "2043": "47490483",
    "2044": "47931700",
    "2045": "48383157",
    "2046": "48844284",
    "2047": "49313979",
    "2048": "49791238",
    "2049": "50273601",
    "2050": "50758215",
    "Age": "Total"
  },
  {
    "2021": "3932322",
    "2022": "4150995",
    "2023": "4322290",
    "2024": "4437443",
    "2025": "4505637",
    "2026": "4524464",
    "2027": "4500514",
    "2028": "4465450",
    "2029": "4423163",
    "2030": "4371614",
    "2031": "4310591",
    "2032": "4241454",
    "2033": "4163160",
    "2034": "4077257",
    "2035": "3989938",
    "2036": "3904176",
    "2037": "3825075",
    "2038": "3754661",
    "2039": "3698919",
    "2040": "3658759",
    "2041": "3639989",
    "2042": "3642429",
    "2043": "3665769",
    "2044": "3707753",
    "2045": "3765835",
    "2046": "3833269",
    "2047": "3904605",
    "2048": "3976951",
    "2049": "4046752",
    "2050": "4108934",
    "Age": "0-4"
  },
  {
    "2021": "3432468",
    "2022": "3483151",
    "2023": "3555503",
    "2024": "3638939",
    "2025": "3747877",
    "2026": "3906298",
    "2027": "4121038",
    "2028": "4289210",
    "2029": "4402531",
    "2030": "4470071",
    "2031": "4489330",
    "2032": "4466608",
    "2033": "4433138",
    "2034": "4392638",
    "2035": "4343054",
    "2036": "4284159",
    "2037": "4217290",
    "2038": "4141397",
    "2039": "4058009",
    "2040": "3973241",
    "2041": "3890004",
    "2042": "3813322",
    "2043": "3745150",
    "2044": "3691396",
    "2045": "3652902",
    "2046": "3635412",
    "2047": "3638723",
    "2048": "3662543",
    "2049": "3704661",
    "2050": "3762589",
    "Age": "5-9"
  },
  {
    "2021": "3153693",
    "2022": "3183543",
    "2023": "3201282",
    "2024": "3251302",
    "2025": "3330421",
    "2026": "3415591",
    "2027": "3465418",
    "2028": "3536886",
    "2029": "3619181",
    "2030": "3726576",
    "2031": "3882770",
    "2032": "4094895",
    "2033": "4261016",
    "2034": "4373211",
    "2035": "4440466",
    "2036": "4460211",
    "2037": "4438542",
    "2038": "4406380",
    "2039": "4367326",
    "2040": "4319335",
    "2041": "4262188",
    "2042": "4197211",
    "2043": "4123339",
    "2044": "4042056",
    "2045": "3959394",
    "2046": "3878184",
    "2047": "3803383",
    "2048": "3736889",
    "2049": "3684559",
    "2050": "3647199",
    "Age": "10-14"
  },
  {
    "2021": "2616235",
    "2022": "2696537",
    "2023": "2838520",
    "2024": "2954556",
    "2025": "3063705",
    "2026": "3134586",
    "2027": "3163641",
    "2028": "3181152",
    "2029": "3230958",
    "2030": "3309560",
    "2031": "3394092",
    "2032": "3443407",
    "2033": "3514271",
    "2034": "3595877",
    "2035": "3702369",
    "2036": "3856975",
    "2037": "4066805",
    "2038": "4230896",
    "2039": "4341871",
    "2040": "4408682",
    "2041": "4428786",
    "2042": "4408182",
    "2043": "4377427",
    "2044": "4339908",
    "2045": "4293552",
    "2046": "4238112",
    "2047": "4174887",
    "2048": "4102809",
    "2049": "4023339",
    "2050": "3942456",
    "Age": "15-19"
  },
  {
    "2021": "2644952",
    "2022": "2586412",
    "2023": "2555993",
    "2024": "2561677",
    "2025": "2573820",
    "2026": "2620384",
    "2027": "2698423",
    "2028": "2836450",
    "2029": "2947979",
    "2030": "3052610",
    "2031": "3120281",
    "2032": "3148736",
    "2033": "3167409",
    "2034": "3218050",
    "2035": "3295819",
    "2036": "3378402",
    "2037": "3426038",
    "2038": "3495797",
    "2039": "3576690",
    "2040": "3681810",
    "2041": "3832641",
    "2042": "4036461",
    "2043": "4195101",
    "2044": "4302753",
    "2045": "4368368",
    "2046": "4389494",
    "2047": "4371690",
    "2048": "4344392",
    "2049": "4310411",
    "2050": "4267655",
    "Age": "20-24"
  },
  {
    "2021": "3156976",
    "2022": "3081278",
    "2023": "2973506",
    "2024": "2886445",
    "2025": "2764388",
    "2026": "2663693",
    "2027": "2610738",
    "2028": "2583840",
    "2029": "2591337",
    "2030": "2604142",
    "2031": "2649643",
    "2032": "2723919",
    "2033": "2856060",
    "2034": "2962051",
    "2035": "3062812",
    "2036": "3128952",
    "2037": "3157842",
    "2038": "3177229",
    "2039": "3227278",
    "2040": "3303211",
    "2041": "3384469",
    "2042": "3432114",
    "2043": "3501603",
    "2044": "3580956",
    "2045": "3682849",
    "2046": "3827997",
    "2047": "4024638",
    "2048": "4177554",
    "2049": "4282107",
    "2050": "4346913",
    "Age": "25-29"
  },
  {
    "2021": "3130619",
    "2022": "3158593",
    "2023": "3175628",
    "2024": "3182127",
    "2025": "3185469",
    "2026": "3126834",
    "2027": "3056730",
    "2028": "2955669",
    "2029": "2875497",
    "2030": "2760646",
    "2031": "2666280",
    "2032": "2617757",
    "2033": "2593478",
    "2034": "2602210",
    "2035": "2615405",
    "2036": "2659986",
    "2037": "2731525",
    "2038": "2859514",
    "2039": "2961782",
    "2040": "3059996",
    "2041": "3125211",
    "2042": "3154669",
    "2043": "3175010",
    "2044": "3225227",
    "2045": "3300448",
    "2046": "3381137",
    "2047": "3428762",
    "2048": "3497616",
    "2049": "3575349",
    "2050": "3674438",
    "Age": "30-34"
  },
  {
    "2021": "2747566",
    "2022": "2864771",
    "2023": "2952573",
    "2024": "2995653",
    "2025": "3031991",
    "2026": "3075313",
    "2027": "3102562",
    "2028": "3120175",
    "2029": "3128106",
    "2030": "3133946",
    "2031": "3079607",
    "2032": "3014888",
    "2033": "2919764",
    "2034": "2845397",
    "2035": "2736507",
    "2036": "2647270",
    "2037": "2602273",
    "2038": "2580081",
    "2039": "2589847",
    "2040": "2603483",
    "2041": "2647576",
    "2042": "2717316",
    "2043": "2842356",
    "2044": "2942032",
    "2045": "3038490",
    "2046": "3103168",
    "2047": "3133152",
    "2048": "3154138",
    "2049": "3204136",
    "2050": "3278218",
    "Age": "35-39"
  },
  {
    "2021": "2205007",
    "2022": "2283244",
    "2023": "2364940",
    "2024": "2456499",
    "2025": "2574235",
    "2026": "2695099",
    "2027": "2807778",
    "2028": "2892744",
    "2029": "2934765",
    "2030": "2970689",
    "2031": "3013783",
    "2032": "3041454",
    "2033": "3060227",
    "2034": "3069708",
    "2035": "3077624",
    "2036": "3026644",
    "2037": "2966026",
    "2038": "2875469",
    "2039": "2805459",
    "2040": "2701144",
    "2041": "2615864",
    "2042": "2573674",
    "2043": "2553285",
    "2044": "2564073",
    "2045": "2578291",
    "2046": "2622142",
    "2047": "2690564",
    "2048": "2813222",
    "2049": "2910772",
    "2050": "3005631",
    "Age": "40-44"
  },
  {
    "2021": "1949075",
    "2022": "1965008",
    "2023": "2000445",
    "2024": "2060959",
    "2025": "2111652",
    "2026": "2162309",
    "2027": "2237990",
    "2028": "2317056",
    "2029": "2405746",
    "2030": "2520083",
    "2031": "2637534",
    "2032": "2747282",
    "2033": "2830443",
    "2034": "2871999",
    "2035": "2907920",
    "2036": "2951129",
    "2037": "2979336",
    "2038": "2999064",
    "2039": "3009719",
    "2040": "3019255",
    "2041": "2971142",
    "2042": "2913948",
    "2043": "2827237",
    "2044": "2760827",
    "2045": "2660493",
    "2046": "2578647",
    "2047": "2538852",
    "2048": "2519911",
    "2049": "2531428",
    "2050": "2545964",
    "Age": "45-49"
  },
  {
    "2021": "1671457",
    "2022": "1734257",
    "2023": "1776482",
    "2024": "1824902",
    "2025": "1862688",
    "2026": "1898938",
    "2027": "1914473",
    "2028": "1948994",
    "2029": "2007897",
    "2030": "2057291",
    "2031": "2106771",
    "2032": "2180524",
    "2033": "2257542",
    "2034": "2343922",
    "2035": "2455311",
    "2036": "2569730",
    "2037": "2676783",
    "2038": "2758227",
    "2039": "2799380",
    "2040": "2835370",
    "2041": "2878824",
    "2042": "2907695",
    "2043": "2928425",
    "2044": "2940238",
    "2045": "2951329",
    "2046": "2906070",
    "2047": "2852101",
    "2048": "2768987",
    "2049": "2705770",
    "2050": "2609180",
    "Age": "50-54"
  },
  {
    "2021": "1527503",
    "2022": "1521029",
    "2023": "1532629",
    "2024": "1533864",
    "2025": "1560153",
    "2026": "1607902",
    "2027": "1668332",
    "2028": "1709091",
    "2029": "1755833",
    "2030": "1792571",
    "2031": "1828361",
    "2032": "1844133",
    "2033": "1878128",
    "2034": "1935513",
    "2035": "1983762",
    "2036": "2032239",
    "2037": "2103903",
    "2038": "2178728",
    "2039": "2262647",
    "2040": "2370745",
    "2041": "2481779",
    "2042": "2585748",
    "2043": "2665187",
    "2044": "2705933",
    "2045": "2742126",
    "2046": "2785975",
    "2047": "2815587",
    "2048": "2837233",
    "2049": "2849991",
    "2050": "2862449",
    "Age": "55-59"
  },
  {
    "2021": "1298018",
    "2022": "1354669",
    "2023": "1387551",
    "2024": "1413159",
    "2025": "1426157",
    "2026": "1426321",
    "2027": "1421230",
    "2028": "1433542",
    "2029": "1435808",
    "2030": "1461825",
    "2031": "1507899",
    "2032": "1565642",
    "2033": "1604939",
    "2034": "1649763",
    "2035": "1685453",
    "2036": "1720885",
    "2037": "1737243",
    "2038": "1770759",
    "2039": "1826255",
    "2040": "1873123",
    "2041": "1920463",
    "2042": "1989472",
    "2043": "2061597",
    "2044": "2142514",
    "2045": "2246453",
    "2046": "2353154",
    "2047": "2453029",
    "2048": "2529626",
    "2049": "2569542",
    "2050": "2605610",
    "Age": "60-64"
  },
  {
    "2021": "820718",
    "2022": "873799",
    "2023": "952266",
    "2024": "1023135",
    "2025": "1093926",
    "2026": "1158811",
    "2027": "1210067",
    "2028": "1240625",
    "2029": "1264930",
    "2030": "1278370",
    "2031": "1280717",
    "2032": "1278135",
    "2033": "1291787",
    "2034": "1295883",
    "2035": "1321868",
    "2036": "1366018",
    "2037": "1420491",
    "2038": "1458131",
    "2039": "1500637",
    "2040": "1535117",
    "2041": "1570067",
    "2042": "1587250",
    "2043": "1620230",
    "2044": "1673399",
    "2045": "1718624",
    "2046": "1764529",
    "2047": "1830099",
    "2048": "1898657",
    "2049": "1975482",
    "2050": "2073675",
    "Age": "65-69"
  },
  {
    "2021": "503149",
    "2022": "544107",
    "2023": "578248",
    "2024": "615218",
    "2025": "642543",
    "2026": "693391",
    "2027": "739603",
    "2028": "807500",
    "2029": "868996",
    "2030": "930775",
    "2031": "988011",
    "2032": "1033620",
    "2033": "1062043",
    "2034": "1085223",
    "2035": "1099419",
    "2036": "1104406",
    "2037": "1104818",
    "2038": "1119839",
    "2039": "1125970",
    "2040": "1151621",
    "2041": "1193223",
    "2042": "1243568",
    "2043": "1279148",
    "2044": "1318697",
    "2045": "1351547",
    "2046": "1385567",
    "2047": "1403465",
    "2048": "1435433",
    "2049": "1485293",
    "2050": "1527997",
    "Age": "70-74"
  },
  {
    "2021": "247365",
    "2022": "258535",
    "2023": "283348",
    "2024": "316213",
    "2025": "360703",
    "2026": "387145",
    "2027": "419906",
    "2028": "446889",
    "2029": "476679",
    "2030": "500068",
    "2031": "541764",
    "2032": "580344",
    "2033": "636091",
    "2034": "686851",
    "2035": "738202",
    "2036": "786487",
    "2037": "825347",
    "2038": "851002",
    "2039": "872399",
    "2040": "886884",
    "2041": "894317",
    "2042": "897647",
    "2043": "913583",
    "2044": "921620",
    "2045": "946318",
    "2046": "984282",
    "2047": "1028977",
    "2048": "1061370",
    "2049": "1096452",
    "2050": "1126465",
    "Age": "75-79"
  },
  {
    "2021": "161159",
    "2022": "172439",
    "2023": "169058",
    "2024": "162975",
    "2025": "162535",
    "2026": "163592",
    "2027": "173148",
    "2028": "190684",
    "2029": "213433",
    "2030": "244948",
    "2031": "263864",
    "2032": "287885",
    "2033": "307545",
    "2034": "329753",
    "2035": "348565",
    "2036": "380106",
    "2037": "409996",
    "2038": "452123",
    "2039": "490747",
    "2040": "530107",
    "2041": "567788",
    "2042": "598511",
    "2043": "620200",
    "2044": "638767",
    "2045": "652618",
    "2046": "661612",
    "2047": "667175",
    "2048": "682802",
    "2049": "691840",
    "2050": "714041",
    "Age": "80-84"
  },
  {
    "2021": "73014",
    "2022": "78573",
    "2023": "85174",
    "2024": "92475",
    "2025": "99556",
    "2026": "112506",
    "2027": "121461",
    "2028": "122535",
    "2029": "122807",
    "2030": "126589",
    "2031": "134966",
    "2032": "146180",
    "2033": "157469",
    "2034": "171532",
    "2035": "193229",
    "2036": "209673",
    "2037": "231188",
    "2038": "249853",
    "2039": "271921",
    "2040": "296654",
    "2041": "326196",
    "2042": "357958",
    "2043": "395835",
    "2044": "433552",
    "2045": "473519",
    "2046": "515532",
    "2047": "554293",
    "2048": "591105",
    "2049": "625719",
    "2050": "658803",
    "Age": "85+"
  }
]

# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Respublika total data
StatisticsData.objects.filter(region=respublika_region, gender='jami').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=respublika_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='jami',
                    population=population
                )

print("Respublika total data import completed successfully!")
