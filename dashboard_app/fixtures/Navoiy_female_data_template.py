import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_city_region, _ = Region.objects.get_or_create(name='Navoiy', defaults={'svg_id': 'navoi'})

# Data to be imported
navoi_male_data = [
  {
    "2021": "509795",
    "2022": "519640",
    "2023": "529429",
    "2024": "539095",
    "2025": "548644",
    "2026": "558029",
    "2027": "567212",
    "2028": "576202",
    "2029": "584954",
    "2030": "593453",
    "2031": "601668",
    "2032": "609589",
    "2033": "617214",
    "2034": "624497",
    "2035": "631490",
    "2036": "638198",
    "2037": "644680",
    "2038": "650960",
    "2039": "657083",
    "2040": "663109",
    "2041": "669118",
    "2042": "675162",
    "2043": "681262",
    "2044": "687428",
    "2045": "693688",
    "2046": "700030",
    "2047": "706445",
    "2048": "712924",
    "2049": "719444",
    "2050": "725976",
    "Age": "Total"
  },
  {
    "2021": "54271",
    "2022": "57043",
    "2023": "59189",
    "2024": "60798",
    "2025": "61678",
    "2026": "61498",
    "2027": "61250",
    "2028": "60844",
    "2029": "60325",
    "2030": "59670",
    "2031": "58892",
    "2032": "58020",
    "2033": "57037",
    "2034": "55948",
    "2035": "54827",
    "2036": "53711",
    "2037": "52669",
    "2038": "51733",
    "2039": "50982",
    "2040": "50426",
    "2041": "50135",
    "2042": "50103",
    "2043": "50323",
    "2044": "50764",
    "2045": "51388",
    "2046": "52111",
    "2047": "52869",
    "2048": "53636",
    "2049": "54376",
    "2050": "55037",
    "Age": "0-4"
  },
  {
    "2021": "47301",
    "2022": "47995",
    "2023": "48925",
    "2024": "49942",
    "2025": "51520",
    "2026": "53744",
    "2027": "56424",
    "2028": "58501",
    "2029": "60070",
    "2030": "60946",
    "2031": "60794",
    "2032": "60586",
    "2033": "60226",
    "2034": "59758",
    "2035": "59158",
    "2036": "58439",
    "2037": "57629",
    "2038": "56710",
    "2039": "55690",
    "2040": "54638",
    "2041": "53591",
    "2042": "52616",
    "2043": "51742",
    "2044": "51047",
    "2045": "50538",
    "2046": "50283",
    "2047": "50276",
    "2048": "50510",
    "2049": "50956",
    "2050": "51578",
    "Age": "5-9"
  },
  {
    "2021": "42816",
    "2022": "43278",
    "2023": "43823",
    "2024": "44722",
    "2025": "45578",
    "2026": "46970",
    "2027": "47643",
    "2028": "48556",
    "2029": "49549",
    "2030": "51087",
    "2031": "53255",
    "2032": "55874",
    "2033": "57906",
    "2034": "59452",
    "2035": "60328",
    "2036": "60199",
    "2037": "60024",
    "2038": "59700",
    "2039": "59272",
    "2040": "58716",
    "2041": "58046",
    "2042": "57288",
    "2043": "56425",
    "2044": "55462",
    "2045": "54467",
    "2046": "53473",
    "2047": "52548",
    "2048": "51716",
    "2049": "51056",
    "2050": "50574",
    "Age": "10-14"
  },
  {
    "2021": "36059",
    "2022": "37324",
    "2023": "38958",
    "2024": "40131",
    "2025": "41433",
    "2026": "42482",
    "2027": "42922",
    "2028": "43459",
    "2029": "44349",
    "2030": "45194",
    "2031": "46569",
    "2032": "47226",
    "2033": "48124",
    "2034": "49100",
    "2035": "50611",
    "2036": "52741",
    "2037": "55309",
    "2038": "57290",
    "2039": "58803",
    "2040": "59668",
    "2041": "59559",
    "2042": "59420",
    "2043": "59135",
    "2044": "58750",
    "2045": "58239",
    "2046": "57614",
    "2047": "56902",
    "2048": "56084",
    "2049": "55165",
    "2050": "54214",
    "Age": "15-19"
  },
  {
    "2021": "35405",
    "2022": "35093",
    "2023": "35276",
    "2024": "35962",
    "2025": "36691",
    "2026": "37289",
    "2027": "38462",
    "2028": "39964",
    "2029": "41007",
    "2030": "42164",
    "2031": "43087",
    "2032": "43497",
    "2033": "44050",
    "2034": "44939",
    "2035": "45740",
    "2036": "47022",
    "2037": "47592",
    "2038": "48446",
    "2039": "49393",
    "2040": "50852",
    "2041": "52849",
    "2042": "55200",
    "2043": "56972",
    "2044": "58345",
    "2045": "59183",
    "2046": "59159",
    "2047": "59142",
    "2048": "58980",
    "2049": "58721",
    "2050": "58341",
    "Age": "20-24"
  },
  {
    "2021": "45652",
    "2022": "43665",
    "2023": "41601",
    "2024": "39784",
    "2025": "38548",
    "2026": "37845",
    "2027": "37699",
    "2028": "37943",
    "2029": "38608",
    "2030": "39298",
    "2031": "39840",
    "2032": "40872",
    "2033": "42192",
    "2034": "43088",
    "2035": "44135",
    "2036": "45010",
    "2037": "45426",
    "2038": "45966",
    "2039": "46802",
    "2040": "47529",
    "2041": "48751",
    "2042": "49321",
    "2043": "50180",
    "2044": "51077",
    "2045": "52398",
    "2046": "54164",
    "2047": "56267",
    "2048": "57862",
    "2049": "59142",
    "2050": "59976",
    "Age": "25-29"
  },
  {
    "2021": "46345",
    "2022": "46601",
    "2023": "46925",
    "2024": "46909",
    "2025": "46971",
    "2026": "45274",
    "2027": "43657",
    "2028": "41972",
    "2029": "40493",
    "2030": "39515",
    "2031": "38983",
    "2032": "38931",
    "2033": "39206",
    "2034": "39855",
    "2035": "40522",
    "2036": "41034",
    "2037": "41991",
    "2038": "43220",
    "2039": "44050",
    "2040": "45051",
    "2041": "45914",
    "2042": "46353",
    "2043": "46910",
    "2044": "47747",
    "2045": "48458",
    "2046": "49661",
    "2047": "50226",
    "2048": "51068",
    "2049": "51912",
    "2050": "53129",
    "Age": "30-34"
  },
  {
    "2021": "42335",
    "2022": "43706",
    "2023": "44384",
    "2024": "44924",
    "2025": "44426",
    "2026": "44997",
    "2027": "45233",
    "2028": "45577",
    "2029": "45617",
    "2030": "45804",
    "2031": "44335",
    "2032": "42985",
    "2033": "41557",
    "2034": "40299",
    "2035": "39489",
    "2036": "39065",
    "2037": "39072",
    "2038": "39367",
    "2039": "40009",
    "2040": "40667",
    "2041": "41171",
    "2042": "42097",
    "2043": "43285",
    "2044": "44089",
    "2045": "45073",
    "2046": "45933",
    "2047": "46384",
    "2048": "46942",
    "2049": "47759",
    "2050": "48435",
    "Age": "35-39"
  },
  {
    "2021": "33563",
    "2022": "35077",
    "2023": "36378",
    "2024": "37804",
    "2025": "39419",
    "2026": "41043",
    "2027": "42319",
    "2028": "42963",
    "2029": "43521",
    "2030": "43066",
    "2031": "43651",
    "2032": "43896",
    "2033": "44268",
    "2034": "44354",
    "2035": "44620",
    "2036": "43292",
    "2037": "42102",
    "2038": "40828",
    "2039": "39705",
    "2040": "38996",
    "2041": "38642",
    "2042": "38693",
    "2043": "39008",
    "2044": "39656",
    "2045": "40317",
    "2046": "40821",
    "2047": "41724",
    "2048": "42877",
    "2049": "43653",
    "2050": "44609",
    "Age": "40-44"
  },
  {
    "2021": "29610",
    "2022": "30006",
    "2023": "30422",
    "2024": "31128",
    "2025": "31907",
    "2026": "32786",
    "2027": "34222",
    "2028": "35450",
    "2029": "36802",
    "2030": "38339",
    "2031": "39891",
    "2032": "41123",
    "2033": "41755",
    "2034": "42328",
    "2035": "41909",
    "2036": "42507",
    "2037": "42763",
    "2038": "43153",
    "2039": "43266",
    "2040": "43579",
    "2041": "42347",
    "2042": "41267",
    "2043": "40099",
    "2044": "39071",
    "2045": "38435",
    "2046": "38130",
    "2047": "38208",
    "2048": "38532",
    "2049": "39174",
    "2050": "39826",
    "Age": "45-49"
  },
  {
    "2021": "23867",
    "2022": "24723",
    "2023": "25850",
    "2024": "26931",
    "2025": "27935",
    "2026": "28844",
    "2027": "29219",
    "2028": "29624",
    "2029": "30307",
    "2030": "31060",
    "2031": "31905",
    "2032": "33289",
    "2033": "34468",
    "2034": "35768",
    "2035": "37248",
    "2036": "38745",
    "2037": "39942",
    "2038": "40564",
    "2039": "41147",
    "2040": "40758",
    "2041": "41371",
    "2042": "41643",
    "2043": "42053",
    "2044": "42192",
    "2045": "42538",
    "2046": "41382",
    "2047": "40384",
    "2048": "39294",
    "2049": "38334",
    "2050": "37747",
    "Age": "50-54"
  },
  {
    "2021": "23818",
    "2022": "23442",
    "2023": "23288",
    "2024": "22865",
    "2025": "22785",
    "2026": "23098",
    "2027": "23914",
    "2028": "24987",
    "2029": "26011",
    "2030": "26966",
    "2031": "27840",
    "2032": "28206",
    "2033": "28608",
    "2034": "29275",
    "2035": "30006",
    "2036": "30822",
    "2037": "32155",
    "2038": "33285",
    "2039": "34535",
    "2040": "35958",
    "2041": "37404",
    "2042": "38567",
    "2043": "39181",
    "2044": "39773",
    "2045": "39420",
    "2046": "40051",
    "2047": "40340",
    "2048": "40760",
    "2049": "40912",
    "2050": "41274",
    "Age": "55-59"
  },
  {
    "2021": "20358",
    "2022": "21269",
    "2023": "21740",
    "2024": "22031",
    "2025": "22269",
    "2026": "22277",
    "2027": "21940",
    "2028": "21823",
    "2029": "21452",
    "2030": "21405",
    "2031": "21720",
    "2032": "22498",
    "2033": "23516",
    "2034": "24480",
    "2035": "25382",
    "2036": "26219",
    "2037": "26578",
    "2038": "26980",
    "2039": "27630",
    "2040": "28339",
    "2041": "29127",
    "2042": "30403",
    "2043": "31486",
    "2044": "32682",
    "2045": "34045",
    "2046": "35432",
    "2047": "36554",
    "2048": "37151",
    "2049": "37742",
    "2050": "37421",
    "Age": "60-64"
  },
  {
    "2021": "13062",
    "2022": "13729",
    "2023": "14880",
    "2024": "16228",
    "2025": "17245",
    "2026": "18221",
    "2027": "19037",
    "2028": "19466",
    "2029": "19750",
    "2030": "19989",
    "2031": "20029",
    "2032": "19755",
    "2033": "19691",
    "2034": "19393",
    "2035": "19391",
    "2036": "19713",
    "2037": "20449",
    "2038": "21405",
    "2039": "22302",
    "2040": "23146",
    "2041": "23942",
    "2042": "24297",
    "2043": "24704",
    "2044": "25337",
    "2045": "26022",
    "2046": "26779",
    "2047": "27984",
    "2048": "29007",
    "2049": "30135",
    "2050": "31416",
    "Age": "65-69"
  },
  {
    "2021": "7921",
    "2022": "8725",
    "2023": "9291",
    "2024": "9888",
    "2025": "10400",
    "2026": "11065",
    "2027": "11644",
    "2028": "12635",
    "2029": "13800",
    "2030": "14678",
    "2031": "15531",
    "2032": "16257",
    "2033": "16654",
    "2034": "16940",
    "2035": "17186",
    "2036": "17264",
    "2037": "17067",
    "2038": "17059",
    "2039": "16842",
    "2040": "16887",
    "2041": "17215",
    "2042": "17902",
    "2043": "18786",
    "2044": "19608",
    "2045": "20386",
    "2046": "21130",
    "2047": "21477",
    "2048": "21881",
    "2049": "22483",
    "2050": "23128",
    "Age": "70-74"
  },
  {
    "2021": "3529",
    "2022": "3928",
    "2023": "4469",
    "2024": "5020",
    "2025": "5645",
    "2026": "6202",
    "2027": "6855",
    "2028": "7305",
    "2029": "7785",
    "2030": "8211",
    "2031": "8764",
    "2032": "9263",
    "2033": "10087",
    "2034": "11058",
    "2035": "11791",
    "2036": "12512",
    "2037": "13139",
    "2038": "13499",
    "2039": "13784",
    "2040": "14028",
    "2041": "14140",
    "2042": "14021",
    "2043": "14065",
    "2044": "13934",
    "2045": "14023",
    "2046": "14350",
    "2047": "14973",
    "2048": "15766",
    "2049": "16491",
    "2050": "17179",
    "Age": "75-79"
  },
  {
    "2021": "2617",
    "2022": "2656",
    "2023": "2488",
    "2024": "2361",
    "2025": "2410",
    "2026": "2431",
    "2027": "2733",
    "2028": "3114",
    "2029": "3497",
    "2030": "3950",
    "2031": "4350",
    "2032": "4842",
    "2033": "5175",
    "2034": "5533",
    "2035": "5869",
    "2036": "6300",
    "2037": "6706",
    "2038": "7344",
    "2039": "8095",
    "2040": "8665",
    "2041": "9233",
    "2042": "9740",
    "2043": "10049",
    "2044": "10316",
    "2045": "10546",
    "2046": "10679",
    "2047": "10633",
    "2048": "10715",
    "2049": "10662",
    "2050": "10781",
    "Age": "80-84"
  },
  {
    "2021": "1266",
    "2022": "1380",
    "2023": "1541",
    "2024": "1669",
    "2025": "1784",
    "2026": "1964",
    "2027": "2039",
    "2028": "2020",
    "2029": "2011",
    "2030": "2110",
    "2031": "2233",
    "2032": "2470",
    "2033": "2696",
    "2034": "2929",
    "2035": "3278",
    "2036": "3604",
    "2037": "4066",
    "2038": "4410",
    "2039": "4776",
    "2040": "5205",
    "2041": "5681",
    "2042": "6231",
    "2043": "6859",
    "2044": "7578",
    "2045": "8212",
    "2046": "8877",
    "2047": "9553",
    "2048": "10142",
    "2049": "10771",
    "2050": "11311",
    "Age": "85+"
  }
]

# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_city_region, gender='ayol').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_city_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='ayol',
                    population=population
                )

print("Navoi female data import completed successfully!")
