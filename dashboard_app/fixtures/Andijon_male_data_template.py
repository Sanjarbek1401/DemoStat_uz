import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_region, _ = Region.objects.get_or_create(name='Andijon', defaults={'svg_id': 'andijan'})

# Data to be imported
navoi_male_data =[
  {
    "2021": "1647569",
    "2022": "1681453",
    "2023": "1714910",
    "2024": "1747643",
    "2025": "1779716",
    "2026": "1811136",
    "2027": "1841993",
    "2028": "1872438",
    "2029": "1902201",
    "2030": "1931061",
    "2031": "1958869",
    "2032": "1985612",
    "2033": "2011375",
    "2034": "2036040",
    "2035": "2059792",
    "2036": "2082620",
    "2037": "2104703",
    "2038": "2126161",
    "2039": "2147170",
    "2040": "2167987",
    "2041": "2188913",
    "2042": "2210158",
    "2043": "2231810",
    "2044": "2253910",
    "2045": "2276557",
    "2046": "2299711",
    "2047": "2323308",
    "2048": "2347307",
    "2049": "2371574",
    "2050": "2395973",
    "Age": "Total"
  },
  {
    "2021": "194349",
    "2022": "204472",
    "2023": "209588",
    "2024": "213979",
    "2025": "215707",
    "2026": "216145",
    "2027": "214815",
    "2028": "213432",
    "2029": "212037",
    "2030": "210349",
    "2031": "208215",
    "2032": "205577",
    "2033": "202342",
    "2034": "198668",
    "2035": "194965",
    "2036": "191385",
    "2037": "188109",
    "2038": "185196",
    "2039": "182949",
    "2040": "181422",
    "2041": "180929",
    "2042": "181481",
    "2043": "183049",
    "2044": "185490",
    "2045": "188663",
    "2046": "192232",
    "2047": "195929",
    "2048": "199622",
    "2049": "203186",
    "2050": "206296",
    "Age": "0-4"
  },
  {
    "2021": "166896",
    "2022": "169962",
    "2023": "175770",
    "2024": "180048",
    "2025": "185946",
    "2026": "193147",
    "2027": "203184",
    "2028": "208247",
    "2029": "212610",
    "2030": "214335",
    "2031": "214787",
    "2032": "213486",
    "2033": "212135",
    "2034": "210775",
    "2035": "209126",
    "2036": "207036",
    "2037": "204446",
    "2038": "201264",
    "2039": "197645",
    "2040": "193996",
    "2041": "190468",
    "2042": "187241",
    "2043": "184374",
    "2044": "182166",
    "2045": "180671",
    "2046": "180202",
    "2047": "180769",
    "2048": "182344",
    "2049": "184785",
    "2050": "187954",
    "Age": "5-9"
  },
  {
    "2021": "152312",
    "2022": "154210",
    "2023": "154811",
    "2024": "157154",
    "2025": "160936",
    "2026": "166138",
    "2027": "169169",
    "2028": "174938",
    "2029": "179180",
    "2030": "185029",
    "2031": "192192",
    "2032": "202176",
    "2033": "207209",
    "2034": "211560",
    "2035": "213288",
    "2036": "213757",
    "2037": "212482",
    "2038": "211160",
    "2039": "209829",
    "2040": "208211",
    "2041": "206155",
    "2042": "203602",
    "2043": "200461",
    "2044": "196884",
    "2045": "193278",
    "2046": "189791",
    "2047": "186603",
    "2048": "183770",
    "2049": "181591",
    "2050": "180121",
    "Age": "10-14"
  },
  {
    "2021": "117892",
    "2022": "122379",
    "2023": "132028",
    "2024": "139931",
    "2025": "146643",
    "2026": "151503",
    "2027": "153378",
    "2028": "153973",
    "2029": "156308",
    "2030": "160072",
    "2031": "165247",
    "2032": "168255",
    "2033": "173999",
    "2034": "178222",
    "2035": "184055",
    "2036": "191171",
    "2037": "201106",
    "2038": "206114",
    "2039": "210453",
    "2040": "212186",
    "2041": "212671",
    "2042": "211423",
    "2043": "210132",
    "2044": "208831",
    "2045": "207245",
    "2046": "205223",
    "2047": "202707",
    "2048": "199605",
    "2049": "196069",
    "2050": "192503",
    "Age": "15-19"
  },
  {
    "2021": "121508",
    "2022": "118457",
    "2023": "114328",
    "2024": "113959",
    "2025": "115433",
    "2026": "117178",
    "2027": "121614",
    "2028": "131169",
    "2029": "138983",
    "2030": "145620",
    "2031": "150426",
    "2032": "152284",
    "2033": "152888",
    "2034": "155223",
    "2035": "158968",
    "2036": "164109",
    "2037": "167091",
    "2038": "172802",
    "2039": "176999",
    "2040": "182798",
    "2041": "189860",
    "2042": "199726",
    "2043": "204697",
    "2044": "209019",
    "2045": "210757",
    "2046": "211266",
    "2047": "210057",
    "2048": "208808",
    "2049": "207549",
    "2050": "206006",
    "Age": "20-24"
  },
  {
    "2021": "149750",
    "2022": "145076",
    "2023": "139958",
    "2024": "135007",
    "2025": "126528",
    "2026": "120592",
    "2027": "117611",
    "2028": "113550",
    "2029": "113209",
    "2030": "114678",
    "2031": "116405",
    "2032": "120783",
    "2033": "130224",
    "2034": "137930",
    "2035": "144480",
    "2036": "149228",
    "2037": "151076",
    "2038": "151694",
    "2039": "154028",
    "2040": "157747",
    "2041": "162846",
    "2042": "165797",
    "2043": "171470",
    "2044": "175634",
    "2045": "181388",
    "2046": "188381",
    "2047": "198162",
    "2048": "203088",
    "2049": "207390",
    "2050": "209134",
    "Age": "25-29"
  },
  {
    "2021": "142488",
    "2022": "145411",
    "2023": "148941",
    "2024": "150172",
    "2025": "150847",
    "2026": "147998",
    "2027": "143408",
    "2028": "138395",
    "2029": "133565",
    "2030": "125250",
    "2031": "119449",
    "2032": "116562",
    "2033": "112587",
    "2034": "112283",
    "2035": "113755",
    "2036": "115467",
    "2037": "119785",
    "2038": "129106",
    "2039": "136702",
    "2040": "143167",
    "2041": "147862",
    "2042": "149703",
    "2043": "150337",
    "2044": "152670",
    "2045": "156364",
    "2046": "161425",
    "2047": "164347",
    "2048": "169979",
    "2049": "174106",
    "2050": "179810",
    "Age": "30-34"
  },
  {
    "2021": "123653",
    "2022": "128393",
    "2023": "131715",
    "2024": "133961",
    "2025": "137318",
    "2026": "140406",
    "2027": "143263",
    "2028": "146734",
    "2029": "147945",
    "2030": "148637",
    "2031": "145867",
    "2032": "141397",
    "2033": "136517",
    "2034": "131827",
    "2035": "123695",
    "2036": "118040",
    "2037": "115254",
    "2038": "111370",
    "2039": "111106",
    "2040": "112581",
    "2041": "114280",
    "2042": "118541",
    "2043": "127739",
    "2044": "136227",
    "2045": "141608",
    "2046": "146254",
    "2047": "148092",
    "2048": "148744",
    "2049": "151073",
    "2050": "154740",
    "Age": "35-39"
  },
  {
    "2021": "100786",
    "2022": "103874",
    "2023": "107230",
    "2024": "111221",
    "2025": "116573",
    "2026": "121521",
    "2027": "126164",
    "2028": "129422",
    "2029": "131629",
    "2030": "134937",
    "2031": "137989",
    "2032": "140815",
    "2033": "144253",
    "2034": "145467",
    "2035": "146194",
    "2036": "143518",
    "2037": "139175",
    "2038": "134432",
    "2039": "129880",
    "2040": "121931",
    "2041": "116418",
    "2042": "113727",
    "2043": "109936",
    "2044": "109711",
    "2045": "111191",
    "2046": "112881",
    "2047": "117090",
    "2048": "126169",
    "2049": "133555",
    "2050": "139858",
    "Age": "40-44"
  },
  {
    "2021": "95001",
    "2022": "94963",
    "2023": "94830",
    "2024": "96137",
    "2025": "96991",
    "2026": "98581",
    "2027": "101608",
    "2028": "104899",
    "2029": "108813",
    "2030": "114062",
    "2031": "118922",
    "2032": "123487",
    "2033": "126698",
    "2034": "128884",
    "2035": "132164",
    "2036": "135196",
    "2037": "138003",
    "2038": "141412",
    "2039": "142631",
    "2040": "143396",
    "2041": "140820",
    "2042": "136611",
    "2043": "132013",
    "2044": "127599",
    "2045": "119850",
    "2046": "114487",
    "2047": "111897",
    "2048": "108209",
    "2049": "108027",
    "2050": "109511",
    "Age": "45-49"
  },
  {
    "2021": "80903",
    "2022": "83956",
    "2023": "86045",
    "2024": "88980",
    "2025": "90505",
    "2026": "91986",
    "2027": "91973",
    "2028": "91878",
    "2029": "93178",
    "2030": "94041",
    "2031": "95629",
    "2032": "98605",
    "2033": "101834",
    "2034": "105674",
    "2035": "110814",
    "2036": "115582",
    "2037": "120063",
    "2038": "123224",
    "2039": "125390",
    "2040": "128638",
    "2041": "131649",
    "2042": "134439",
    "2043": "137810",
    "2044": "139034",
    "2045": "139844",
    "2046": "137388",
    "2047": "133338",
    "2048": "128910",
    "2049": "124653",
    "2050": "117140",
    "Age": "50-54"
  },
  {
    "2021": "70965",
    "2022": "71312",
    "2023": "72115",
    "2024": "72769",
    "2025": "74411",
    "2026": "76954",
    "2027": "79897",
    "2028": "82784",
    "2029": "84749",
    "2030": "86248",
    "2031": "87723",
    "2032": "87768",
    "2033": "87744",
    "2034": "89051",
    "2035": "89944",
    "2036": "91547",
    "2037": "94464",
    "2038": "97621",
    "2039": "101367",
    "2040": "106363",
    "2041": "111010",
    "2042": "115379",
    "2043": "118469",
    "2044": "120608",
    "2045": "123817",
    "2046": "126804",
    "2047": "129571",
    "2048": "132885",
    "2049": "134106",
    "2050": "134964",
    "Age": "55-59"
  },
  {
    "2021": "58187",
    "2022": "61094",
    "2023": "62537",
    "2024": "64211",
    "2025": "65071",
    "2026": "65233",
    "2027": "65616",
    "2028": "66427",
    "2029": "67106",
    "2030": "68716",
    "2031": "71157",
    "2032": "73965",
    "2033": "76724",
    "2034": "78612",
    "2035": "80090",
    "2036": "81567",
    "2037": "81702",
    "2038": "81785",
    "2039": "83099",
    "2040": "84031",
    "2041": "85649",
    "2042": "88478",
    "2043": "91528",
    "2044": "95140",
    "2045": "99930",
    "2046": "104404",
    "2047": "108606",
    "2048": "111588",
    "2049": "113678",
    "2050": "116818",
    "Age": "60-64"
  },
  {
    "2021": "35269",
    "2022": "37189",
    "2023": "40810",
    "2024": "44060",
    "2025": "47690",
    "2026": "50865",
    "2027": "53463",
    "2028": "54808",
    "2029": "56361",
    "2030": "57222",
    "2031": "57479",
    "2032": "57931",
    "2033": "58771",
    "2034": "59499",
    "2035": "61075",
    "2036": "63388",
    "2037": "66025",
    "2038": "68622",
    "2039": "70413",
    "2040": "71863",
    "2041": "73329",
    "2042": "73575",
    "2043": "73784",
    "2044": "75102",
    "2045": "76078",
    "2046": "77700",
    "2047": "80398",
    "2048": "83296",
    "2049": "86714",
    "2050": "91209",
    "Age": "65-69"
  },
  {
    "2021": "19791",
    "2022": "22083",
    "2023": "24137",
    "2024": "25897",
    "2025": "26851",
    "2026": "28978",
    "2027": "30655",
    "2028": "33745",
    "2029": "36514",
    "2030": "39618",
    "2031": "42368",
    "2032": "44629",
    "2033": "45875",
    "2034": "47297",
    "2035": "48164",
    "2036": "48530",
    "2037": "49055",
    "2038": "49917",
    "2039": "50683",
    "2040": "52192",
    "2041": "54330",
    "2042": "56743",
    "2043": "59126",
    "2044": "60788",
    "2045": "62181",
    "2046": "63609",
    "2047": "63961",
    "2048": "64294",
    "2049": "65581",
    "2050": "66572",
    "Age": "70-74"
  },
  {
    "2021": "9744",
    "2022": "9804",
    "2023": "10303",
    "2024": "11398",
    "2025": "13288",
    "2026": "14543",
    "2027": "16308",
    "2028": "17835",
    "2029": "19168",
    "2030": "19986",
    "2031": "21682",
    "2032": "23078",
    "2033": "25550",
    "2034": "27757",
    "2035": "30245",
    "2036": "32490",
    "2037": "34342",
    "2038": "35448",
    "2039": "36686",
    "2040": "37520",
    "2041": "37971",
    "2042": "38541",
    "2043": "39386",
    "2044": "40162",
    "2045": "41556",
    "2046": "43447",
    "2047": "45550",
    "2048": "47631",
    "2049": "49087",
    "2050": "50359",
    "Age": "75-79"
  },
  {
    "2021": "6021",
    "2022": "6601",
    "2023": "6421",
    "2024": "5962",
    "2025": "6034",
    "2026": "5898",
    "2027": "6039",
    "2028": "6380",
    "2029": "7096",
    "2030": "8379",
    "2031": "9235",
    "2032": "10445",
    "2033": "11458",
    "2034": "12371",
    "2035": "13020",
    "2036": "14249",
    "2037": "15311",
    "2038": "17100",
    "2039": "18692",
    "2040": "20498",
    "2041": "22162",
    "2042": "23546",
    "2043": "24451",
    "2044": "25448",
    "2045": "26192",
    "2046": "26674",
    "2047": "27235",
    "2048": "28000",
    "2049": "28717",
    "2050": "29902",
    "Age": "80-84"
  },
  {
    "2021": "2054",
    "2022": "2217",
    "2023": "2442",
    "2024": "2795",
    "2025": "2948",
    "2026": "3472",
    "2027": "3830",
    "2028": "3823",
    "2029": "3750",
    "2030": "3870",
    "2031": "4087",
    "2032": "4371",
    "2033": "4566",
    "2034": "4941",
    "2035": "5750",
    "2036": "6360",
    "2037": "7213",
    "2038": "7893",
    "2039": "8618",
    "2040": "9446",
    "2041": "10504",
    "2042": "11606",
    "2043": "13050",
    "2044": "14397",
    "2045": "15943",
    "2046": "17545",
    "2047": "18995",
    "2048": "20364",
    "2049": "21736",
    "2050": "23077",
    "Age": "85+"
  }
]
# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_region, gender='erkak').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='erkak',
                    population=population
                )

print("Navoi male data import completed successfully!")
