import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_city_region, _ = Region.objects.get_or_create(name='Buxoro', defaults={'svg_id': 'bukhara'})

# Data to be imported
navoi_male_data = [
  {
    "2021": "986419",
    "2022": "1002548",
    "2023": "1018446",
    "2024": "1093948",
    "2025": "1049060",
    "2026": "1063719",
    "2027": "1077851",
    "2028": "1091487",
    "2029": "1104569",
    "2030": "1117065",
    "2031": "1128930",
    "2032": "1140144",
    "2033": "1150714",
    "2034": "1160596",
    "2035": "1169896",
    "2036": "1178620",
    "2037": "1186877",
    "2038": "1194706",
    "2039": "1202180",
    "2040": "1209397",
    "2041": "1216484",
    "2042": "1223521",
    "2043": "1230548",
    "2044": "1237591",
    "2045": "1244691",
    "2046": "1251839",
    "2047": "1259015",
    "2048": "1266196",
    "2049": "1273345",
    "2050": "1280403",
    "Age": "Total"
  },
  {
    "2021": "95701",
    "2022": "100026",
    "2023": "103172",
    "2024": "105405",
    "2025": "106818",
    "2026": "107123",
    "2027": "106114",
    "2028": "104805",
    "2029": "103317",
    "2030": "101613",
    "2031": "99715",
    "2032": "97682",
    "2033": "95492",
    "2034": "93165",
    "2035": "90838",
    "2036": "88582",
    "2037": "86516",
    "2038": "84675",
    "2039": "83175",
    "2040": "82009",
    "2041": "81284",
    "2042": "80977",
    "2043": "81079",
    "2044": "81543",
    "2045": "82317",
    "2046": "83263",
    "2047": "84275",
    "2048": "85300",
    "2049": "86270",
    "2050": "87082",
    "Age": "0-4"
  },
  {
    "2021": "87011",
    "2022": "88170",
    "2023": "89585",
    "2024": "90909",
    "2025": "92475",
    "2026": "95084",
    "2027": "99347",
    "2028": "102444",
    "2029": "104650",
    "2030": "106052",
    "2031": "106368",
    "2032": "105387",
    "2033": "104114",
    "2034": "102665",
    "2035": "101005",
    "2036": "99153",
    "2037": "97168",
    "2038": "95028",
    "2039": "92752",
    "2040": "90476",
    "2041": "88270",
    "2042": "86252",
    "2043": "84454",
    "2044": "82992",
    "2045": "81859",
    "2046": "81158",
    "2047": "80869",
    "2048": "80982",
    "2049": "81448",
    "2050": "82220",
    "Age": "5-9"
  },
  {
    "2021": "79582",
    "2022": "80254",
    "2023": "81037",
    "2024": "82374",
    "2025": "84188",
    "2026": "86571",
    "2027": "87711",
    "2028": "89111",
    "2029": "90420",
    "2030": "91968",
    "2031": "94546",
    "2032": "98770",
    "2033": "101836",
    "2034": "104025",
    "2035": "105424",
    "2036": "105750",
    "2037": "104793",
    "2038": "103550",
    "2039": "102134",
    "2040": "100509",
    "2041": "98695",
    "2042": "96750",
    "2043": "94653",
    "2044": "92420",
    "2045": "90186",
    "2046": "88020",
    "2047": "86036",
    "2048": "84270",
    "2049": "82834",
    "2050": "81720",
    "Age": "10-14"
  },
  {
    "2021": "69834",
    "2022": "70895",
    "2023": "73735",
    "2024": "76327",
    "2025": "78146",
    "2026": "79108",
    "2027": "79763",
    "2028": "80536",
    "2029": "81867",
    "2030": "83669",
    "2031": "86034",
    "2032": "87156",
    "2033": "88543",
    "2034": "89844",
    "2035": "91385",
    "2036": "93945",
    "2037": "98133",
    "2038": "101167",
    "2039": "103337",
    "2040": "104728",
    "2041": "105061",
    "2042": "104128",
    "2043": "102918",
    "2044": "101539",
    "2045": "99951",
    "2046": "98175",
    "2047": "96269",
    "2048": "94209",
    "2049": "92014",
    "2050": "89815",
    "Age": "15-19"
  },
  {
    "2021": "70159",
    "2022": "69263",
    "2023": "68411",
    "2024": "68665",
    "2025": "69167",
    "2026": "69484",
    "2027": "70519",
    "2028": "73249",
    "2029": "75707",
    "2030": "77416",
    "2031": "78300",
    "2032": "78929",
    "2033": "79717",
    "2034": "81055",
    "2035": "82810",
    "2036": "85073",
    "2037": "86108",
    "2038": "87457",
    "2039": "88757",
    "2040": "90292",
    "2041": "92781",
    "2042": "96831",
    "2043": "99736",
    "2044": "101821",
    "2045": "103169",
    "2046": "103525",
    "2047": "102680",
    "2048": "101585",
    "2049": "100323",
    "2050": "98854",
    "Age": "20-24"
  },
  {
    "2021": "83803",
    "2022": "80694",
    "2023": "77603",
    "2024": "74248",
    "2025": "71533",
    "2026": "70090",
    "2027": "69303",
    "2028": "68543",
    "2029": "68844",
    "2030": "69359",
    "2031": "69668",
    "2032": "70627",
    "2033": "73201",
    "2034": "75505",
    "2035": "77129",
    "2036": "78000",
    "2037": "78639",
    "2038": "79409",
    "2039": "80685",
    "2040": "82347",
    "2041": "84536",
    "2042": "85555",
    "2043": "86898",
    "2044": "88172",
    "2045": "89650",
    "2046": "92009",
    "2047": "95876",
    "2048": "98633",
    "2049": "100634",
    "2050": "101957",
    "Age": "25-29"
  },
  {
    "2021": "88053",
    "2022": "88195",
    "2023": "87713",
    "2024": "87458",
    "2025": "85708",
    "2026": "82562",
    "2027": "79658",
    "2028": "76790",
    "2029": "73659",
    "2030": "71130",
    "2031": "69810",
    "2032": "69111",
    "2033": "68421",
    "2034": "68752",
    "2035": "69275",
    "2036": "69585",
    "2037": "70504",
    "2038": "72989",
    "2039": "75207",
    "2040": "76790",
    "2041": "77661",
    "2042": "78313",
    "2043": "79084",
    "2044": "80341",
    "2045": "81965",
    "2046": "84121",
    "2047": "85125",
    "2048": "86448",
    "2049": "87688",
    "2050": "89108",
    "Age": "30-34"
  },
  {
    "2021": "79659",
    "2022": "82773",
    "2023": "84714",
    "2024": "84977",
    "2025": "85536",
    "2026": "86205",
    "2027": "86337",
    "2028": "85886",
    "2029": "85692",
    "2030": "84061",
    "2031": "81085",
    "2032": "78362",
    "2033": "75674",
    "2034": "72720",
    "2035": "70334",
    "2036": "69110",
    "2037": "68478",
    "2038": "67840",
    "2039": "68197",
    "2040": "68733",
    "2041": "69052",
    "2042": "69953",
    "2043": "72382",
    "2044": "74550",
    "2045": "76110",
    "2046": "76985",
    "2047": "77647",
    "2048": "78414",
    "2049": "79645",
    "2050": "81222",
    "Age": "35-39"
  },
  {
    "2021": "64871",
    "2022": "66743",
    "2023": "68597",
    "2024": "71184",
    "2025": "74676",
    "2026": "78103",
    "2027": "81109",
    "2028": "82997",
    "2029": "83253",
    "2030": "83810",
    "2031": "84477",
    "2032": "84632",
    "2033": "84225",
    "2034": "84086",
    "2035": "82546",
    "2036": "79694",
    "2037": "77098",
    "2038": "74537",
    "2039": "71707",
    "2040": "69421",
    "2041": "68263",
    "2042": "67682",
    "2043": "67087",
    "2044": "67468",
    "2045": "68017",
    "2046": "68345",
    "2047": "69233",
    "2048": "71620",
    "2049": "73744",
    "2050": "75278",
    "Age": "40-44"
  },
  {
    "2021": "60944",
    "2022": "60278",
    "2023": "61006",
    "2024": "62152",
    "2025": "63005",
    "2026": "63722",
    "2027": "65545",
    "2028": "67345",
    "2029": "69863",
    "2030": "73268",
    "2031": "76612",
    "2032": "79554",
    "2033": "81414",
    "2034": "81677",
    "2035": "82244",
    "2036": "82920",
    "2037": "83098",
    "2038": "82726",
    "2039": "82627",
    "2040": "81158",
    "2041": "78404",
    "2042": "75908",
    "2043": "73445",
    "2044": "70712",
    "2045": "68508",
    "2046": "67404",
    "2047": "66861",
    "2048": "66295",
    "2049": "66688",
    "2050": "67239",
    "Age": "45-49"
  },
  {
    "2021": "54145",
    "2022": "56594",
    "2023": "57269",
    "2024": "58775",
    "2025": "59289",
    "2026": "59634",
    "2027": "58985",
    "2028": "59705",
    "2029": "60833",
    "2030": "61675",
    "2031": "62385",
    "2032": "64176",
    "2033": "65940",
    "2034": "68407",
    "2035": "71741",
    "2036": "75015",
    "2037": "77900",
    "2038": "79735",
    "2039": "80007",
    "2040": "80587",
    "2041": "81278",
    "2042": "81481",
    "2043": "81145",
    "2044": "81081",
    "2045": "79679",
    "2046": "77017",
    "2047": "74610",
    "2048": "72230",
    "2049": "69580",
    "2050": "67445",
    "Age": "50-54"
  },
  {
    "2021": "50859",
    "2022": "50177",
    "2023": "50524",
    "2024": "49980",
    "2025": "50901",
    "2026": "52486",
    "2027": "54859",
    "2028": "55511",
    "2029": "56974",
    "2030": "57484",
    "2031": "57847",
    "2032": "57240",
    "2033": "57964",
    "2034": "59079",
    "2035": "59919",
    "2036": "60631",
    "2037": "62388",
    "2038": "64117",
    "2039": "66531",
    "2040": "69788",
    "2041": "72984",
    "2042": "75803",
    "2043": "77605",
    "2044": "77891",
    "2045": "78492",
    "2046": "79203",
    "2047": "79435",
    "2048": "79132",
    "2049": "79097",
    "2050": "77761",
    "Age": "55-59"
  },
  {
    "2021": "42456",
    "2022": "45192",
    "2023": "46531",
    "2024": "47711",
    "2025": "48217",
    "2026": "48204",
    "2027": "47568",
    "2028": "47935",
    "2029": "47439",
    "2030": "48354",
    "2031": "49896",
    "2032": "52181",
    "2033": "52823",
    "2034": "54235",
    "2035": "54753",
    "2036": "55150",
    "2037": "54608",
    "2038": "55341",
    "2039": "56444",
    "2040": "57284",
    "2041": "58005",
    "2042": "59719",
    "2043": "61409",
    "2044": "63760",
    "2045": "66921",
    "2046": "70019",
    "2047": "72750",
    "2048": "74504",
    "2049": "74800",
    "2050": "75420",
    "Age": "60-64"
  },
  {
    "2021": "26962",
    "2022": "28079",
    "2023": "30788",
    "2024": "33283",
    "2025": "35916",
    "2026": "38842",
    "2027": "41348",
    "2028": "42598",
    "2029": "43711",
    "2030": "44215",
    "2031": "44258",
    "2032": "43715",
    "2033": "44128",
    "2034": "43718",
    "2035": "44638",
    "2036": "46134",
    "2037": "48308",
    "2038": "48948",
    "2039": "50298",
    "2040": "50833",
    "2041": "51278",
    "2042": "50829",
    "2043": "51577",
    "2044": "52668",
    "2045": "53513",
    "2046": "54250",
    "2047": "55906",
    "2048": "57542",
    "2049": "59805",
    "2050": "62828",
    "Age": "65-69"
  },
  {
    "2021": "16204",
    "2022": "18253",
    "2023": "19626",
    "2024": "20980",
    "2025": "22068",
    "2026": "23485",
    "2027": "24491",
    "2028": "26914",
    "2029": "29171",
    "2030": "31499",
    "2031": "34116",
    "2032": "36360",
    "2033": "37521",
    "2034": "38569",
    "2035": "39086",
    "2036": "39207",
    "2037": "38790",
    "2038": "39256",
    "2039": "38959",
    "2040": "39877",
    "2041": "41311",
    "2042": "43339",
    "2043": "43982",
    "2044": "45253",
    "2045": "45808",
    "2046": "46304",
    "2047": "45971",
    "2048": "46726",
    "2049": "47788",
    "2050": "48626",
    "Age": "70-74"
  },
  {
    "2021": "8156",
    "2022": "8123",
    "2023": "9021",
    "2024": "10152",
    "2025": "11769",
    "2026": "13039",
    "2027": "14718",
    "2028": "15846",
    "2029": "16973",
    "2030": "17915",
    "2031": "19114",
    "2032": "20000",
    "2033": "22079",
    "2034": "23986",
    "2035": "26014",
    "2036": "28256",
    "2037": "30176",
    "2038": "31230",
    "2039": "32187",
    "2040": "32707",
    "2041": "32912",
    "2042": "32638",
    "2043": "33153",
    "2044": "32988",
    "2045": "33889",
    "2046": "35233",
    "2047": "37057",
    "2048": "37690",
    "2049": "38836",
    "2050": "39395",
    "Age": "75-79"
  },
  {
    "2021": "5832",
    "2022": "6261",
    "2023": "6105",
    "2024": "5894",
    "2025": "5848",
    "2026": "5717",
    "2027": "5757",
    "2028": "6442",
    "2029": "7290",
    "2030": "8502",
    "2031": "9438",
    "2032": "10701",
    "2033": "11560",
    "2034": "12434",
    "2035": "13205",
    "2036": "14152",
    "2037": "14894",
    "2038": "16557",
    "2039": "18080",
    "2040": "19704",
    "2041": "21492",
    "2042": "23023",
    "2043": "23926",
    "2044": "24755",
    "2045": "25255",
    "2046": "25526",
    "2047": "25400",
    "2048": "25931",
    "2049": "25894",
    "2050": "26732",
    "Age": "80-84"
  },
  {
    "2021": "2188",
    "2022": "2581",
    "2023": "3012",
    "2024": "3473",
    "2025": "3798",
    "2026": "4260",
    "2027": "4718",
    "2028": "4829",
    "2029": "4938",
    "2030": "5077",
    "2031": "5259",
    "2032": "5560",
    "2033": "6063",
    "2034": "6675",
    "2035": "7551",
    "2036": "8263",
    "2037": "9277",
    "2038": "10146",
    "2039": "11096",
    "2040": "12154",
    "2041": "13216",
    "2042": "14342",
    "2043": "16016",
    "2044": "17638",
    "2045": "19402",
    "2046": "21281",
    "2047": "23013",
    "2048": "24683",
    "2049": "26260",
    "2050": "27702",
    "Age": "85+"
  }
]

# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_city_region, gender='ayol').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_city_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='ayol',
                    population=population
                )

print("Navoi female data import completed successfully!")
