import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_city_region, _ = Region.objects.get_or_create(name='Qoraqalpog\'iston', defaults={'svg_id': 'karakalpakstan'})

# Data to be imported
navoi_male_data = [
  {
    "2021": "969983",
    "2022": "984508",
    "2023": "998948",
    "2024": "1013101",
    "2025": "1026933",
    "2026": "1040345",
    "2027": "1053263",
    "2028": "1065716",
    "2029": "1077646",
    "2030": "1089034",
    "2031": "1099853",
    "2032": "1110097",
    "2033": "1119763",
    "2034": "1128771",
    "2035": "1137193",
    "2036": "1145024",
    "2037": "1152333",
    "2038": "1159143",
    "2039": "1165491",
    "2040": "1171450",
    "2041": "1177131",
    "2042": "1182616",
    "2043": "1187953",
    "2044": "1193182",
    "2045": "1198387",
    "2046": "1203572",
    "2047": "1208733",
    "2048": "1213881",
    "2049": "1218983",
    "2050": "1224003",
    "Age": "Total"
  },
  {
    "2021": "92550",
    "2022": "96738",
    "2023": "99807",
    "2024": "102274",
    "2025": "104876",
    "2026": "107373",
    "2027": "106712",
    "2028": "105620",
    "2029": "104252",
    "2030": "102628",
    "2031": "100823",
    "2032": "98919",
    "2033": "96871",
    "2034": "94679",
    "2035": "92441",
    "2036": "90184",
    "2037": "87989",
    "2038": "85888",
    "2039": "83994",
    "2040": "82259",
    "2041": "80920",
    "2042": "79864",
    "2043": "79159",
    "2044": "78808",
    "2045": "78810",
    "2046": "79072",
    "2047": "79509",
    "2048": "80075",
    "2049": "80703",
    "2050": "81283",
    "Age": "0-4"
  },
  {
    "2021": "93838",
    "2022": "92297",
    "2023": "92299",
    "2024": "92265",
    "2025": "91474",
    "2026": "91610",
    "2027": "95709",
    "2028": "98690",
    "2029": "101094",
    "2030": "103646",
    "2031": "106122",
    "2032": "105493",
    "2033": "104464",
    "2034": "103165",
    "2035": "101615",
    "2036": "99887",
    "2037": "98060",
    "2038": "96091",
    "2039": "93977",
    "2040": "91819",
    "2041": "89641",
    "2042": "87524",
    "2043": "85500",
    "2044": "83678",
    "2045": "82050",
    "2046": "80729",
    "2047": "79721",
    "2048": "79053",
    "2049": "78726",
    "2050": "78741",
    "Age": "5-9"
  },
  {
    "2021": "89222",
    "2022": "90625",
    "2023": "90695",
    "2024": "90516",
    "2025": "91733",
    "2026": "92923",
    "2027": "91399",
    "2028": "91418",
    "2029": "91399",
    "2030": "90633",
    "2031": "90765",
    "2032": "94811",
    "2033": "97737",
    "2034": "100101",
    "2035": "102618",
    "2036": "105077",
    "2037": "104471",
    "2038": "103484",
    "2039": "102232",
    "2040": "100734",
    "2041": "99061",
    "2042": "97294",
    "2043": "95388",
    "2044": "93342",
    "2045": "91253",
    "2046": "89144",
    "2047": "87093",
    "2048": "85129",
    "2049": "83360",
    "2050": "81778",
    "Age": "10-14"
  },
  {
    "2021": "75851",
    "2022": "77735",
    "2023": "81415",
    "2024": "84293",
    "2025": "87266",
    "2026": "88165",
    "2027": "89526",
    "2028": "89589",
    "2029": "89429",
    "2030": "90656",
    "2031": "91846",
    "2032": "90346",
    "2033": "90391",
    "2034": "90398",
    "2035": "89675",
    "2036": "89821",
    "2037": "93817",
    "2038": "96686",
    "2039": "99013",
    "2040": "101486",
    "2041": "103900",
    "2042": "103297",
    "2043": "102353",
    "2044": "101152",
    "2045": "99712",
    "2046": "98102",
    "2047": "96398",
    "2048": "94555",
    "2049": "92570",
    "2050": "90542",
    "Age": "15-19"
  },
  {
    "2021": "76641",
    "2022": "75484",
    "2023": "75086",
    "2024": "75212",
    "2025": "73729",
    "2026": "74649",
    "2027": "76394",
    "2028": "79839",
    "2029": "82448",
    "2030": "85124",
    "2031": "85810",
    "2032": "87115",
    "2033": "87272",
    "2034": "87252",
    "2035": "88481",
    "2036": "89607",
    "2037": "88155",
    "2038": "88303",
    "2039": "88446",
    "2040": "87881",
    "2041": "88040",
    "2042": "91860",
    "2043": "94540",
    "2044": "96698",
    "2045": "98936",
    "2046": "101170",
    "2047": "100608",
    "2048": "99832",
    "2049": "98814",
    "2050": "97566",
    "Age": "20-24"
  },
  {
    "2021": "78962",
    "2022": "76705",
    "2023": "74678",
    "2024": "75396",
    "2025": "76179",
    "2026": "75637",
    "2027": "74683",
    "2028": "74457",
    "2029": "74743",
    "2030": "73428",
    "2031": "74357",
    "2032": "75885",
    "2033": "78976",
    "2034": "81239",
    "2035": "83710",
    "2036": "84347",
    "2037": "85644",
    "2038": "85827",
    "2039": "85816",
    "2040": "86972",
    "2041": "88124",
    "2042": "86861",
    "2043": "87159",
    "2044": "87407",
    "2045": "86974",
    "2046": "87116",
    "2047": "90664",
    "2048": "93035",
    "2049": "94959",
    "2050": "96989",
    "Age": "25-29"
  },
  {
    "2021": "91476",
    "2022": "90953",
    "2023": "88564",
    "2024": "85761",
    "2025": "82286",
    "2026": "77347",
    "2027": "75416",
    "2028": "73586",
    "2029": "74351",
    "2030": "75157",
    "2031": "74738",
    "2032": "73951",
    "2033": "73839",
    "2034": "74221",
    "2035": "73011",
    "2036": "73937",
    "2037": "75324",
    "2038": "78194",
    "2039": "80245",
    "2040": "82582",
    "2041": "83165",
    "2042": "84438",
    "2043": "84644",
    "2044": "84667",
    "2045": "85817",
    "2046": "87016",
    "2047": "85878",
    "2048": "86256",
    "2049": "86549",
    "2050": "86177",
    "Age": "30-34"
  },
  {
    "2021": "79322",
    "2022": "82119",
    "2023": "84274",
    "2024": "84783",
    "2025": "85885",
    "2026": "88084",
    "2027": "87594",
    "2028": "85437",
    "2029": "82960",
    "2030": "79878",
    "2031": "75331",
    "2032": "73673",
    "2033": "72007",
    "2034": "72816",
    "2035": "73637",
    "2036": "73293",
    "2037": "72605",
    "2038": "72554",
    "2039": "72984",
    "2040": "71834",
    "2041": "72747",
    "2042": "74037",
    "2043": "76760",
    "2044": "78678",
    "2045": "80938",
    "2046": "81509",
    "2047": "82784",
    "2048": "83015",
    "2049": "83056",
    "2050": "84176",
    "Age": "35-39"
  },
  {
    "2021": "64244",
    "2022": "66357",
    "2023": "68719",
    "2024": "70973",
    "2025": "73843",
    "2026": "76794",
    "2027": "79414",
    "2028": "81463",
    "2029": "81943",
    "2030": "83002",
    "2031": "85157",
    "2032": "84747",
    "2033": "82788",
    "2034": "80549",
    "2035": "77725",
    "2036": "73424",
    "2037": "71928",
    "2038": "70357",
    "2039": "71178",
    "2040": "71994",
    "2041": "71692",
    "2042": "71070",
    "2043": "71062",
    "2044": "71531",
    "2045": "70435",
    "2046": "71354",
    "2047": "72592",
    "2048": "75221",
    "2049": "77050",
    "2050": "79249",
    "Age": "40-44"
  },
  {
    "2021": "55517",
    "2022": "56064",
    "2023": "57646",
    "2024": "59676",
    "2025": "61332",
    "2026": "62530",
    "2027": "64544",
    "2028": "66801",
    "2029": "68952",
    "2030": "71709",
    "2031": "74550",
    "2032": "77080",
    "2033": "79082",
    "2034": "79561",
    "2035": "80603",
    "2036": "82728",
    "2037": "82368",
    "2038": "80534",
    "2039": "78439",
    "2040": "75786",
    "2041": "71667",
    "2042": "70290",
    "2043": "68795",
    "2044": "69631",
    "2045": "70456",
    "2046": "70194",
    "2047": "69627",
    "2048": "69649",
    "2049": "70143",
    "2050": "69084",
    "Age": "45-49"
  },
  {
    "2021": "46280",
    "2022": "48552",
    "2023": "50058",
    "2024": "51747",
    "2025": "53291",
    "2026": "53894",
    "2027": "54416",
    "2028": "55941",
    "2029": "57900",
    "2030": "59501",
    "2031": "60661",
    "2032": "62616",
    "2033": "64804",
    "2034": "66885",
    "2035": "69555",
    "2036": "72303",
    "2037": "74756",
    "2038": "76711",
    "2039": "77181",
    "2040": "78204",
    "2041": "80298",
    "2042": "79980",
    "2043": "78251",
    "2044": "76278",
    "2045": "73776",
    "2046": "69834",
    "2047": "68568",
    "2048": "67145",
    "2049": "67989",
    "2050": "68812",
    "Age": "50-54"
  },
  {
    "2021": "43245",
    "2022": "43097",
    "2023": "43005",
    "2024": "42568",
    "2025": "42809",
    "2026": "44485",
    "2027": "46653",
    "2028": "48079",
    "2029": "49687",
    "2030": "51167",
    "2031": "51769",
    "2032": "52294",
    "2033": "53776",
    "2034": "55668",
    "2035": "57216",
    "2036": "58432",
    "2037": "60232",
    "2038": "62345",
    "2039": "64349",
    "2040": "66919",
    "2041": "69561",
    "2042": "71926",
    "2043": "73828",
    "2044": "74295",
    "2045": "75309",
    "2046": "77377",
    "2047": "77109",
    "2048": "75488",
    "2049": "73629",
    "2050": "71280",
    "Age": "55-59"
  },
  {
    "2021": "34929",
    "2022": "36873",
    "2023": "38182",
    "2024": "39280",
    "2025": "40009",
    "2026": "40314",
    "2027": "40189",
    "2028": "40134",
    "2029": "39758",
    "2030": "40014",
    "2031": "41629",
    "2032": "43688",
    "2033": "45036",
    "2034": "46554",
    "2035": "47964",
    "2036": "48575",
    "2037": "49110",
    "2038": "50536",
    "2039": "52343",
    "2040": "53823",
    "2041": "54908",
    "2042": "56720",
    "2043": "58745",
    "2044": "60665",
    "2045": "63123",
    "2046": "65646",
    "2047": "67912",
    "2048": "69752",
    "2049": "70214",
    "2050": "71207",
    "Age": "60-64"
  },
  {
    "2021": "20979",
    "2022": "22524",
    "2023": "24679",
    "2024": "26746",
    "2025": "28949",
    "2026": "31094",
    "2027": "32825",
    "2028": "34007",
    "2029": "35021",
    "2030": "35707",
    "2031": "36039",
    "2032": "35974",
    "2033": "35989",
    "2034": "35712",
    "2035": "36005",
    "2036": "37550",
    "2037": "39472",
    "2038": "40727",
    "2039": "42133",
    "2040": "43451",
    "2041": "44076",
    "2042": "44626",
    "2043": "45984",
    "2044": "47690",
    "2045": "49096",
    "2046": "50144",
    "2047": "51863",
    "2048": "53781",
    "2049": "55597",
    "2050": "57905",
    "Age": "65-69"
  },
  {
    "2021": "14157",
    "2022": "14735",
    "2023": "15289",
    "2024": "16232",
    "2025": "16341",
    "2026": "17562",
    "2027": "18879",
    "2028": "20722",
    "2029": "22497",
    "2030": "24379",
    "2031": "26239",
    "2032": "27746",
    "2033": "28805",
    "2034": "29736",
    "2035": "30385",
    "2036": "30753",
    "2037": "30765",
    "2038": "30857",
    "2039": "30691",
    "2040": "31018",
    "2041": "32462",
    "2042": "34210",
    "2043": "35356",
    "2044": "36631",
    "2045": "37841",
    "2046": "38482",
    "2047": "39048",
    "2048": "40320",
    "2049": "41894",
    "2050": "43195",
    "Age": "70-74"
  },
  {
    "2021": "6944",
    "2022": "7328",
    "2023": "8139",
    "2024": "8993",
    "2025": "10195",
    "2026": "10728",
    "2027": "11189",
    "2028": "11634",
    "2029": "12392",
    "2030": "12538",
    "2031": "13542",
    "2032": "14617",
    "2033": "16115",
    "2034": "17569",
    "2035": "19095",
    "2036": "20632",
    "2037": "21882",
    "2038": "22796",
    "2039": "23618",
    "2040": "24208",
    "2041": "24599",
    "2042": "24682",
    "2043": "24847",
    "2044": "24798",
    "2045": "25157",
    "2046": "26471",
    "2047": "28001",
    "2048": "29011",
    "2049": "30114",
    "2050": "31171",
    "Age": "75-79"
  },
  {
    "2021": "4185",
    "2022": "4555",
    "2023": "4503",
    "2024": "4320",
    "2025": "4365",
    "2026": "4482",
    "2027": "4792",
    "2028": "5346",
    "2029": "5904",
    "2030": "6754",
    "2031": "7126",
    "2032": "7470",
    "2033": "7806",
    "2034": "8368",
    "2035": "8542",
    "2036": "9300",
    "2037": "10106",
    "2038": "11220",
    "2039": "12310",
    "2040": "13436",
    "2041": "14600",
    "2042": "15551",
    "2043": "16280",
    "2044": "16956",
    "2045": "17460",
    "2046": "17845",
    "2047": "17982",
    "2048": "18194",
    "2049": "18246",
    "2050": "18602",
    "Age": "80-84"
  },
  {
    "2021": "1641",
    "2022": "1768",
    "2023": "1909",
    "2024": "2063",
    "2025": "2371",
    "2026": "2676",
    "2027": "2929",
    "2028": "2953",
    "2029": "2918",
    "2030": "3112",
    "2031": "3349",
    "2032": "3672",
    "2033": "4003",
    "2034": "4301",
    "2035": "4918",
    "2036": "5263",
    "2037": "5648",
    "2038": "6033",
    "2039": "6542",
    "2040": "7005",
    "2041": "7670",
    "2042": "8387",
    "2043": "9302",
    "2044": "10277",
    "2045": "11243",
    "2046": "12366",
    "2047": "13375",
    "2048": "14370",
    "2049": "15370",
    "2050": "16246",
    "Age": "85+"
  }
]

# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_city_region, gender='ayol').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_city_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='ayol',
                    population=population
                )

print("Navoi female data import completed successfully!")
