import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_city_region, _ = Region.objects.get_or_create(name='Navoiy', defaults={'svg_id': 'navoi'})

# Data to be imported
navoi_male_data = [
  {
    "2021": "1033856",
    "2022": "1052993",
    "2023": "1071800",
    "2024": "1090158",
    "2025": "1108123",
    "2026": "1125634",
    "2027": "1142636",
    "2028": "1159177",
    "2029": "1175175",
    "2030": "1190608",
    "2031": "1205426",
    "2032": "1219621",
    "2033": "1233199",
    "2034": "1246090",
    "2035": "1258400",
    "2036": "1270141",
    "2037": "1281436",
    "2038": "1292335",
    "2039": "1302928",
    "2040": "1313343",
    "2041": "1323746",
    "2042": "1334242",
    "2043": "1344877",
    "2044": "1355669",
    "2045": "1366682",
    "2046": "1377887",
    "2047": "1389271",
    "2048": "1400810",
    "2049": "1412460",
    "2050": "1424155",
    "Age": "Total"
  },
  {
    "2021": "113140",
    "2022": "118490",
    "2023": "122574",
    "2024": "125599",
    "2025": "127252",
    "2026": "126514",
    "2027": "125999",
    "2028": "125158",
    "2029": "124090",
    "2030": "122745",
    "2031": "121151",
    "2032": "119366",
    "2033": "117356",
    "2034": "115132",
    "2035": "112843",
    "2036": "110566",
    "2037": "108444",
    "2038": "106537",
    "2039": "105010",
    "2040": "103880",
    "2041": "103295",
    "2042": "103237",
    "2043": "103695",
    "2044": "104602",
    "2045": "105888",
    "2046": "107375",
    "2047": "108933",
    "2048": "110509",
    "2049": "112032",
    "2050": "113391",
    "Age": "0-4"
  },
  {
    "2021": "97972",
    "2022": "99627",
    "2023": "101614",
    "2024": "103689",
    "2025": "106813",
    "2026": "111641",
    "2027": "116693",
    "2028": "120550",
    "2029": "123434",
    "2030": "125048",
    "2031": "124364",
    "2032": "123936",
    "2033": "123196",
    "2034": "122246",
    "2035": "121037",
    "2036": "119593",
    "2037": "117971",
    "2038": "116133",
    "2039": "114092",
    "2040": "111990",
    "2041": "109898",
    "2042": "107952",
    "2043": "106208",
    "2044": "104825",
    "2045": "103813",
    "2046": "103318",
    "2047": "103322",
    "2048": "103813",
    "2049": "104729",
    "2050": "106003",
    "Age": "5-9"
  },
  {
    "2021": "88138",
    "2022": "89170",
    "2023": "90642",
    "2024": "92613",
    "2025": "94452",
    "2026": "97001",
    "2027": "98555",
    "2028": "100450",
    "2029": "102423",
    "2030": "105398",
    "2031": "110026",
    "2032": "114885",
    "2033": "118604",
    "2034": "121410",
    "2035": "123017",
    "2036": "122393",
    "2037": "122049",
    "2038": "121397",
    "2039": "120548",
    "2040": "119452",
    "2041": "118132",
    "2042": "116644",
    "2043": "114949",
    "2044": "113057",
    "2045": "111105",
    "2046": "109157",
    "2047": "107347",
    "2048": "105724",
    "2049": "104444",
    "2050": "103514",
    "Age": "10-14"
  },
  {
    "2021": "74498",
    "2022": "76900",
    "2023": "80085",
    "2024": "82474",
    "2025": "85109",
    "2026": "87194",
    "2027": "88143",
    "2028": "89549",
    "2029": "91452",
    "2030": "93223",
    "2031": "95702",
    "2032": "97190",
    "2033": "99026",
    "2034": "100936",
    "2035": "103815",
    "2036": "108306",
    "2037": "113013",
    "2038": "116607",
    "2039": "119332",
    "2040": "120919",
    "2041": "120351",
    "2042": "120088",
    "2043": "119523",
    "2044": "118771",
    "2045": "117779",
    "2046": "116570",
    "2047": "115197",
    "2048": "113622",
    "2049": "111851",
    "2050": "110020",
    "Age": "15-19"
  },
  {
    "2021": "72501",
    "2022": "71923",
    "2023": "72143",
    "2024": "73224",
    "2025": "74492",
    "2026": "75822",
    "2027": "78033",
    "2028": "80969",
    "2029": "83117",
    "2030": "85502",
    "2031": "87380",
    "2032": "88246",
    "2033": "89620",
    "2034": "91465",
    "2035": "93136",
    "2036": "95460",
    "2037": "96805",
    "2038": "98550",
    "2039": "100382",
    "2040": "103130",
    "2041": "107361",
    "2042": "111713",
    "2043": "114990",
    "2044": "117506",
    "2045": "119055",
    "2046": "118625",
    "2047": "118552",
    "2048": "118175",
    "2049": "117624",
    "2050": "116843",
    "Age": "20-24"
  },
  {
    "2021": "93167",
    "2022": "88927",
    "2023": "84168",
    "2024": "80206",
    "2025": "77465",
    "2026": "75662",
    "2027": "75315",
    "2028": "75606",
    "2029": "76645",
    "2030": "77827",
    "2031": "79029",
    "2032": "80993",
    "2033": "83615",
    "2034": "85493",
    "2035": "87657",
    "2036": "89408",
    "2037": "90238",
    "2038": "91548",
    "2039": "93279",
    "2040": "94809",
    "2041": "97006",
    "2042": "98292",
    "2043": "99993",
    "2044": "101718",
    "2045": "104226",
    "2046": "108064",
    "2047": "112004",
    "2048": "114983",
    "2049": "117333",
    "2050": "118875",
    "Age": "25-29"
  },
  {
    "2021": "93910",
    "2022": "94563",
    "2023": "95383",
    "2024": "95248",
    "2025": "95151",
    "2026": "91767",
    "2027": "88176",
    "2028": "84125",
    "2029": "80801",
    "2030": "78551",
    "2031": "77076",
    "2032": "76897",
    "2033": "77236",
    "2034": "78246",
    "2035": "79371",
    "2036": "80488",
    "2037": "82288",
    "2038": "84709",
    "2039": "86421",
    "2040": "88452",
    "2041": "90131",
    "2042": "90955",
    "2043": "92242",
    "2044": "93919",
    "2045": "95381",
    "2046": "97506",
    "2047": "98746",
    "2048": "100391",
    "2049": "102010",
    "2050": "104314",
    "Age": "30-34"
  },
  {
    "2021": "84228",
    "2022": "87074",
    "2023": "88718",
    "2024": "90104",
    "2025": "89264",
    "2026": "90632",
    "2027": "91152",
    "2028": "91929",
    "2029": "91847",
    "2030": "91958",
    "2031": "89018",
    "2032": "85995",
    "2033": "82525",
    "2034": "79704",
    "2035": "77833",
    "2036": "76613",
    "2037": "76564",
    "2038": "76948",
    "2039": "77949",
    "2040": "79044",
    "2041": "80114",
    "2042": "81814",
    "2043": "84107",
    "2044": "85715",
    "2045": "87660",
    "2046": "89294",
    "2047": "90114",
    "2048": "91373",
    "2049": "92986",
    "2050": "94366",
    "Age": "35-39"
  },
  {
    "2021": "67599",
    "2022": "70457",
    "2023": "72818",
    "2024": "75345",
    "2025": "78355",
    "2026": "81164",
    "2027": "83731",
    "2028": "85207",
    "2029": "86544",
    "2030": "85736",
    "2031": "87079",
    "2032": "87574",
    "2033": "88374",
    "2034": "88374",
    "2035": "88659",
    "2036": "86046",
    "2037": "83425",
    "2038": "80358",
    "2039": "77879",
    "2040": "76263",
    "2041": "75218",
    "2042": "75265",
    "2043": "75693",
    "2044": "76700",
    "2045": "77786",
    "2046": "78831",
    "2047": "80461",
    "2048": "82659",
    "2049": "84186",
    "2050": "86055",
    "Age": "40-44"
  },
  {
    "2021": "58690",
    "2022": "59139",
    "2023": "60320",
    "2024": "62047",
    "2025": "63778",
    "2026": "65588",
    "2027": "68234",
    "2028": "70406",
    "2029": "72748",
    "2030": "75561",
    "2031": "78188",
    "2032": "80616",
    "2033": "82014",
    "2034": "83343",
    "2035": "82586",
    "2036": "83935",
    "2037": "84436",
    "2038": "85263",
    "2039": "85325",
    "2040": "85721",
    "2041": "83340",
    "2042": "81001",
    "2043": "78223",
    "2044": "75994",
    "2045": "74567",
    "2046": "73653",
    "2047": "73770",
    "2048": "74226",
    "2049": "75232",
    "2050": "76302",
    "Age": "45-49"
  },
  {
    "2021": "51281",
    "2022": "52933",
    "2023": "53443",
    "2024": "53852",
    "2025": "55015",
    "2026": "56717",
    "2027": "57110",
    "2028": "58216",
    "2029": "59838",
    "2030": "61464",
    "2031": "63163",
    "2032": "65672",
    "2033": "67722",
    "2034": "69940",
    "2035": "72615",
    "2036": "75114",
    "2037": "77440",
    "2038": "78784",
    "2039": "80109",
    "2040": "79408",
    "2041": "80769",
    "2042": "81289",
    "2043": "82145",
    "2044": "82265",
    "2045": "82745",
    "2046": "80555",
    "2047": "78439",
    "2048": "75890",
    "2049": "73857",
    "2050": "72574",
    "Age": "50-54"
  },
  {
    "2021": "46565",
    "2022": "46159",
    "2023": "47117",
    "2024": "47866",
    "2025": "48534",
    "2026": "48909",
    "2027": "50464",
    "2028": "50972",
    "2029": "51399",
    "2030": "52517",
    "2031": "54144",
    "2032": "54523",
    "2033": "55587",
    "2034": "57129",
    "2035": "58673",
    "2036": "60285",
    "2037": "62667",
    "2038": "64611",
    "2039": "66720",
    "2040": "69266",
    "2041": "71649",
    "2042": "73881",
    "2043": "75176",
    "2044": "76496",
    "2045": "75863",
    "2046": "77241",
    "2047": "77786",
    "2048": "78661",
    "2049": "78828",
    "2050": "79358",
    "Age": "55-59"
  },
  {
    "2021": "39526",
    "2022": "41195",
    "2023": "42175",
    "2024": "42773",
    "2025": "42966",
    "2026": "42946",
    "2027": "42570",
    "2028": "43461",
    "2029": "44139",
    "2030": "44754",
    "2031": "45109",
    "2032": "46580",
    "2033": "47119",
    "2034": "47596",
    "2035": "48684",
    "2036": "50233",
    "2037": "50618",
    "2038": "51646",
    "2039": "53106",
    "2040": "54567",
    "2041": "56091",
    "2042": "58334",
    "2043": "60169",
    "2044": "62166",
    "2045": "64575",
    "2046": "66832",
    "2047": "68953",
    "2048": "70187",
    "2049": "71485",
    "2050": "70921",
    "Age": "60-64"
  },
  {
    "2021": "24805",
    "2022": "26232",
    "2023": "28389",
    "2024": "30753",
    "2025": "32697",
    "2026": "34656",
    "2027": "36102",
    "2028": "36965",
    "2029": "37527",
    "2030": "37744",
    "2031": "37796",
    "2032": "37503",
    "2033": "38347",
    "2034": "38983",
    "2035": "39574",
    "2036": "39941",
    "2037": "41330",
    "2038": "41913",
    "2039": "42438",
    "2040": "43487",
    "2041": "44951",
    "2042": "45352",
    "2043": "46345",
    "2044": "47721",
    "2045": "49098",
    "2046": "50534",
    "2047": "52623",
    "2048": "54337",
    "2049": "56202",
    "2050": "58445",
    "Age": "65-69"
  },
  {
    "2021": "14600",
    "2022": "16082",
    "2023": "17167",
    "2024": "18314",
    "2025": "19266",
    "2026": "20581",
    "2027": "21773",
    "2028": "23581",
    "2029": "25574",
    "2030": "27210",
    "2031": "28883",
    "2032": "30139",
    "2033": "30915",
    "2034": "31465",
    "2035": "31724",
    "2036": "31863",
    "2037": "31678",
    "2038": "32480",
    "2039": "33085",
    "2040": "33654",
    "2041": "34036",
    "2042": "35319",
    "2043": "35933",
    "2044": "36495",
    "2045": "37493",
    "2046": "38851",
    "2047": "39267",
    "2048": "40213",
    "2049": "41486",
    "2050": "42756",
    "Age": "70-74"
  },
  {
    "2021": "6598",
    "2022": "7144",
    "2023": "8020",
    "2024": "8973",
    "2025": "10199",
    "2026": "11170",
    "2027": "12333",
    "2028": "13169",
    "2029": "14066",
    "2030": "14842",
    "2031": "15902",
    "2032": "16888",
    "2033": "18354",
    "2034": "19979",
    "2035": "21315",
    "2036": "22699",
    "2037": "23761",
    "2038": "24449",
    "2039": "24979",
    "2040": "25269",
    "2041": "25482",
    "2042": "25406",
    "2043": "26152",
    "2044": "26724",
    "2045": "27260",
    "2046": "27650",
    "2047": "28791",
    "2048": "29415",
    "2049": "29989",
    "2050": "30901",
    "Age": "75-79"
  },
  {
    "2021": "4562",
    "2022": "4695",
    "2023": "4465",
    "2024": "4308",
    "2025": "4383",
    "2026": "4407",
    "2027": "4823",
    "2028": "5432",
    "2029": "6082",
    "2030": "6941",
    "2031": "7619",
    "2032": "8464",
    "2033": "9064",
    "2034": "9719",
    "2035": "10318",
    "2036": "11118",
    "2037": "11887",
    "2038": "12994",
    "2039": "14225",
    "2040": "15241",
    "2041": "16308",
    "2042": "17150",
    "2043": "17725",
    "2044": "18207",
    "2045": "18504",
    "2046": "18763",
    "2047": "18783",
    "2048": "19437",
    "2049": "19948",
    "2050": "20421",
    "Age": "80-84"
  },
  {
    "2021": "2076",
    "2022": "2282",
    "2023": "2560",
    "2024": "2772",
    "2025": "2933",
    "2026": "3263",
    "2027": "3429",
    "2028": "3431",
    "2029": "3448",
    "2030": "3586",
    "2031": "3797",
    "2032": "4154",
    "2033": "4525",
    "2034": "4929",
    "2035": "5542",
    "2036": "6080",
    "2037": "6822",
    "2038": "7407",
    "2039": "8049",
    "2040": "8791",
    "2041": "9614",
    "2042": "10550",
    "2043": "11607",
    "2044": "12786",
    "2045": "13881",
    "2046": "15068",
    "2047": "16182",
    "2048": "17195",
    "2049": "18238",
    "2050": "19095",
    "Age": "85+"
  }
]

# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_city_region, gender='jami').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_city_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='jami',
                    population=population
                )

print("Navoi female data import completed successfully!")
