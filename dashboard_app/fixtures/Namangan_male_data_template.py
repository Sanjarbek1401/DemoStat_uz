import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_region, _ = Region.objects.get_or_create(name='Namangan', defaults={'svg_id': 'namangan'})

# Data to be imported
navoi_male_data =[
  {
    "2021": "1489048",
    "2022": "1521830",
    "2023": "1554274",
    "2024": "1586035",
    "2025": "1617123",
    "2026": "1647535",
    "2027": "1677282",
    "2028": "1706358",
    "2029": "1734498",
    "2030": "1761594",
    "2031": "1787559",
    "2032": "1812440",
    "2033": "1836356",
    "2034": "1859236",
    "2035": "1881253",
    "2036": "1902442",
    "2037": "1923051",
    "2038": "1943212",
    "2039": "1963111",
    "2040": "1982989",
    "2041": "2003137",
    "2042": "2023738",
    "2043": "2044860",
    "2044": "2066522",
    "2045": "2088807",
    "2046": "2111633",
    "2047": "2134927",
    "2048": "2158596",
    "2049": "2182500",
    "2050": "2206467",
    "Age": "Total"
  },
  {
    "2021": "181313",
    "2022": "190526",
    "2023": "196966",
    "2024": "200411",
    "2025": "201472",
    "2026": "200513",
    "2027": "198924",
    "2028": "196954",
    "2029": "194688",
    "2030": "192024",
    "2031": "188887",
    "2032": "185322",
    "2033": "181452",
    "2034": "177475",
    "2035": "173674",
    "2036": "170179",
    "2037": "167188",
    "2038": "164729",
    "2039": "163058",
    "2040": "162233",
    "2041": "162504",
    "2042": "163810",
    "2043": "166074",
    "2044": "169140",
    "2045": "172841",
    "2046": "176825",
    "2047": "180823",
    "2048": "184691",
    "2049": "188264",
    "2050": "191310",
    "Age": "0-4"
  },
  {
    "2021": "150498",
    "2022": "155600",
    "2023": "160670",
    "2024": "165433",
    "2025": "172008",
    "2026": "180376",
    "2027": "189520",
    "2028": "195916",
    "2029": "199343",
    "2030": "200408",
    "2031": "199469",
    "2032": "197908",
    "2033": "195970",
    "2034": "193739",
    "2035": "191115",
    "2036": "188021",
    "2037": "184503",
    "2038": "180680",
    "2039": "176749",
    "2040": "172994",
    "2041": "169542",
    "2042": "166589",
    "2043": "164164",
    "2044": "162520",
    "2045": "161717",
    "2046": "162002",
    "2047": "163315",
    "2048": "165579",
    "2049": "168641",
    "2050": "172333",
    "Age": "5-9"
  },
  {
    "2021": "133503",
    "2022": "133167",
    "2023": "134216",
    "2024": "139242",
    "2025": "144888",
    "2026": "149950",
    "2027": "155018",
    "2028": "160056",
    "2029": "164789",
    "2030": "171326",
    "2031": "179648",
    "2032": "187747",
    "2033": "195114",
    "2034": "198532",
    "2035": "199605",
    "2036": "198685",
    "2037": "197148",
    "2038": "195237",
    "2039": "193035",
    "2040": "190442",
    "2041": "187382",
    "2042": "183899",
    "2043": "180113",
    "2044": "176220",
    "2045": "172501",
    "2046": "169082",
    "2047": "166159",
    "2048": "163760",
    "2049": "162138",
    "2050": "161351",
    "Age": "10-14"
  },
  {
    "2021": "107797",
    "2022": "112194",
    "2023": "118805",
    "2024": "123661",
    "2025": "128218",
    "2026": "132930",
    "2027": "132588",
    "2028": "133634",
    "2029": "138638",
    "2030": "144255",
    "2031": "149290",
    "2032": "154329",
    "2033": "159343",
    "2034": "164056",
    "2035": "170566",
    "2036": "178851",
    "2037": "187908",
    "2038": "194248",
    "2039": "197657",
    "2040": "198738",
    "2041": "197839",
    "2042": "196328",
    "2043": "194446",
    "2044": "192274",
    "2045": "189713",
    "2046": "186688",
    "2047": "183240",
    "2048": "179491",
    "2049": "175634",
    "2050": "171949",
    "Age": "15-19"
  },
  {
    "2021": "110227",
    "2022": "107702",
    "2023": "105996",
    "2024": "105815",
    "2025": "106339",
    "2026": "107267",
    "2027": "111630",
    "2028": "118187",
    "2029": "122997",
    "2030": "127510",
    "2031": "132185",
    "2032": "131846",
    "2033": "132896",
    "2034": "137875",
    "2035": "143455",
    "2036": "148454",
    "2037": "153455",
    "2038": "158438",
    "2039": "163125",
    "2040": "169598",
    "2041": "177829",
    "2042": "186827",
    "2043": "193137",
    "2044": "196525",
    "2045": "197617",
    "2046": "196748",
    "2047": "195275",
    "2048": "193433",
    "2049": "191303",
    "2050": "188786",
    "Age": "20-24"
  },
  {
    "2021": "142065",
    "2022": "137530",
    "2023": "130802",
    "2024": "124546",
    "2025": "116363",
    "2026": "109576",
    "2027": "107106",
    "2028": "105435",
    "2029": "105271",
    "2030": "105801",
    "2031": "106723",
    "2032": "111046",
    "2033": "117538",
    "2034": "122291",
    "2035": "126753",
    "2036": "131391",
    "2037": "131061",
    "2038": "132116",
    "2039": "137063",
    "2040": "142596",
    "2041": "147549",
    "2042": "152507",
    "2043": "157453",
    "2044": "162109",
    "2045": "168534",
    "2046": "176697",
    "2047": "185621",
    "2048": "191874",
    "2049": "195259",
    "2050": "196368",
    "Age": "25-29"
  },
  {
    "2021": "133593",
    "2022": "136807",
    "2023": "139621",
    "2024": "141653",
    "2025": "142280",
    "2026": "140648",
    "2027": "136188",
    "2028": "129574",
    "2029": "123442",
    "2030": "115405",
    "2031": "108743",
    "2032": "106342",
    "2033": "104716",
    "2034": "104576",
    "2035": "105117",
    "2036": "106035",
    "2037": "110316",
    "2038": "116740",
    "2039": "121438",
    "2040": "125852",
    "2041": "130455",
    "2042": "130138",
    "2043": "131200",
    "2044": "136112",
    "2045": "141598",
    "2046": "146508",
    "2047": "151424",
    "2048": "156333",
    "2049": "160953",
    "2050": "167325",
    "Age": "30-34"
  },
  {
    "2021": "112393",
    "2022": "116812",
    "2023": "121259",
    "2024": "124747",
    "2025": "129016",
    "2026": "131905",
    "2027": "135063",
    "2028": "137835",
    "2029": "139843",
    "2030": "140480",
    "2031": "138901",
    "2032": "133542",
    "2033": "128065",
    "2034": "122073",
    "2035": "114196",
    "2036": "107669",
    "2037": "105344",
    "2038": "103766",
    "2039": "103652",
    "2040": "104206",
    "2041": "105143",
    "2042": "109363",
    "2043": "115719",
    "2044": "120364",
    "2045": "124732",
    "2046": "129300",
    "2047": "129002",
    "2048": "130071",
    "2049": "134947",
    "2050": "140328",
    "Age": "35-39"
  },
  {
    "2021": "91338",
    "2022": "94364",
    "2023": "97987",
    "2024": "100801",
    "2025": "105484",
    "2026": "110701",
    "2027": "115037",
    "2028": "119412",
    "2029": "122842",
    "2030": "127053",
    "2031": "129909",
    "2032": "133032",
    "2033": "135782",
    "2034": "137781",
    "2035": "138442",
    "2036": "136928",
    "2037": "132678",
    "2038": "126344",
    "2039": "120492",
    "2040": "112776",
    "2041": "106385",
    "2042": "104133",
    "2043": "102604",
    "2044": "102520",
    "2045": "103089",
    "2046": "104009",
    "2047": "108210",
    "2048": "114498",
    "2049": "119093",
    "2050": "123418",
    "Age": "40-44"
  },
  {
    "2021": "83880",
    "2022": "84700",
    "2023": "84951",
    "2024": "86733",
    "2025": "87827",
    "2026": "89554",
    "2027": "92526",
    "2028": "96086",
    "2029": "98854",
    "2030": "103457",
    "2031": "108592",
    "2032": "112859",
    "2033": "117170",
    "2034": "120551",
    "2035": "124713",
    "2036": "127549",
    "2037": "130647",
    "2038": "133381",
    "2039": "135372",
    "2040": "136062",
    "2041": "134618",
    "2042": "130483",
    "2043": "124301",
    "2044": "118595",
    "2045": "111056",
    "2046": "104816",
    "2047": "102643",
    "2048": "101170",
    "2049": "101116",
    "2050": "101701",
    "Age": "45-49"
  },
  {
    "2021": "67558",
    "2022": "70258",
    "2023": "73087",
    "2024": "76100",
    "2025": "78871",
    "2026": "81474",
    "2027": "82286",
    "2028": "82554",
    "2029": "84316",
    "2030": "85407",
    "2031": "87126",
    "2032": "90047",
    "2033": "93541",
    "2034": "96267",
    "2035": "100783",
    "2036": "105828",
    "2037": "110019",
    "2038": "114259",
    "2039": "117585",
    "2040": "121689",
    "2041": "124507",
    "2042": "127574",
    "2043": "130289",
    "2044": "132270",
    "2045": "132996",
    "2046": "131636",
    "2047": "127637",
    "2048": "121636",
    "2049": "116101",
    "2050": "108775",
    "Age": "50-54"
  },
  {
    "2021": "60305",
    "2022": "60610",
    "2023": "61409",
    "2024": "61813",
    "2025": "62667",
    "2026": "64550",
    "2027": "67165",
    "2028": "69913",
    "2029": "72820",
    "2030": "75507",
    "2031": "78037",
    "2032": "78855",
    "2033": "79161",
    "2034": "80908",
    "2035": "82008",
    "2036": "83729",
    "2037": "86589",
    "2038": "90001",
    "2039": "92676",
    "2040": "97076",
    "2041": "102005",
    "2042": "106095",
    "2043": "110239",
    "2044": "113488",
    "2045": "117515",
    "2046": "120311",
    "2047": "123336",
    "2048": "126024",
    "2049": "127981",
    "2050": "128747",
    "Age": "55-59"
  },
  {
    "2021": "51773",
    "2022": "53729",
    "2023": "54831",
    "2024": "55761",
    "2025": "55885",
    "2026": "55833",
    "2027": "56167",
    "2028": "56973",
    "2029": "57401",
    "2030": "58260",
    "2031": "60087",
    "2032": "62595",
    "2033": "65239",
    "2034": "68008",
    "2035": "70572",
    "2036": "73022",
    "2037": "73854",
    "2038": "74220",
    "2039": "75944",
    "2040": "77056",
    "2041": "78778",
    "2042": "81548",
    "2043": "84838",
    "2044": "87440",
    "2045": "91675",
    "2046": "96433",
    "2047": "100375",
    "2048": "104374",
    "2049": "107507",
    "2050": "111411",
    "Age": "60-64"
  },
  {
    "2021": "29480",
    "2022": "32245",
    "2023": "36108",
    "2024": "39542",
    "2025": "43100",
    "2026": "45755",
    "2027": "47529",
    "2028": "48572",
    "2029": "49461",
    "2030": "49663",
    "2031": "49717",
    "2032": "50105",
    "2033": "50932",
    "2034": "51405",
    "2035": "52281",
    "2036": "54036",
    "2037": "56405",
    "2038": "58909",
    "2039": "61498",
    "2040": "63909",
    "2041": "66241",
    "2042": "67090",
    "2043": "67530",
    "2044": "69216",
    "2045": "70339",
    "2046": "72045",
    "2047": "74687",
    "2048": "77807",
    "2049": "80301",
    "2050": "84297",
    "Age": "65-69"
  },
  {
    "2021": "17379",
    "2022": "18801",
    "2023": "19908",
    "2024": "21009",
    "2025": "22259",
    "2026": "24639",
    "2027": "27028",
    "2028": "30336",
    "2029": "33269",
    "2030": "36341",
    "2031": "38672",
    "2032": "40249",
    "2033": "41233",
    "2034": "42080",
    "2035": "42375",
    "2036": "42549",
    "2037": "42997",
    "2038": "43837",
    "2039": "44352",
    "2040": "45229",
    "2041": "46881",
    "2042": "49066",
    "2043": "51387",
    "2044": "53748",
    "2045": "55963",
    "2046": "58132",
    "2047": "58985",
    "2048": "59492",
    "2049": "61105",
    "2050": "62212",
    "Age": "70-74"
  },
  {
    "2021": "8606",
    "2022": "8722",
    "2023": "9439",
    "2024": "10509",
    "2025": "12075",
    "2026": "13064",
    "2027": "14181",
    "2028": "15042",
    "2029": "15921",
    "2030": "16977",
    "2031": "18909",
    "2032": "20854",
    "2033": "23504",
    "2034": "25844",
    "2035": "28372",
    "2036": "30275",
    "2037": "31606",
    "2038": "32500",
    "2039": "33274",
    "2040": "33651",
    "2041": "33939",
    "2042": "34428",
    "2043": "35252",
    "2044": "35782",
    "2045": "36641",
    "2046": "38138",
    "2047": "40070",
    "2048": "42130",
    "2049": "44176",
    "2050": "46108",
    "Age": "75-79"
  },
  {
    "2021": "5402",
    "2022": "5990",
    "2023": "5968",
    "2024": "5728",
    "2025": "5535",
    "2026": "5420",
    "2027": "5583",
    "2028": "6088",
    "2029": "6817",
    "2030": "7890",
    "2031": "8585",
    "2032": "9380",
    "2033": "9993",
    "2034": "10640",
    "2035": "11461",
    "2036": "12889",
    "2037": "14334",
    "2038": "16262",
    "2039": "17960",
    "2040": "19806",
    "2041": "21285",
    "2042": "22322",
    "2043": "23080",
    "2044": "23742",
    "2045": "24161",
    "2046": "24519",
    "2047": "25007",
    "2048": "25760",
    "2049": "26275",
    "2050": "27042",
    "Age": "80-84"
  },
  {
    "2021": "1938",
    "2022": "2075",
    "2023": "2250",
    "2024": "2530",
    "2025": "2837",
    "2026": "3379",
    "2027": "3743",
    "2028": "3790",
    "2029": "3787",
    "2030": "3839",
    "2031": "4079",
    "2032": "4383",
    "2033": "4705",
    "2034": "5134",
    "2035": "5801",
    "2036": "6350",
    "2037": "6999",
    "2038": "7547",
    "2039": "8182",
    "2040": "9075",
    "2041": "10274",
    "2042": "11539",
    "2043": "13044",
    "2044": "14450",
    "2045": "16120",
    "2046": "17743",
    "2047": "19118",
    "2048": "20473",
    "2049": "21704",
    "2050": "22955",
    "Age": "85+"
  }
]
# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_region, gender='erkak').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='erkak',
                    population=population
                )

print("Navoi male data import completed successfully!")
