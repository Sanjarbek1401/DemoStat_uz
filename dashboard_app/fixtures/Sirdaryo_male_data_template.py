import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_region, _ = Region.objects.get_or_create(name='Sirdaryo', defaults={'svg_id': 'sirdarya'})

# Data to be imported
navoi_male_data =[
  {
    "Age": "Total",
    "2022": "441112",
    "2023": "449744",
    "2024": "458271",
    "2025": "466596",
    "2026": "474733",
    "2027": "482652",
    "2028": "490325",
    "2029": "497770",
    "2030": "504937",
    "2031": "511801",
    "2032": "518329",
    "2033": "524513",
    "2034": "530353",
    "2035": "535821",
    "2036": "540964",
    "2037": "545788",
    "2038": "550357",
    "2039": "554699",
    "2040": "558872",
    "2041": "562944",
    "2042": "567000",
    "2043": "571100",
    "2044": "575267",
    "2045": "579517",
    "2046": "583876",
    "2047": "588337",
    "2048": "592882",
    "2049": "597507",
    "2050": "602177"
  },
  {
    "Age": "0-4",
    "2022": "50768",
    "2023": "53671",
    "2024": "56232",
    "2025": "57378",
    "2026": "58209",
    "2027": "58053",
    "2028": "57778",
    "2029": "57315",
    "2030": "56722",
    "2031": "55976",
    "2032": "55080",
    "2033": "54061",
    "2034": "52905",
    "2035": "51629",
    "2036": "50313",
    "2037": "49001",
    "2038": "47765",
    "2039": "46646",
    "2040": "45727",
    "2041": "45029",
    "2042": "44627",
    "2043": "44517",
    "2044": "44691",
    "2045": "45112",
    "2046": "45739",
    "2047": "46481",
    "2048": "47271",
    "2049": "48073",
    "2050": "48847"
  },
  {
    "Age": "5-9",
    "2022": "43073",
    "2023": "43583",
    "2024": "44252",
    "2025": "45856",
    "2026": "47530",
    "2027": "50100",
    "2028": "52898",
    "2029": "55376",
    "2030": "56475",
    "2031": "57290",
    "2032": "57141",
    "2033": "56887",
    "2034": "56453",
    "2035": "55897",
    "2036": "55192",
    "2037": "54343",
    "2038": "53376",
    "2039": "52275",
    "2040": "51059",
    "2041": "49802",
    "2042": "48549",
    "2043": "47370",
    "2044": "46303",
    "2045": "45429",
    "2046": "44769",
    "2047": "44395",
    "2048": "44304",
    "2049": "44488",
    "2050": "44911"
  },
  {
    "Age": "10-14",
    "2022": "41666",
    "2023": "41473",
    "2024": "41142",
    "2025": "41295",
    "2026": "41763",
    "2027": "42656",
    "2028": "43141",
    "2029": "43782",
    "2030": "45341",
    "2031": "46959",
    "2032": "49459",
    "2033": "52184",
    "2034": "54606",
    "2035": "55678",
    "2036": "56487",
    "2037": "56350",
    "2038": "56119",
    "2039": "55711",
    "2040": "55185",
    "2041": "54515",
    "2042": "53705",
    "2043": "52779",
    "2044": "51725",
    "2045": "50556",
    "2046": "49349",
    "2047": "48144",
    "2048": "47011",
    "2049": "45985",
    "2050": "45147"
  },
  {
    "Age": "15-19",
    "2022": "35546",
    "2023": "36408",
    "2024": "38213",
    "2025": "39741",
    "2026": "40982",
    "2027": "41175",
    "2028": "40976",
    "2029": "40648",
    "2030": "40800",
    "2031": "41260",
    "2032": "42138",
    "2033": "42611",
    "2034": "43235",
    "2035": "44766",
    "2036": "46345",
    "2037": "48793",
    "2038": "51457",
    "2039": "53827",
    "2040": "54874",
    "2041": "55677",
    "2042": "55551",
    "2043": "55341",
    "2044": "54958",
    "2045": "54461",
    "2046": "53824",
    "2047": "53049",
    "2048": "52163",
    "2049": "51149",
    "2050": "50023"
  },
  {
    "Age": "20-24",
    "2022": "34537",
    "2023": "34395",
    "2024": "34070",
    "2025": "34207",
    "2026": "34358",
    "2027": "35216",
    "2028": "36034",
    "2029": "37776",
    "2030": "39237",
    "2031": "40429",
    "2032": "40607",
    "2033": "40422",
    "2034": "40116",
    "2035": "40282",
    "2036": "40738",
    "2037": "41600",
    "2038": "42059",
    "2039": "42665",
    "2040": "44162",
    "2041": "45692",
    "2042": "48068",
    "2043": "50644",
    "2044": "52941",
    "2045": "53951",
    "2046": "54747",
    "2047": "54640",
    "2048": "54461",
    "2049": "54115",
    "2050": "53659"
  },
  {
    "Age": "25-29",
    "2022": "40070",
    "2023": "38708",
    "2024": "37244",
    "2025": "36006",
    "2026": "35067",
    "2027": "34286",
    "2028": "34169",
    "2029": "33861",
    "2030": "34003",
    "2031": "34146",
    "2032": "34978",
    "2033": "35750",
    "2034": "37417",
    "2035": "38801",
    "2036": "39943",
    "2037": "40116",
    "2038": "39956",
    "2039": "39683",
    "2040": "39866",
    "2041": "40316",
    "2042": "41159",
    "2043": "41604",
    "2044": "42190",
    "2045": "43644",
    "2046": "45109",
    "2047": "47391",
    "2048": "49858",
    "2049": "52069",
    "2050": "53038"
  },
  {
    "Age": "30-34",
    "2022": "44186",
    "2023": "43737",
    "2024": "43200",
    "2025": "41824",
    "2026": "40762",
    "2027": "39246",
    "2028": "37975",
    "2029": "36607",
    "2030": "35460",
    "2031": "34597",
    "2032": "33875",
    "2033": "33793",
    "2034": "33511",
    "2035": "33667",
    "2036": "33808",
    "2037": "34614",
    "2038": "35341",
    "2039": "36937",
    "2040": "38252",
    "2041": "39352",
    "2042": "39527",
    "2043": "39398",
    "2044": "39158",
    "2045": "39357",
    "2046": "39805",
    "2047": "40634",
    "2048": "41072",
    "2049": "41641",
    "2050": "43049"
  },
  {
    "Age": "35-39",
    "2022": "38050",
    "2023": "40135",
    "2024": "41372",
    "2025": "42477",
    "2026": "42744",
    "2027": "42720",
    "2028": "42283",
    "2029": "41791",
    "2030": "40498",
    "2031": "39531",
    "2032": "38123",
    "2033": "36960",
    "2034": "35698",
    "2035": "34646",
    "2036": "33862",
    "2037": "33200",
    "2038": "33155",
    "2039": "32900",
    "2040": "33071",
    "2041": "33212",
    "2042": "33997",
    "2043": "34685",
    "2044": "36217",
    "2045": "37473",
    "2046": "38540",
    "2047": "38722",
    "2048": "38626",
    "2049": "38419",
    "2050": "38635"
  },
  {
    "Age": "40-44",
    "2022": "28572",
    "2023": "30021",
    "2024": "31303",
    "2025": "33024",
    "2026": "34725",
    "2027": "36752",
    "2028": "38711",
    "2029": "39862",
    "2030": "40916",
    "2031": "41171",
    "2032": "41165",
    "2033": "40768",
    "2034": "40335",
    "2035": "39130",
    "2036": "38253",
    "2037": "36942",
    "2038": "35872",
    "2039": "34701",
    "2040": "33729",
    "2041": "33011",
    "2042": "32397",
    "2043": "32382",
    "2044": "32153",
    "2045": "32339",
    "2046": "32485",
    "2047": "33253",
    "2048": "33911",
    "2049": "35393",
    "2050": "36604"
  },
  {
    "Age": "45-49",
    "2022": "22513",
    "2023": "22820",
    "2024": "24106",
    "2025": "25248",
    "2026": "26430",
    "2027": "27646",
    "2028": "29012",
    "2029": "30217",
    "2030": "31850",
    "2031": "33460",
    "2032": "35388",
    "2033": "37257",
    "2034": "38355",
    "2035": "39376",
    "2036": "39634",
    "2037": "39652",
    "2038": "39297",
    "2039": "38917",
    "2040": "37789",
    "2041": "36986",
    "2042": "35760",
    "2043": "34770",
    "2044": "33677",
    "2045": "32774",
    "2046": "32113",
    "2047": "31545",
    "2048": "31557",
    "2049": "31352",
    "2050": "31552"
  },
  {
    "Age": "50-54",
    "2022": "17610",
    "2023": "18633",
    "2024": "19627",
    "2025": "20660",
    "2026": "21234",
    "2027": "21618",
    "2028": "21901",
    "2029": "23123",
    "2030": "24200",
    "2031": "25321",
    "2032": "26475",
    "2033": "27773",
    "2034": "28920",
    "2035": "30478",
    "2036": "32013",
    "2037": "33854",
    "2038": "35643",
    "2039": "36695",
    "2040": "37688",
    "2041": "37950",
    "2042": "37995",
    "2043": "37683",
    "2044": "37353",
    "2045": "36304",
    "2046": "35572",
    "2047": "34430",
    "2048": "33518",
    "2049": "32501",
    "2050": "31663"
  },
  {
    "Age": "55-59",
    "2022": "15834",
    "2023": "15752",
    "2024": "15409",
    "2025": "15163",
    "2026": "15751",
    "2027": "16640",
    "2028": "17595",
    "2029": "18513",
    "2030": "19471",
    "2031": "20014",
    "2032": "20387",
    "2033": "20660",
    "2034": "21820",
    "2035": "22836",
    "2036": "23899",
    "2037": "24990",
    "2038": "26216",
    "2039": "27306",
    "2040": "28785",
    "2041": "30240",
    "2042": "31987",
    "2043": "33686",
    "2044": "34688",
    "2045": "35651",
    "2046": "35920",
    "2047": "35997",
    "2048": "35734",
    "2049": "35458",
    "2050": "34496"
  },
  {
    "Age": "60-64",
    "2022": "13615",
    "2023": "14024",
    "2024": "14329",
    "2025": "14485",
    "2026": "14444",
    "2027": "14323",
    "2028": "14268",
    "2029": "13977",
    "2030": "13774",
    "2031": "14331",
    "2032": "15155",
    "2033": "16033",
    "2034": "16864",
    "2035": "17735",
    "2036": "18246",
    "2037": "18612",
    "2038": "18882",
    "2039": "19965",
    "2040": "20907",
    "2041": "21898",
    "2042": "22912",
    "2043": "24048",
    "2044": "25070",
    "2045": "26452",
    "2046": "27811",
    "2047": "29440",
    "2048": "31024",
    "2049": "31964",
    "2050": "32884"
  },
  {
    "Age": "65-69",
    "2022": "8391",
    "2023": "9031",
    "2024": "9766",
    "2025": "10466",
    "2026": "11126",
    "2027": "11559",
    "2028": "11912",
    "2029": "12184",
    "2030": "12338",
    "2031": "12328",
    "2032": "12253",
    "2033": "12238",
    "2034": "12016",
    "2035": "11869",
    "2036": "12391",
    "2037": "13137",
    "2038": "13927",
    "2039": "14663",
    "2040": "15436",
    "2041": "15911",
    "2042": "16267",
    "2043": "16533",
    "2044": "17522",
    "2045": "18378",
    "2046": "19284",
    "2047": "20210",
    "2048": "21239",
    "2049": "22181",
    "2050": "23443"
  },
  {
    "Age": "70-74",
    "2022": "3855",
    "2023": "4375",
    "2024": "4852",
    "2025": "5510",
    "2026": "5924",
    "2027": "6641",
    "2028": "7161",
    "2029": "7757",
    "2030": "8329",
    "2031": "8873",
    "2032": "9244",
    "2033": "9551",
    "2034": "9798",
    "2035": "9954",
    "2036": "9979",
    "2037": "9953",
    "2038": "9977",
    "2039": "9827",
    "2040": "9739",
    "2041": "10212",
    "2042": "10870",
    "2043": "11562",
    "2044": "12194",
    "2045": "12859",
    "2046": "13292",
    "2047": "13632",
    "2048": "13891",
    "2049": "14769",
    "2050": "15526"
  },
  {
    "Age": "75-79",
    "2022": "1344",
    "2023": "1500",
    "2024": "1768",
    "2025": "1972",
    "2026": "2408",
    "2027": "2702",
    "2028": "3083",
    "2029": "3428",
    "2030": "3896",
    "2031": "4211",
    "2032": "4745",
    "2033": "5140",
    "2034": "5589",
    "2035": "6026",
    "2036": "6448",
    "2037": "6754",
    "2038": "7008",
    "2039": "7222",
    "2040": "7372",
    "2041": "7425",
    "2042": "7443",
    "2043": "7498",
    "2044": "7417",
    "2045": "7385",
    "2046": "7799",
    "2047": "8354",
    "2048": "8929",
    "2049": "9438",
    "2050": "9972"
  },
  {
    "Age": "80-84",
    "2022": "918",
    "2023": "909",
    "2024": "824",
    "2025": "724",
    "2026": "754",
    "2027": "778",
    "2028": "885",
    "2029": "1045",
    "2030": "1159",
    "2031": "1430",
    "2032": "1611",
    "2033": "1855",
    "2034": "2075",
    "2035": "2367",
    "2036": "2582",
    "2037": "2935",
    "2038": "3204",
    "2039": "3507",
    "2040": "3808",
    "2041": "4102",
    "2042": "4330",
    "2043": "4521",
    "2044": "4691",
    "2045": "4822",
    "2046": "4890",
    "2047": "4936",
    "2048": "5007",
    "2049": "4983",
    "2050": "4994"
  },
  {
    "Age": "85+",
    "2022": "564",
    "2023": "566",
    "2024": "564",
    "2025": "562",
    "2026": "522",
    "2027": "542",
    "2028": "543",
    "2029": "507",
    "2030": "467",
    "2031": "474",
    "2032": "507",
    "2033": "571",
    "2034": "641",
    "2035": "683",
    "2036": "831",
    "2037": "942",
    "2038": "1103",
    "2039": "1252",
    "2040": "1424",
    "2041": "1612",
    "2042": "1856",
    "2043": "2080",
    "2044": "2318",
    "2045": "2569",
    "2046": "2827",
    "2047": "3082",
    "2048": "3304",
    "2049": "3526",
    "2050": "3734"
  }
]
# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_region, gender='erkak').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='erkak',
                    population=population
                )

print("Navoi male data import completed successfully!")
