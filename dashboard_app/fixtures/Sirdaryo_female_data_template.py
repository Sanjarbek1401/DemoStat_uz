import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_city_region, _ = Region.objects.get_or_create(name='Sirdaryo', defaults={'svg_id': 'sirdarya'})

# Data to be imported
navoi_male_data = [
  {
    "Age": "Total",
    "2022": "437478",
    "2023": "446257",
    "2024": "455023",
    "2025": "463688",
    "2026": "472244",
    "2027": "480648",
    "2028": "488861",
    "2029": "496885",
    "2030": "504672",
    "2031": "512193",
    "2032": "519411",
    "2033": "526314",
    "2034": "532899",
    "2035": "539129",
    "2036": "545046",
    "2037": "550660",
    "2038": "556026",
    "2039": "561174",
    "2040": "566154",
    "2041": "571032",
    "2042": "575888",
    "2043": "580778",
    "2044": "585723",
    "2045": "590743",
    "2046": "595859",
    "2047": "601066",
    "2048": "606352",
    "2049": "611706",
    "2050": "617099"
  },
  {
    "Age": "0-4",
    "2022": "47467",
    "2023": "50227",
    "2024": "52778",
    "2025": "54098",
    "2026": "55024",
    "2027": "54900",
    "2028": "54644",
    "2029": "54210",
    "2030": "53654",
    "2031": "52952",
    "2032": "52108",
    "2033": "51147",
    "2034": "50055",
    "2035": "48850",
    "2036": "47606",
    "2037": "46366",
    "2038": "45199",
    "2039": "44142",
    "2040": "43275",
    "2041": "42617",
    "2042": "42238",
    "2043": "42137",
    "2044": "42302",
    "2045": "42701",
    "2046": "43293",
    "2047": "43993",
    "2048": "44738",
    "2049": "45493",
    "2050": "46220"
  },
  {
    "Age": "5-9",
    "2022": "39990",
    "2023": "40619",
    "2024": "41197",
    "2025": "42674",
    "2026": "44199",
    "2027": "47059",
    "2028": "49731",
    "2029": "52215",
    "2030": "53500",
    "2031": "54420",
    "2032": "54315",
    "2033": "54090",
    "2034": "53691",
    "2035": "53174",
    "2036": "52515",
    "2037": "51718",
    "2038": "50808",
    "2039": "49771",
    "2040": "48625",
    "2041": "47443",
    "2042": "46265",
    "2043": "45160",
    "2044": "44159",
    "2045": "43343",
    "2046": "42728",
    "2047": "42382",
    "2048": "42303",
    "2049": "42481",
    "2050": "42883"
  },
  {
    "Age": "10-14",
    "2022": "38514",
    "2023": "38424",
    "2024": "38270",
    "2025": "38422",
    "2026": "39190",
    "2027": "39784",
    "2028": "40403",
    "2029": "40966",
    "2030": "42414",
    "2031": "43892",
    "2032": "46689",
    "2033": "49295",
    "2034": "51730",
    "2035": "52989",
    "2036": "53904",
    "2037": "53812",
    "2038": "53609",
    "2039": "53238",
    "2040": "52753",
    "2041": "52131",
    "2042": "51377",
    "2043": "50514",
    "2044": "49528",
    "2045": "48435",
    "2046": "47305",
    "2047": "46177",
    "2048": "45117",
    "2049": "44156",
    "2050": "43373"
  },
  {
    "Age": "15-19",
    "2022": "33960",
    "2023": "34456",
    "2024": "36072",
    "2025": "37174",
    "2026": "38071",
    "2027": "38219",
    "2028": "38127",
    "2029": "37984",
    "2030": "38146",
    "2031": "38914",
    "2032": "39502",
    "2033": "40111",
    "2034": "40660",
    "2035": "42084",
    "2036": "43531",
    "2037": "46277",
    "2038": "48820",
    "2039": "51196",
    "2040": "52420",
    "2041": "53324",
    "2042": "53246",
    "2043": "53073",
    "2044": "52737",
    "2045": "52291",
    "2046": "51710",
    "2047": "50997",
    "2048": "50177",
    "2049": "49233",
    "2050": "48183"
  },
  {
    "Age": "20-24",
    "2022": "33807",
    "2023": "33977",
    "2024": "33696",
    "2025": "33913",
    "2026": "33948",
    "2027": "34680",
    "2028": "35162",
    "2029": "36682",
    "2030": "37651",
    "2031": "38438",
    "2032": "38548",
    "2033": "38507",
    "2034": "38460",
    "2035": "38691",
    "2036": "39450",
    "2037": "39980",
    "2038": "40536",
    "2039": "41051",
    "2040": "42439",
    "2041": "43798",
    "2042": "46356",
    "2043": "48647",
    "2044": "50804",
    "2045": "51904",
    "2046": "52785",
    "2047": "52772",
    "2048": "52704",
    "2049": "52478",
    "2050": "52146"
  },
  {
    "Age": "25-29",
    "2022": "40050",
    "2023": "38664",
    "2024": "37301",
    "2025": "36486",
    "2026": "35823",
    "2027": "35270",
    "2028": "35542",
    "2029": "35355",
    "2030": "35651",
    "2031": "35722",
    "2032": "36432",
    "2033": "36818",
    "2034": "38182",
    "2035": "39022",
    "2036": "39770",
    "2037": "39926",
    "2038": "39967",
    "2039": "39980",
    "2040": "40218",
    "2041": "40949",
    "2042": "41477",
    "2043": "42060",
    "2044": "42569",
    "2045": "43868",
    "2046": "45052",
    "2047": "47354",
    "2048": "49387",
    "2049": "51361",
    "2050": "52375"
  },
  {
    "Age": "30-34",
    "2022": "43571",
    "2023": "43083",
    "2024": "42809",
    "2025": "41772",
    "2026": "41151",
    "2027": "39805",
    "2028": "38659",
    "2029": "37517",
    "2030": "36881",
    "2031": "36364",
    "2032": "35912",
    "2033": "36237",
    "2034": "36096",
    "2035": "36423",
    "2036": "36501",
    "2037": "37189",
    "2038": "37522",
    "2039": "38803",
    "2040": "39581",
    "2041": "40322",
    "2042": "40522",
    "2043": "40631",
    "2044": "40711",
    "2045": "40989",
    "2046": "41735",
    "2047": "42278",
    "2048": "42876",
    "2049": "43367",
    "2050": "44597"
  },
  {
    "Age": "35-39",
    "2022": "38176",
    "2023": "40153",
    "2024": "41248",
    "2025": "42247",
    "2026": "42046",
    "2027": "42235",
    "2028": "41802",
    "2029": "41622",
    "2030": "40716",
    "2031": "40242",
    "2032": "39066",
    "2033": "38090",
    "2034": "37097",
    "2035": "36574",
    "2036": "36146",
    "2037": "35755",
    "2038": "36110",
    "2039": "35998",
    "2040": "36350",
    "2041": "36444",
    "2042": "37134",
    "2043": "37457",
    "2044": "38706",
    "2045": "39467",
    "2046": "40220",
    "2047": "40459",
    "2048": "40615",
    "2049": "40731",
    "2050": "41018"
  },
  {
    "Age": "40-44",
    "2022": "28510",
    "2023": "30172",
    "2024": "31634",
    "2025": "33153",
    "2026": "35052",
    "2027": "37041",
    "2028": "38891",
    "2029": "39916",
    "2030": "40891",
    "2031": "40714",
    "2032": "40940",
    "2033": "40559",
    "2034": "40446",
    "2035": "39626",
    "2036": "39242",
    "2037": "38169",
    "2038": "37296",
    "2039": "36396",
    "2040": "35945",
    "2041": "35580",
    "2042": "35236",
    "2043": "35622",
    "2044": "35544",
    "2045": "35927",
    "2046": "36043",
    "2047": "36740",
    "2048": "37056",
    "2049": "38277",
    "2050": "39016"
  },
  {
    "Age": "45-49",
    "2022": "21286",
    "2023": "22335",
    "2024": "23958",
    "2025": "25337",
    "2026": "26729",
    "2027": "27893",
    "2028": "29468",
    "2029": "30847",
    "2030": "32282",
    "2031": "34086",
    "2032": "35978",
    "2033": "37751",
    "2034": "38732",
    "2035": "39692",
    "2036": "39533",
    "2037": "39783",
    "2038": "39438",
    "2039": "39370",
    "2040": "38611",
    "2041": "38290",
    "2042": "37296",
    "2043": "36504",
    "2044": "35679",
    "2045": "35288",
    "2046": "34973",
    "2047": "34668",
    "2048": "35074",
    "2049": "35014",
    "2050": "35408"
  },
  {
    "Age": "50-54",
    "2022": "18678",
    "2023": "18788",
    "2024": "18830",
    "2025": "19492",
    "2026": "20160",
    "2027": "20831",
    "2028": "21825",
    "2029": "23373",
    "2030": "24683",
    "2031": "26012",
    "2032": "27121",
    "2033": "28630",
    "2034": "29949",
    "2035": "31320",
    "2036": "33049",
    "2037": "34862",
    "2038": "36570",
    "2039": "37514",
    "2040": "38458",
    "2041": "38320",
    "2042": "38595",
    "2043": "38292",
    "2044": "38267",
    "2045": "37568",
    "2046": "37301",
    "2047": "36377",
    "2048": "35649",
    "2049": "34882",
    "2050": "34531"
  },
  {
    "Age": "55-59",
    "2022": "18885",
    "2023": "18622",
    "2024": "18279",
    "2025": "17861",
    "2026": "17725",
    "2027": "18043",
    "2028": "18160",
    "2029": "18209",
    "2030": "18848",
    "2031": "19492",
    "2032": "20137",
    "2033": "21079",
    "2034": "22548",
    "2035": "23788",
    "2036": "25054",
    "2037": "26105",
    "2038": "27543",
    "2039": "28800",
    "2040": "30109",
    "2041": "31765",
    "2042": "33498",
    "2043": "35141",
    "2044": "36053",
    "2045": "36983",
    "2046": "36874",
    "2047": "37177",
    "2048": "36917",
    "2049": "36928",
    "2050": "36283"
  },
  {
    "Age": "60-64",
    "2022": "15633",
    "2023": "16360",
    "2024": "16862",
    "2025": "17308",
    "2026": "17553",
    "2027": "17465",
    "2028": "17252",
    "2029": "16974",
    "2030": "16623",
    "2031": "16532",
    "2032": "16858",
    "2033": "16983",
    "2034": "17040",
    "2035": "17649",
    "2036": "18263",
    "2037": "18880",
    "2038": "19761",
    "2039": "21135",
    "2040": "22296",
    "2041": "23490",
    "2042": "24480",
    "2043": "25837",
    "2044": "27030",
    "2045": "28273",
    "2046": "29849",
    "2047": "31490",
    "2048": "33053",
    "2049": "33921",
    "2050": "34822"
  },
  {
    "Age": "65-69",
    "2022": "10112",
    "2023": "10700",
    "2024": "11610",
    "2025": "12301",
    "2026": "13075",
    "2027": "13710",
    "2028": "14349",
    "2029": "14802",
    "2030": "15210",
    "2031": "15452",
    "2032": "15401",
    "2033": "15240",
    "2034": "15030",
    "2035": "14752",
    "2036": "14711",
    "2037": "15041",
    "2038": "15176",
    "2039": "15248",
    "2040": "15821",
    "2041": "16402",
    "2042": "16989",
    "2043": "17801",
    "2044": "19061",
    "2045": "20133",
    "2046": "21243",
    "2047": "22162",
    "2048": "23418",
    "2049": "24527",
    "2050": "25681"
  },
  {
    "Age": "70-74",
    "2022": "4641",
    "2023": "5466",
    "2024": "6076",
    "2025": "6858",
    "2026": "7451",
    "2027": "8245",
    "2028": "8734",
    "2029": "9498",
    "2030": "10079",
    "2031": "10738",
    "2032": "11286",
    "2033": "11837",
    "2034": "12243",
    "2035": "12612",
    "2036": "12852",
    "2037": "12843",
    "2038": "12744",
    "2039": "12610",
    "2040": "12414",
    "2041": "12426",
    "2042": "12754",
    "2043": "12902",
    "2044": "12993",
    "2045": "13522",
    "2046": "14062",
    "2047": "14611",
    "2048": "15339",
    "2049": "16459",
    "2050": "17417"
  },
  {
    "Age": "75-79",
    "2022": "1828",
    "2023": "1910",
    "2024": "2220",
    "2025": "2516",
    "2026": "3006",
    "2027": "3412",
    "2028": "4025",
    "2029": "4478",
    "2030": "5062",
    "2031": "5518",
    "2032": "6128",
    "2033": "6513",
    "2034": "7115",
    "2035": "7578",
    "2036": "8110",
    "2037": "8564",
    "2038": "9015",
    "2039": "9367",
    "2040": "9687",
    "2041": "9915",
    "2042": "9947",
    "2043": "9906",
    "2044": "9848",
    "2045": "9737",
    "2046": "9801",
    "2047": "10115",
    "2048": "10266",
    "2049": "10370",
    "2050": "10832"
  },
  {
    "Age": "80-84",
    "2022": "1375",
    "2023": "1309",
    "2024": "1169",
    "2025": "1045",
    "2026": "1109",
    "2027": "1135",
    "2028": "1195",
    "2029": "1397",
    "2030": "1583",
    "2031": "1904",
    "2032": "2165",
    "2033": "2567",
    "2034": "2867",
    "2035": "3254",
    "2036": "3571",
    "2037": "3991",
    "2038": "4268",
    "2039": "4696",
    "2040": "5032",
    "2041": "5421",
    "2042": "5764",
    "2043": "6099",
    "2044": "6381",
    "2045": "6637",
    "2046": "6837",
    "2047": "6896",
    "2048": "6903",
    "2049": "6906",
    "2050": "6866"
  },
  {
    "Age": "85+",
    "2022": "995",
    "2023": "992",
    "2024": "1015",
    "2025": "1033",
    "2026": "934",
    "2027": "919",
    "2028": "891",
    "2029": "840",
    "2030": "800",
    "2031": "800",
    "2032": "825",
    "2033": "860",
    "2034": "959",
    "2035": "1050",
    "2036": "1237",
    "2037": "1398",
    "2038": "1642",
    "2039": "1860",
    "2040": "2121",
    "2041": "2394",
    "2042": "2713",
    "2043": "2994",
    "2044": "3351",
    "2045": "3678",
    "2046": "4048",
    "2047": "4418",
    "2048": "4761",
    "2049": "5121",
    "2050": "5448"
  }
]

# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_city_region, gender='ayol').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_city_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='ayol',
                    population=population
                )

print("Navoi female data import completed successfully!")
