import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_city_region, _ = Region.objects.get_or_create(name='Sirdaryo', defaults={'svg_id': 'sirdarya'})

# Data to be imported
navoi_male_data = [
  {
    "Age": "Total",
    "2022": "878590",
    "2023": "896001",
    "2024": "913294",
    "2025": "930284",
    "2026": "946976",
    "2027": "963300",
    "2028": "979186",
    "2029": "994655",
    "2030": "1009609",
    "2031": "1023994",
    "2032": "1037740",
    "2033": "1050827",
    "2034": "1063253",
    "2035": "1074949",
    "2036": "1086010",
    "2037": "1096449",
    "2038": "1106383",
    "2039": "1115873",
    "2040": "1125026",
    "2041": "1133975",
    "2042": "1142889",
    "2043": "1151878",
    "2044": "1160990",
    "2045": "1170260",
    "2046": "1179735",
    "2047": "1189403",
    "2048": "1199234",
    "2049": "1209213",
    "2050": "1219276"
  },
  {
    "Age": "0-4",
    "2022": "98235",
    "2023": "103898",
    "2024": "109010",
    "2025": "111476",
    "2026": "113233",
    "2027": "112953",
    "2028": "112422",
    "2029": "111525",
    "2030": "110377",
    "2031": "108928",
    "2032": "107188",
    "2033": "105208",
    "2034": "102960",
    "2035": "100479",
    "2036": "97919",
    "2037": "95367",
    "2038": "92965",
    "2039": "90788",
    "2040": "89002",
    "2041": "87646",
    "2042": "86865",
    "2043": "86654",
    "2044": "86994",
    "2045": "87813",
    "2046": "89032",
    "2047": "90475",
    "2048": "92009",
    "2049": "93566",
    "2050": "95067"
  },
  {
    "Age": "5-9",
    "2022": "83063",
    "2023": "84202",
    "2024": "85449",
    "2025": "88530",
    "2026": "91729",
    "2027": "97160",
    "2028": "102629",
    "2029": "107590",
    "2030": "109975",
    "2031": "111710",
    "2032": "111456",
    "2033": "110977",
    "2034": "110144",
    "2035": "109071",
    "2036": "107707",
    "2037": "106062",
    "2038": "104184",
    "2039": "102047",
    "2040": "99684",
    "2041": "97246",
    "2042": "94815",
    "2043": "92530",
    "2044": "90462",
    "2045": "88773",
    "2046": "87497",
    "2047": "86778",
    "2048": "86607",
    "2049": "86969",
    "2050": "87794"
  },
  {
    "Age": "10-14",
    "2022": "80180",
    "2023": "79897",
    "2024": "79412",
    "2025": "79717",
    "2026": "80953",
    "2027": "82440",
    "2028": "83545",
    "2029": "84748",
    "2030": "87755",
    "2031": "90851",
    "2032": "96148",
    "2033": "101479",
    "2034": "106335",
    "2035": "108666",
    "2036": "110391",
    "2037": "110162",
    "2038": "109728",
    "2039": "108949",
    "2040": "107938",
    "2041": "106646",
    "2042": "105081",
    "2043": "103293",
    "2044": "101253",
    "2045": "98991",
    "2046": "96654",
    "2047": "94321",
    "2048": "92128",
    "2049": "90141",
    "2050": "88520"
  },
  {
    "Age": "15-19",
    "2022": "69506",
    "2023": "70864",
    "2024": "74285",
    "2025": "76915",
    "2026": "79053",
    "2027": "79394",
    "2028": "79103",
    "2029": "78631",
    "2030": "78946",
    "2031": "80174",
    "2032": "81640",
    "2033": "82722",
    "2034": "83895",
    "2035": "86851",
    "2036": "89877",
    "2037": "95070",
    "2038": "100277",
    "2039": "105024",
    "2040": "107294",
    "2041": "109001",
    "2042": "108797",
    "2043": "108414",
    "2044": "107695",
    "2045": "106752",
    "2046": "105533",
    "2047": "104047",
    "2048": "102340",
    "2049": "100383",
    "2050": "98206"
  },
  {
    "Age": "20-24",
    "2022": "68344",
    "2023": "68372",
    "2024": "67766",
    "2025": "68119",
    "2026": "68306",
    "2027": "69896",
    "2028": "71196",
    "2029": "74458",
    "2030": "76888",
    "2031": "78867",
    "2032": "79155",
    "2033": "78929",
    "2034": "78576",
    "2035": "78973",
    "2036": "80188",
    "2037": "81580",
    "2038": "82596",
    "2039": "83716",
    "2040": "86600",
    "2041": "89490",
    "2042": "94424",
    "2043": "99291",
    "2044": "103745",
    "2045": "105856",
    "2046": "107531",
    "2047": "107412",
    "2048": "107166",
    "2049": "106593",
    "2050": "105805"
  },
  {
    "Age": "25-29",
    "2022": "80120",
    "2023": "77373",
    "2024": "74545",
    "2025": "72492",
    "2026": "70889",
    "2027": "69556",
    "2028": "69711",
    "2029": "69216",
    "2030": "69654",
    "2031": "69868",
    "2032": "71410",
    "2033": "72568",
    "2034": "75599",
    "2035": "77823",
    "2036": "79713",
    "2037": "80042",
    "2038": "79923",
    "2039": "79663",
    "2040": "80084",
    "2041": "81266",
    "2042": "82636",
    "2043": "83664",
    "2044": "84759",
    "2045": "87512",
    "2046": "90161",
    "2047": "94746",
    "2048": "99245",
    "2049": "103430",
    "2050": "105413"
  },
  {
    "Age": "30-34",
    "2022": "87757",
    "2023": "86820",
    "2024": "86008",
    "2025": "83595",
    "2026": "81913",
    "2027": "79051",
    "2028": "76634",
    "2029": "74124",
    "2030": "72341",
    "2031": "70961",
    "2032": "69786",
    "2033": "70030",
    "2034": "69607",
    "2035": "70090",
    "2036": "70309",
    "2037": "71802",
    "2038": "72863",
    "2039": "75739",
    "2040": "77833",
    "2041": "79674",
    "2042": "80049",
    "2043": "80029",
    "2044": "79869",
    "2045": "80346",
    "2046": "81540",
    "2047": "82913",
    "2048": "83948",
    "2049": "85008",
    "2050": "87646"
  },
  {
    "Age": "35-39",
    "2022": "76226",
    "2023": "80288",
    "2024": "82620",
    "2025": "84723",
    "2026": "84790",
    "2027": "84955",
    "2028": "84085",
    "2029": "83413",
    "2030": "81214",
    "2031": "79774",
    "2032": "77189",
    "2033": "75050",
    "2034": "72795",
    "2035": "71220",
    "2036": "70009",
    "2037": "68955",
    "2038": "69265",
    "2039": "68898",
    "2040": "69421",
    "2041": "69656",
    "2042": "71131",
    "2043": "72142",
    "2044": "74924",
    "2045": "76940",
    "2046": "78760",
    "2047": "79181",
    "2048": "79240",
    "2049": "79150",
    "2050": "79653"
  },
  {
    "Age": "40-44",
    "2022": "57082",
    "2023": "60193",
    "2024": "62937",
    "2025": "66177",
    "2026": "69777",
    "2027": "73792",
    "2028": "77602",
    "2029": "79778",
    "2030": "81807",
    "2031": "81885",
    "2032": "82105",
    "2033": "81327",
    "2034": "80781",
    "2035": "78756",
    "2036": "77495",
    "2037": "75111",
    "2038": "73169",
    "2039": "71097",
    "2040": "69674",
    "2041": "68591",
    "2042": "67634",
    "2043": "68004",
    "2044": "67696",
    "2045": "68266",
    "2046": "68528",
    "2047": "69992",
    "2048": "70967",
    "2049": "73671",
    "2050": "75620"
  },
  {
    "Age": "45-49",
    "2022": "43799",
    "2023": "45155",
    "2024": "48064",
    "2025": "50585",
    "2026": "53159",
    "2027": "55539",
    "2028": "58480",
    "2029": "61065",
    "2030": "64132",
    "2031": "67547",
    "2032": "71366",
    "2033": "75009",
    "2034": "77087",
    "2035": "79068",
    "2036": "79167",
    "2037": "79435",
    "2038": "78735",
    "2039": "78287",
    "2040": "76400",
    "2041": "75276",
    "2042": "73056",
    "2043": "71275",
    "2044": "69356",
    "2045": "68061",
    "2046": "67086",
    "2047": "66213",
    "2048": "66631",
    "2049": "66366",
    "2050": "66960"
  },
  {
    "Age": "50-54",
    "2022": "36288",
    "2023": "37421",
    "2024": "38458",
    "2025": "40152",
    "2026": "41394",
    "2027": "42449",
    "2028": "43726",
    "2029": "46496",
    "2030": "48883",
    "2031": "51333",
    "2032": "53595",
    "2033": "56402",
    "2034": "58868",
    "2035": "61798",
    "2036": "65062",
    "2037": "68715",
    "2038": "72213",
    "2039": "74209",
    "2040": "76147",
    "2041": "76270",
    "2042": "76591",
    "2043": "75975",
    "2044": "75621",
    "2045": "73872",
    "2046": "72874",
    "2047": "70807",
    "2048": "69168",
    "2049": "67383",
    "2050": "66194"
  },
  {
    "Age": "55-59",
    "2022": "34719",
    "2023": "34373",
    "2024": "33688",
    "2025": "33024",
    "2026": "33475",
    "2027": "34683",
    "2028": "35755",
    "2029": "36723",
    "2030": "38320",
    "2031": "39505",
    "2032": "40524",
    "2033": "41740",
    "2034": "44368",
    "2035": "46624",
    "2036": "48953",
    "2037": "51095",
    "2038": "53758",
    "2039": "56106",
    "2040": "58894",
    "2041": "62005",
    "2042": "65484",
    "2043": "68827",
    "2044": "70741",
    "2045": "72634",
    "2046": "72794",
    "2047": "73173",
    "2048": "72651",
    "2049": "72387",
    "2050": "70779"
  },
  {
    "Age": "60-64",
    "2022": "29248",
    "2023": "30384",
    "2024": "31191",
    "2025": "31793",
    "2026": "31997",
    "2027": "31788",
    "2028": "31520",
    "2029": "30952",
    "2030": "30397",
    "2031": "30863",
    "2032": "32013",
    "2033": "33016",
    "2034": "33904",
    "2035": "35384",
    "2036": "36509",
    "2037": "37492",
    "2038": "38643",
    "2039": "41100",
    "2040": "43203",
    "2041": "45388",
    "2042": "47392",
    "2043": "49885",
    "2044": "52100",
    "2045": "54725",
    "2046": "57660",
    "2047": "60930",
    "2048": "64077",
    "2049": "65886",
    "2050": "67706"
  },
  {
    "Age": "65-69",
    "2022": "18503",
    "2023": "19732",
    "2024": "21376",
    "2025": "22767",
    "2026": "24201",
    "2027": "25268",
    "2028": "26261",
    "2029": "26986",
    "2030": "27548",
    "2031": "27780",
    "2032": "27654",
    "2033": "27478",
    "2034": "27046",
    "2035": "26621",
    "2036": "27102",
    "2037": "28178",
    "2038": "29103",
    "2039": "29910",
    "2040": "31257",
    "2041": "32313",
    "2042": "33257",
    "2043": "34334",
    "2044": "36584",
    "2045": "38511",
    "2046": "40527",
    "2047": "42371",
    "2048": "44657",
    "2049": "46708",
    "2050": "49124"
  },
  {
    "Age": "70-74",
    "2022": "8496",
    "2023": "9842",
    "2024": "10928",
    "2025": "12368",
    "2026": "13375",
    "2027": "14886",
    "2028": "15895",
    "2029": "17255",
    "2030": "18408",
    "2031": "19611",
    "2032": "20531",
    "2033": "21388",
    "2034": "22041",
    "2035": "22566",
    "2036": "22831",
    "2037": "22797",
    "2038": "22721",
    "2039": "22437",
    "2040": "22152",
    "2041": "22639",
    "2042": "23625",
    "2043": "24464",
    "2044": "25187",
    "2045": "26381",
    "2046": "27354",
    "2047": "28244",
    "2048": "29230",
    "2049": "31229",
    "2050": "32942"
  },
  {
    "Age": "75-79",
    "2022": "3172",
    "2023": "3411",
    "2024": "3988",
    "2025": "4488",
    "2026": "5414",
    "2027": "6114",
    "2028": "7108",
    "2029": "7905",
    "2030": "8958",
    "2031": "9729",
    "2032": "10873",
    "2033": "11653",
    "2034": "12704",
    "2035": "13605",
    "2036": "14559",
    "2037": "15319",
    "2038": "16023",
    "2039": "16589",
    "2040": "17059",
    "2041": "17340",
    "2042": "17389",
    "2043": "17404",
    "2044": "17265",
    "2045": "17121",
    "2046": "17601",
    "2047": "18469",
    "2048": "19196",
    "2049": "19808",
    "2050": "20804"
  },
  {
    "Age": "80-84",
    "2022": "2293",
    "2023": "2218",
    "2024": "1993",
    "2025": "1769",
    "2026": "1864",
    "2027": "1913",
    "2028": "2080",
    "2029": "2443",
    "2030": "2741",
    "2031": "3333",
    "2032": "3776",
    "2033": "4422",
    "2034": "4941",
    "2035": "5621",
    "2036": "6153",
    "2037": "6926",
    "2038": "7472",
    "2039": "8203",
    "2040": "8840",
    "2041": "9523",
    "2042": "10094",
    "2043": "10620",
    "2044": "11071",
    "2045": "11458",
    "2046": "11727",
    "2047": "11833",
    "2048": "11910",
    "2049": "11889",
    "2050": "11860"
  },
  {
    "Age": "85+",
    "2022": "1559",
    "2023": "1559",
    "2024": "1578",
    "2025": "1595",
    "2026": "1456",
    "2027": "1462",
    "2028": "1434",
    "2029": "1347",
    "2030": "1267",
    "2031": "1274",
    "2032": "1332",
    "2033": "1431",
    "2034": "1600",
    "2035": "1733",
    "2036": "2068",
    "2037": "2340",
    "2038": "2745",
    "2039": "3111",
    "2040": "3545",
    "2041": "4006",
    "2042": "4569",
    "2043": "5074",
    "2044": "5669",
    "2045": "6247",
    "2046": "6876",
    "2047": "7500",
    "2048": "8065",
    "2049": "8647",
    "2050": "9182"
  }
]
# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_city_region, gender='jami').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_city_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='jami',
                    population=population
                )

print("Navoi female data import completed successfully!")
