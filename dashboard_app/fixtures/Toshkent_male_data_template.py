import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_region, _ = Region.objects.get_or_create(name='Toshkent', defaults={'svg_id': 'tashkent'})

# Data to be imported
navoi_male_data =[
  {
    "Age": "Total",
    "2022": "1474780",
    "2023": "1497747",
    "2024": "1520061",
    "2025": "1541515",
    "2026": "1562205",
    "2027": "1582109",
    "2028": "1601199",
    "2029": "1619614",
    "2030": "1637264",
    "2031": "1654096",
    "2032": "1670007",
    "2033": "1684957",
    "2034": "1698922",
    "2035": "1711823",
    "2036": "1723782",
    "2037": "1734788",
    "2038": "1745010",
    "2039": "1754532",
    "2040": "1763497",
    "2041": "1772105",
    "2042": "1780612",
    "2043": "1789197",
    "2044": "1797933",
    "2045": "1806875",
    "2046": "1816113",
    "2047": "1825617",
    "2048": "1835365",
    "2049": "1845321",
    "2050": "1855405"
  },
  {
    "Age": "0-4",
    "2022": "154409",
    "2023": "163372",
    "2024": "169587",
    "2025": "173132",
    "2026": "175223",
    "2027": "174267",
    "2028": "172832",
    "2029": "171079",
    "2030": "169163",
    "2031": "166987",
    "2032": "164521",
    "2033": "161764",
    "2034": "158590",
    "2035": "154993",
    "2036": "151180",
    "2037": "147270",
    "2038": "143489",
    "2039": "139958",
    "2040": "136935",
    "2041": "134486",
    "2042": "132854",
    "2043": "132053",
    "2044": "132077",
    "2045": "132833",
    "2046": "134212",
    "2047": "135952",
    "2048": "137850",
    "2049": "139802",
    "2050": "141687"
  },
  {
    "Age": "5-9",
    "2022": "137590",
    "2023": "137441",
    "2024": "139131",
    "2025": "141906",
    "2026": "145380",
    "2027": "152395",
    "2028": "160986",
    "2029": "166918",
    "2030": "170294",
    "2031": "172319",
    "2032": "171391",
    "2033": "170037",
    "2034": "168383",
    "2035": "166582",
    "2036": "164536",
    "2037": "162212",
    "2038": "159611",
    "2039": "156608",
    "2040": "153196",
    "2041": "149577",
    "2042": "145862",
    "2043": "142273",
    "2044": "138921",
    "2045": "136058",
    "2046": "133744",
    "2047": "132217",
    "2048": "131489",
    "2049": "131554",
    "2050": "132324"
  },
  {
    "Age": "10-14",
    "2022": "134543",
    "2023": "134677",
    "2024": "134584",
    "2025": "133843",
    "2026": "135152",
    "2027": "136125",
    "2028": "135922",
    "2029": "137535",
    "2030": "140196",
    "2031": "143510",
    "2032": "150291",
    "2033": "158628",
    "2034": "164376",
    "2035": "167657",
    "2036": "169663",
    "2037": "168784",
    "2038": "167512",
    "2039": "165950",
    "2040": "164248",
    "2041": "162309",
    "2042": "160102",
    "2043": "157630",
    "2044": "154769",
    "2045": "151510",
    "2046": "148051",
    "2047": "144497",
    "2048": "141063",
    "2049": "137856",
    "2050": "135120"
  },
  {
    "Age": "15-19",
    "2022": "108114",
    "2023": "112647",
    "2024": "118823",
    "2025": "124679",
    "2026": "129626",
    "2027": "132787",
    "2028": "132847",
    "2029": "132734",
    "2030": "131994",
    "2031": "133286",
    "2032": "134241",
    "2033": "134030",
    "2034": "135610",
    "2035": "138213",
    "2036": "141433",
    "2037": "148045",
    "2038": "156170",
    "2039": "161755",
    "2040": "164948",
    "2041": "166928",
    "2042": "166092",
    "2043": "164898",
    "2044": "163424",
    "2045": "161817",
    "2046": "159980",
    "2047": "157884",
    "2048": "155529",
    "2049": "152795",
    "2050": "149671"
  },
  {
    "Age": "20-24",
    "2022": "106200",
    "2023": "103100",
    "2024": "101444",
    "2025": "103248",
    "2026": "104656",
    "2027": "107266",
    "2028": "111567",
    "2029": "117457",
    "2030": "123026",
    "2031": "127718",
    "2032": "130711",
    "2033": "130730",
    "2034": "130654",
    "2035": "129974",
    "2036": "131281",
    "2037": "132231",
    "2038": "132021",
    "2039": "133574",
    "2040": "136117",
    "2041": "139226",
    "2042": "145605",
    "2043": "153425",
    "2044": "158773",
    "2045": "161838",
    "2046": "163785",
    "2047": "163017",
    "2048": "161940",
    "2049": "160595",
    "2050": "159123"
  },
  {
    "Age": "25-29",
    "2022": "127835",
    "2023": "124732",
    "2024": "121100",
    "2025": "116585",
    "2026": "110526",
    "2027": "105726",
    "2028": "102850",
    "2029": "101290",
    "2030": "103047",
    "2031": "104346",
    "2032": "106788",
    "2033": "110822",
    "2034": "116364",
    "2035": "121585",
    "2036": "125984",
    "2037": "128814",
    "2038": "128827",
    "2039": "128826",
    "2040": "128221",
    "2041": "129539",
    "2042": "130488",
    "2043": "130299",
    "2044": "131833",
    "2045": "134302",
    "2046": "137252",
    "2047": "143321",
    "2048": "150757",
    "2049": "155820",
    "2050": "158739"
  },
  {
    "Age": "30-34",
    "2022": "138660",
    "2023": "136788",
    "2024": "133803",
    "2025": "130277",
    "2026": "128066",
    "2027": "125076",
    "2028": "122159",
    "2029": "118783",
    "2030": "114624",
    "2031": "109001",
    "2032": "104589",
    "2033": "101982",
    "2034": "100543",
    "2035": "102274",
    "2036": "103489",
    "2037": "105782",
    "2038": "109560",
    "2039": "114766",
    "2040": "119659",
    "2041": "123798",
    "2042": "126500",
    "2043": "126530",
    "2044": "126609",
    "2045": "126081",
    "2046": "127419",
    "2047": "128390",
    "2048": "128243",
    "2049": "129759",
    "2050": "132141"
  },
  {
    "Age": "35-39",
    "2022": "120113",
    "2023": "125650",
    "2024": "130090",
    "2025": "132884",
    "2026": "134262",
    "2027": "133774",
    "2028": "131949",
    "2029": "129138",
    "2030": "125841",
    "2031": "123846",
    "2032": "121097",
    "2033": "118451",
    "2034": "115388",
    "2035": "111619",
    "2036": "106444",
    "2037": "102416",
    "2038": "100070",
    "2039": "98753",
    "2040": "100462",
    "2041": "101607",
    "2042": "103774",
    "2043": "107326",
    "2044": "112233",
    "2045": "116838",
    "2046": "120755",
    "2047": "123359",
    "2048": "123424",
    "2049": "123587",
    "2050": "123132"
  },
  {
    "Age": "40-44",
    "2022": "94056",
    "2023": "98344",
    "2024": "100770",
    "2025": "105141",
    "2026": "110085",
    "2027": "115826",
    "2028": "120924",
    "2029": "125031",
    "2030": "127623",
    "2031": "128924",
    "2032": "128490",
    "2033": "126829",
    "2034": "124259",
    "2035": "121218",
    "2036": "119442",
    "2037": "116921",
    "2038": "114523",
    "2039": "111739",
    "2040": "108300",
    "2041": "103491",
    "2042": "99766",
    "2043": "97625",
    "2044": "96407",
    "2045": "98101",
    "2046": "99203",
    "2047": "101278",
    "2048": "104657",
    "2049": "109328",
    "2050": "113711"
  },
  {
    "Age": "45-49",
    "2022": "80422",
    "2023": "80888",
    "2024": "84021",
    "2025": "86606",
    "2026": "88505",
    "2027": "90866",
    "2028": "94899",
    "2029": "97125",
    "2030": "101240",
    "2031": "105887",
    "2032": "111311",
    "2033": "116131",
    "2034": "120032",
    "2035": "122516",
    "2036": "123802",
    "2037": "123454",
    "2038": "121956",
    "2039": "119599",
    "2040": "116780",
    "2041": "115192",
    "2042": "112870",
    "2043": "110681",
    "2044": "108121",
    "2045": "104945",
    "2046": "100442",
    "2047": "96975",
    "2048": "95015",
    "2049": "93892",
    "2050": "95581"
  },
  {
    "Age": "50-54",
    "2022": "70877",
    "2023": "72316",
    "2024": "73400",
    "2025": "74934",
    "2026": "76791",
    "2027": "77054",
    "2028": "77462",
    "2029": "80431",
    "2030": "82865",
    "2031": "84661",
    "2032": "86894",
    "2033": "90735",
    "2034": "92833",
    "2035": "96754",
    "2036": "101165",
    "2037": "106327",
    "2038": "110918",
    "2039": "114648",
    "2040": "117044",
    "2041": "118325",
    "2042": "118066",
    "2043": "116730",
    "2044": "114577",
    "2045": "111976",
    "2046": "110573",
    "2047": "108448",
    "2048": "106458",
    "2049": "104104",
    "2050": "101165"
  },
  {
    "Age": "55-59",
    "2022": "67472",
    "2023": "66409",
    "2024": "65300",
    "2025": "64192",
    "2026": "64668",
    "2027": "66734",
    "2028": "68072",
    "2029": "69081",
    "2030": "70511",
    "2031": "72281",
    "2032": "72576",
    "2033": "72983",
    "2034": "75813",
    "2035": "78120",
    "2036": "79845",
    "2037": "81973",
    "2038": "85619",
    "2039": "87613",
    "2040": "91339",
    "2041": "95511",
    "2042": "100399",
    "2043": "104750",
    "2044": "108295",
    "2045": "110603",
    "2046": "111884",
    "2047": "111732",
    "2048": "110575",
    "2049": "108642",
    "2050": "106281"
  },
  {
    "Age": "60-64",
    "2022": "57153",
    "2023": "59232",
    "2024": "60409",
    "2025": "61492",
    "2026": "61595",
    "2027": "60911",
    "2028": "60005",
    "2029": "59083",
    "2030": "58154",
    "2031": "58657",
    "2032": "60617",
    "2033": "61881",
    "2034": "62840",
    "2035": "64179",
    "2036": "65869",
    "2037": "66237",
    "2038": "66670",
    "2039": "69342",
    "2040": "71500",
    "2041": "73148",
    "2042": "75157",
    "2043": "78560",
    "2044": "80444",
    "2045": "83938",
    "2046": "87830",
    "2047": "92388",
    "2048": "96449",
    "2049": "99762",
    "2050": "101955"
  },
  {
    "Age": "65-69",
    "2022": "37219",
    "2023": "39157",
    "2024": "42267",
    "2025": "44374",
    "2026": "46259",
    "2027": "48685",
    "2028": "50487",
    "2029": "51547",
    "2030": "52536",
    "2031": "52692",
    "2032": "52209",
    "2033": "51549",
    "2034": "50885",
    "2035": "50202",
    "2036": "50758",
    "2037": "52604",
    "2038": "53804",
    "2039": "54728",
    "2040": "55977",
    "2041": "57574",
    "2042": "58025",
    "2043": "58493",
    "2044": "60970",
    "2045": "62966",
    "2046": "64530",
    "2047": "66406",
    "2048": "69525",
    "2049": "71289",
    "2050": "74504"
  },
  {
    "Age": "70-74",
    "2022": "22152",
    "2023": "23871",
    "2024": "25116",
    "2025": "26553",
    "2026": "27876",
    "2027": "29702",
    "2028": "31307",
    "2029": "33862",
    "2030": "35608",
    "2031": "37195",
    "2032": "39246",
    "2033": "40804",
    "2034": "41781",
    "2035": "42702",
    "2036": "42936",
    "2037": "42675",
    "2038": "42274",
    "2039": "41877",
    "2040": "41444",
    "2041": "42038",
    "2042": "43737",
    "2043": "44857",
    "2044": "45735",
    "2045": "46876",
    "2046": "48351",
    "2047": "48879",
    "2048": "49378",
    "2049": "51620",
    "2050": "53420"
  },
  {
    "Age": "75-79",
    "2022": "9690",
    "2023": "10229",
    "2024": "11336",
    "2025": "13005",
    "2026": "14822",
    "2027": "15768",
    "2028": "17066",
    "2029": "17982",
    "2030": "19090",
    "2031": "20153",
    "2032": "21553",
    "2033": "22838",
    "2034": "24820",
    "2035": "26204",
    "2036": "27488",
    "2037": "29143",
    "2038": "30437",
    "2039": "31319",
    "2040": "32138",
    "2041": "32424",
    "2042": "32370",
    "2043": "32213",
    "2044": "32066",
    "2045": "31877",
    "2046": "32489",
    "2047": "33998",
    "2048": "35002",
    "2049": "35800",
    "2050": "36789"
  },
  {
    "Age": "80-84",
    "2022": "6203",
    "2023": "6700",
    "2024": "6485",
    "2025": "6095",
    "2026": "5864",
    "2027": "5706",
    "2028": "6143",
    "2029": "6852",
    "2030": "7885",
    "2031": "9035",
    "2032": "9644",
    "2033": "10529",
    "2034": "11147",
    "2035": "11931",
    "2036": "12718",
    "2037": "13695",
    "2038": "14640",
    "2039": "16036",
    "2040": "17037",
    "2041": "17988",
    "2042": "19205",
    "2043": "20192",
    "2044": "20922",
    "2045": "21595",
    "2046": "21899",
    "2047": "22002",
    "2048": "22035",
    "2049": "22083",
    "2050": "22087"
  },
  {
    "Age": "85+",
    "2022": "2072",
    "2023": "2195",
    "2024": "2394",
    "2025": "2570",
    "2026": "2847",
    "2027": "3440",
    "2028": "3721",
    "2029": "3686",
    "2030": "3565",
    "2031": "3596",
    "2032": "3839",
    "2033": "4234",
    "2034": "4603",
    "2035": "5102",
    "2036": "5748",
    "2037": "6205",
    "2038": "6909",
    "2039": "7443",
    "2040": "8150",
    "2041": "8943",
    "2042": "9738",
    "2043": "10664",
    "2044": "11759",
    "2045": "12721",
    "2046": "13713",
    "2047": "14874",
    "2048": "15977",
    "2049": "17033",
    "2050": "17977"
  }
]
# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_region, gender='erkak').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='erkak',
                    population=population
                )

print("Navoi male data import completed successfully!")
