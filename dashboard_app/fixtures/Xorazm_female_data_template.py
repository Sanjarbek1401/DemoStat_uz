import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_city_region, _ = Region.objects.get_or_create(name='Xorazm', defaults={'svg_id': 'khorezm'})

# Data to be imported
navoi_male_data = [
  {
    "2021": "961673",
    "2022": "979377",
    "2023": "997065",
    "2024": "1014533",
    "2025": "1031772",
    "2026": "1048704",
    "2027": "1065252",
    "2028": "1081447",
    "2029": "1097220",
    "2030": "1112514",
    "2031": "1127242",
    "2032": "1141352",
    "2033": "1154826",
    "2034": "1167583",
    "2035": "1179713",
    "2036": "1191228",
    "2037": "1202220",
    "2038": "1212719",
    "2039": "1222783",
    "2040": "1232511",
    "2041": "1242036",
    "2042": "1251448",
    "2043": "1260796",
    "2044": "1270125",
    "2045": "1279495",
    "2046": "1288916",
    "2047": "1298377",
    "2048": "1307876",
    "2049": "1317370",
    "2050": "1326814",
    "Age": "Total"
  },
  {
    "2021": "95840",
    "2022": "100477",
    "2023": "104077",
    "2024": "106959",
    "2025": "109101",
    "2026": "111124",
    "2027": "110674",
    "2028": "109893",
    "2029": "108918",
    "2030": "107709",
    "2031": "106254",
    "2032": "104580",
    "2033": "102630",
    "2034": "100404",
    "2035": "98049",
    "2036": "95662",
    "2037": "93389",
    "2038": "91283",
    "2039": "89479",
    "2040": "87978",
    "2041": "86897",
    "2042": "86234",
    "2043": "86003",
    "2044": "86183",
    "2045": "86746",
    "2046": "87570",
    "2047": "88552",
    "2048": "89640",
    "2049": "90759",
    "2050": "91793",
    "Age": "0-4"
  },
  {
    "2021": "90421",
    "2022": "91513",
    "2023": "92271",
    "2024": "92562",
    "2025": "93960",
    "2026": "95409",
    "2027": "99993",
    "2028": "103547",
    "2029": "106400",
    "2030": "108527",
    "2031": "110549",
    "2032": "110120",
    "2033": "109371",
    "2034": "108431",
    "2035": "107259",
    "2036": "105844",
    "2037": "104213",
    "2038": "102310",
    "2039": "100132",
    "2040": "97827",
    "2041": "95491",
    "2042": "93266",
    "2043": "91206",
    "2044": "89443",
    "2045": "87979",
    "2046": "86929",
    "2047": "86289",
    "2048": "86075",
    "2049": "86264",
    "2050": "86831",
    "Age": "5-9"
  },
  {
    "2021": "86462",
    "2022": "85606",
    "2023": "86741",
    "2024": "86834",
    "2025": "88314",
    "2026": "90085",
    "2027": "91170",
    "2028": "91929",
    "2029": "92222",
    "2030": "93617",
    "2031": "95052",
    "2032": "99602",
    "2033": "103124",
    "2034": "105957",
    "2035": "108071",
    "2036": "110091",
    "2037": "109677",
    "2038": "108951",
    "2039": "108038",
    "2040": "106894",
    "2041": "105510",
    "2042": "103914",
    "2043": "102048",
    "2044": "99911",
    "2045": "97648",
    "2046": "95352",
    "2047": "93165",
    "2048": "91139",
    "2049": "89407",
    "2050": "87967",
    "Age": "10-14"
  },
  {
    "2021": "73982",
    "2022": "76605",
    "2023": "79644",
    "2024": "83330",
    "2025": "85321",
    "2026": "86021",
    "2027": "85168",
    "2028": "86302",
    "2029": "86407",
    "2030": "87895",
    "2031": "89660",
    "2032": "90736",
    "2033": "91492",
    "2034": "91793",
    "2035": "93193",
    "2036": "94620",
    "2037": "99139",
    "2038": "102628",
    "2039": "105438",
    "2040": "107537",
    "2041": "109546",
    "2042": "109142",
    "2043": "108443",
    "2044": "107559",
    "2045": "106446",
    "2046": "105097",
    "2047": "103535",
    "2048": "101705",
    "2049": "99604",
    "2050": "97377",
    "Age": "15-19"
  },
  {
    "2021": "74868",
    "2022": "73497",
    "2023": "72838",
    "2024": "72717",
    "2025": "72712",
    "2026": "74235",
    "2027": "76780",
    "2028": "79688",
    "2029": "83233",
    "2030": "85109",
    "2031": "85769",
    "2032": "84949",
    "2033": "86148",
    "2034": "86335",
    "2035": "87833",
    "2036": "89526",
    "2037": "90535",
    "2038": "91295",
    "2039": "91648",
    "2040": "93077",
    "2041": "94466",
    "2042": "98871",
    "2043": "102237",
    "2044": "104955",
    "2045": "106973",
    "2046": "108937",
    "2047": "108578",
    "2048": "107972",
    "2049": "107184",
    "2050": "106171",
    "Age": "20-24"
  },
  {
    "2021": "84170",
    "2022": "82284",
    "2023": "79221",
    "2024": "78077",
    "2025": "76872",
    "2026": "75607",
    "2027": "74410",
    "2028": "73895",
    "2029": "73872",
    "2030": "73909",
    "2031": "75381",
    "2032": "77792",
    "2033": "80524",
    "2034": "83896",
    "2035": "85694",
    "2036": "86402",
    "2037": "85667",
    "2038": "86895",
    "2039": "87069",
    "2040": "88524",
    "2041": "90184",
    "2042": "91208",
    "2043": "92009",
    "2044": "92390",
    "2045": "93812",
    "2046": "95129",
    "2047": "99372",
    "2048": "102576",
    "2049": "105184",
    "2050": "107131",
    "Age": "25-29"
  },
  {
    "2021": "84071",
    "2022": "84959",
    "2023": "85547",
    "2024": "86257",
    "2025": "85587",
    "2026": "83681",
    "2027": "81966",
    "2028": "79092",
    "2029": "78096",
    "2030": "77018",
    "2031": "75883",
    "2032": "74803",
    "2033": "74371",
    "2034": "74398",
    "2035": "74453",
    "2036": "75885",
    "2037": "78210",
    "2038": "80830",
    "2039": "84094",
    "2040": "85847",
    "2041": "86583",
    "2042": "85900",
    "2043": "87150",
    "2044": "87336",
    "2045": "88788",
    "2046": "90443",
    "2047": "91477",
    "2048": "92295",
    "2049": "92683",
    "2050": "94087",
    "Age": "30-34"
  },
  {
    "2021": "79204",
    "2022": "81185",
    "2023": "82606",
    "2024": "82327",
    "2025": "82470",
    "2026": "82912",
    "2027": "83785",
    "2028": "84375",
    "2029": "85116",
    "2030": "84531",
    "2031": "82752",
    "2032": "81180",
    "2033": "78453",
    "2034": "77564",
    "2035": "76573",
    "2036": "75524",
    "2037": "74523",
    "2038": "74146",
    "2039": "74209",
    "2040": "74278",
    "2041": "75684",
    "2042": "77952",
    "2043": "80498",
    "2044": "83693",
    "2045": "85421",
    "2046": "86185",
    "2047": "85549",
    "2048": "86815",
    "2049": "87005",
    "2050": "88439",
    "Age": "35-39"
  },
  {
    "2021": "65583",
    "2022": "67725",
    "2023": "70176",
    "2024": "72259",
    "2025": "75124",
    "2026": "77931",
    "2027": "79854",
    "2028": "81259",
    "2029": "81008",
    "2030": "81178",
    "2031": "81633",
    "2032": "82511",
    "2033": "83115",
    "2034": "83881",
    "2035": "83355",
    "2036": "81661",
    "2037": "80183",
    "2038": "77556",
    "2039": "76737",
    "2040": "75804",
    "2041": "74816",
    "2042": "73873",
    "2043": "73539",
    "2044": "73632",
    "2045": "73719",
    "2046": "75111",
    "2047": "77342",
    "2048": "79837",
    "2049": "82979",
    "2050": "84683",
    "Age": "40-44"
  },
  {
    "2021": "59043",
    "2022": "59768",
    "2023": "60231",
    "2024": "61906",
    "2025": "63164",
    "2026": "64508",
    "2027": "66599",
    "2028": "68994",
    "2029": "71029",
    "2030": "73835",
    "2031": "76589",
    "2032": "78482",
    "2033": "79883",
    "2034": "79658",
    "2035": "79852",
    "2036": "80322",
    "2037": "81206",
    "2038": "81820",
    "2039": "82599",
    "2040": "82116",
    "2041": "80489",
    "2042": "79087",
    "2043": "76543",
    "2044": "75781",
    "2045": "74901",
    "2046": "73963",
    "2047": "73068",
    "2048": "72765",
    "2049": "72879",
    "2050": "72976",
    "Age": "45-49"
  },
  {
    "2021": "46628",
    "2022": "49594",
    "2023": "52188",
    "2024": "54492",
    "2025": "56383",
    "2026": "57790",
    "2027": "58504",
    "2028": "58965",
    "2029": "60614",
    "2030": "61854",
    "2031": "63179",
    "2032": "65233",
    "2033": "67583",
    "2034": "69581",
    "2035": "72334",
    "2036": "75039",
    "2037": "76904",
    "2038": "78296",
    "2039": "78095",
    "2040": "78313",
    "2041": "78800",
    "2042": "79694",
    "2043": "80322",
    "2044": "81112",
    "2045": "80671",
    "2046": "79111",
    "2047": "77778",
    "2048": "75314",
    "2049": "74601",
    "2050": "73764",
    "Age": "50-54"
  },
  {
    "2021": "40622",
    "2022": "40589",
    "2023": "41096",
    "2024": "41861",
    "2025": "43210",
    "2026": "45211",
    "2027": "48075",
    "2028": "50581",
    "2029": "52806",
    "2030": "54641",
    "2031": "56020",
    "2032": "56733",
    "2033": "57201",
    "2034": "58826",
    "2035": "60050",
    "2036": "61358",
    "2037": "63369",
    "2038": "65665",
    "2039": "67622",
    "2040": "70314",
    "2041": "72959",
    "2042": "74789",
    "2043": "76169",
    "2044": "75998",
    "2045": "76249",
    "2046": "76765",
    "2047": "77673",
    "2048": "78315",
    "2049": "79106",
    "2050": "78702",
    "Age": "55-59"
  },
  {
    "2021": "34112",
    "2022": "35820",
    "2023": "37004",
    "2024": "37622",
    "2025": "38192",
    "2026": "38371",
    "2027": "38358",
    "2028": "38870",
    "2029": "39618",
    "2030": "40926",
    "2031": "42851",
    "2032": "45585",
    "2033": "47983",
    "2034": "50108",
    "2035": "51873",
    "2036": "53219",
    "2037": "53935",
    "2038": "54419",
    "2039": "56010",
    "2040": "57214",
    "2041": "58502",
    "2042": "60457",
    "2043": "62682",
    "2044": "64591",
    "2045": "67204",
    "2046": "69773",
    "2047": "71558",
    "2048": "72916",
    "2049": "72779",
    "2050": "73067",
    "Age": "60-64"
  },
  {
    "2021": "20998",
    "2022": "22428",
    "2023": "24560",
    "2024": "26673",
    "2025": "28750",
    "2026": "30856",
    "2027": "32411",
    "2028": "33511",
    "2029": "34101",
    "2030": "34661",
    "2031": "34882",
    "2032": "34915",
    "2033": "35445",
    "2034": "36181",
    "2035": "37440",
    "2036": "39270",
    "2037": "41829",
    "2038": "44084",
    "2039": "46075",
    "2040": "47748",
    "2041": "49050",
    "2042": "49771",
    "2043": "50281",
    "2044": "51826",
    "2045": "53008",
    "2046": "54271",
    "2047": "56150",
    "2048": "58276",
    "2049": "60114",
    "2050": "62609",
    "Age": "65-69"
  },
  {
    "2021": "13254",
    "2022": "14211",
    "2023": "15237",
    "2024": "16237",
    "2025": "16701",
    "2026": "17920",
    "2027": "19178",
    "2028": "21042",
    "2029": "22893",
    "2030": "24714",
    "2031": "26579",
    "2032": "27961",
    "2033": "28970",
    "2034": "29538",
    "2035": "30092",
    "2036": "30368",
    "2037": "30463",
    "2038": "31011",
    "2039": "31728",
    "2040": "32917",
    "2041": "34619",
    "2042": "36951",
    "2043": "39022",
    "2044": "40846",
    "2045": "42401",
    "2046": "43642",
    "2047": "44364",
    "2048": "44899",
    "2049": "46369",
    "2050": "47505",
    "Age": "70-74"
  },
  {
    "2021": "5550",
    "2022": "5916",
    "2023": "6555",
    "2024": "7667",
    "2025": "9295",
    "2026": "10266",
    "2027": "11039",
    "2028": "11843",
    "2029": "12649",
    "2030": "13078",
    "2031": "14096",
    "2032": "15151",
    "2033": "16693",
    "2034": "18230",
    "2035": "19743",
    "2036": "21314",
    "2037": "22485",
    "2038": "23376",
    "2039": "23906",
    "2040": "24437",
    "2041": "24762",
    "2042": "24916",
    "2043": "25469",
    "2044": "26148",
    "2045": "27237",
    "2046": "28763",
    "2047": "30794",
    "2048": "32616",
    "2049": "34205",
    "2050": "35585",
    "Age": "75-79"
  },
  {
    "2021": "4469",
    "2022": "4665",
    "2023": "4312",
    "2024": "3814",
    "2025": "3616",
    "2026": "3652",
    "2027": "3980",
    "2028": "4435",
    "2029": "5192",
    "2030": "6330",
    "2031": "7008",
    "2032": "7579",
    "2033": "8153",
    "2034": "8750",
    "2035": "9124",
    "2036": "9910",
    "2037": "10728",
    "2038": "11898",
    "2039": "13069",
    "2040": "14222",
    "2041": "15438",
    "2042": "16352",
    "2043": "17082",
    "2044": "17548",
    "2045": "18026",
    "2046": "18373",
    "2047": "18569",
    "2048": "19090",
    "2049": "19691",
    "2050": "20620",
    "Age": "80-84"
  },
  {
    "2021": "2396",
    "2022": "2535",
    "2023": "2760",
    "2024": "2937",
    "2025": "3000",
    "2026": "3124",
    "2027": "3308",
    "2028": "3227",
    "2029": "3044",
    "2030": "2983",
    "2031": "3105",
    "2032": "3439",
    "2033": "3686",
    "2034": "4052",
    "2035": "4725",
    "2036": "5214",
    "2037": "5765",
    "2038": "6256",
    "2039": "6835",
    "2040": "7465",
    "2041": "8239",
    "2042": "9072",
    "2043": "10094",
    "2044": "11172",
    "2045": "12267",
    "2046": "13500",
    "2047": "14563",
    "2048": "15632",
    "2049": "16556",
    "2050": "17506",
    "Age": "85+"
  }
]

# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_city_region, gender='ayol').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_city_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='ayol',
                    population=population
                )

print("Navoi female data import completed successfully!")
