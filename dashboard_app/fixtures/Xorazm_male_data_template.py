import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_region, _ = Region.objects.get_or_create(name='Xorazm', defaults={'svg_id': 'khorezm'})

# Data to be imported
navoi_male_data =[
  {
    "2021": "962489",
    "2022": "980574",
    "2023": "998554",
    "2024": "1016215",
    "2025": "1033564",
    "2026": "1050536",
    "2027": "1067062",
    "2028": "1083194",
    "2029": "1098857",
    "2030": "111399",
    "2031": "1128522",
    "2032": "1142393",
    "2033": "1155586",
    "2034": "1168031",
    "2035": "1179825",
    "2036": "1190978",
    "2037": "1201588",
    "2038": "1211697",
    "2039": "1221366",
    "2040": "1230698",
    "2041": "1239835",
    "2042": "1248874",
    "2043": "1257867",
    "2044": "1266864",
    "2045": "1275927",
    "2046": "1285069",
    "2047": "1294270",
    "2048": "1303536",
    "2049": "1312819",
    "2050": "1322066",
    "Age": "Total"
  },
  {
    "2021": "103398",
    "2022": "108018",
    "2023": "111262",
    "2024": "114012",
    "2025": "116083",
    "2026": "117675",
    "2027": "117198",
    "2028": "116369",
    "2029": "115337",
    "2030": "114057",
    "2031": "112517",
    "2032": "110747",
    "2033": "108685",
    "2034": "106331",
    "2035": "103841",
    "2036": "101317",
    "2037": "98912",
    "2038": "96685",
    "2039": "94778",
    "2040": "93191",
    "2041": "92050",
    "2042": "91350",
    "2043": "91108",
    "2044": "91302",
    "2045": "91902",
    "2046": "92779",
    "2047": "93823",
    "2048": "94981",
    "2049": "96172",
    "2050": "97272",
    "Age": "0-4"
  },
  {
    "2021": "96453",
    "2022": "97587",
    "2023": "98830",
    "2024": "99350",
    "2025": "100690",
    "2026": "102630",
    "2027": "107176",
    "2028": "110358",
    "2029": "113066",
    "2030": "115110",
    "2031": "116695",
    "2032": "116236",
    "2033": "115439",
    "2034": "114444",
    "2035": "113204",
    "2036": "111711",
    "2037": "109991",
    "2038": "107982",
    "2039": "105685",
    "2040": "103253",
    "2041": "100786",
    "2042": "98436",
    "2043": "96260",
    "2044": "94397",
    "2045": "92850",
    "2046": "91741",
    "2047": "91066",
    "2048": "90841",
    "2049": "91045",
    "2050": "91650",
    "Age": "5-9"
  },
  {
    "2021": "91099",
    "2022": "90502",
    "2023": "91815",
    "2024": "92307",
    "2025": "93946",
    "2026": "95857",
    "2027": "96966",
    "2028": "98192",
    "2029": "98701",
    "2030": "100027",
    "2031": "101939",
    "2032": "106442",
    "2033": "109586",
    "2034": "112271",
    "2035": "114302",
    "2036": "115887",
    "2037": "115445",
    "2038": "114675",
    "2039": "113710",
    "2040": "112503",
    "2041": "111045",
    "2042": "109363",
    "2043": "107396",
    "2044": "105143",
    "2045": "102756",
    "2046": "100334",
    "2047": "98028",
    "2048": "95891",
    "2049": "94064",
    "2050": "92546",
    "Age": "10-14"
  },
  {
    "2021": "76934",
    "2022": "79714",
    "2023": "82702",
    "2024": "86471",
    "2025": "89241",
    "2026": "90443",
    "2027": "89837",
    "2028": "91139",
    "2029": "91625",
    "2030": "93252",
    "2031": "95147",
    "2032": "96245",
    "2033": "97467",
    "2034": "97978",
    "2035": "99302",
    "2036": "101198",
    "2037": "105665",
    "2038": "108779",
    "2039": "111443",
    "2040": "113460",
    "2041": "115041",
    "2042": "114615",
    "2043": "113870",
    "2044": "112932",
    "2045": "111755",
    "2046": "110330",
    "2047": "108683",
    "2048": "106754",
    "2049": "104541",
    "2050": "102195",
    "Age": "15-19"
  },
  {
    "2021": "77122",
    "2022": "75962",
    "2023": "75530",
    "2024": "75186",
    "2025": "74897",
    "2026": "76376",
    "2027": "79104",
    "2028": "82029",
    "2029": "85731",
    "2030": "88445",
    "2031": "89627",
    "2032": "89028",
    "2033": "90333",
    "2034": "90825",
    "2035": "92445",
    "2036": "94320",
    "2037": "95404",
    "2038": "96622",
    "2039": "97140",
    "2040": "98462",
    "2041": "100334",
    "2042": "104749",
    "2043": "107819",
    "2044": "110451",
    "2045": "112445",
    "2046": "114019",
    "2047": "113613",
    "2048": "112902",
    "2049": "112002",
    "2050": "110866",
    "Age": "20-24"
  },
  {
    "2021": "85842",
    "2022": "83673",
    "2023": "80453",
    "2024": "79112",
    "2025": "77894",
    "2026": "76512",
    "2027": "75386",
    "2028": "74977",
    "2029": "74659",
    "2030": "74384",
    "2031": "75840",
    "2032": "78513",
    "2033": "81367",
    "2034": "84990",
    "2035": "87646",
    "2036": "88813",
    "2037": "88232",
    "2038": "89544",
    "2039": "90040",
    "2040": "91645",
    "2041": "93494",
    "2042": "94563",
    "2043": "95779",
    "2044": "96303",
    "2045": "97620",
    "2046": "99457",
    "2047": "103805",
    "2048": "106815",
    "2049": "109404",
    "2050": "111368",
    "Age": "25-29"
  },
  {
    "2021": "84307",
    "2022": "85446",
    "2023": "86464",
    "2024": "87656",
    "2025": "86830",
    "2026": "84667",
    "2027": "82574",
    "2028": "79448",
    "2029": "78177",
    "2030": "77019",
    "2031": "75700",
    "2032": "74630",
    "2033": "74260",
    "2034": "73977",
    "2035": "73724",
    "2036": "75160",
    "2037": "77780",
    "2038": "80561",
    "2039": "84107",
    "2040": "86706",
    "2041": "87863",
    "2042": "87302",
    "2043": "88618",
    "2044": "89117",
    "2045": "90706",
    "2046": "92534",
    "2047": "93591",
    "2048": "94805",
    "2049": "95332",
    "2050": "96640",
    "Age": "30-34"
  },
  {
    "2021": "77529",
    "2022": "80192",
    "2023": "81546",
    "2024": "81422",
    "2025": "82068",
    "2026": "82752",
    "2027": "83845",
    "2028": "84826",
    "2029": "85999",
    "2030": "85213",
    "2031": "83138",
    "2032": "81151",
    "2033": "78140",
    "2034": "76952",
    "2035": "75862",
    "2036": "74611",
    "2037": "73601",
    "2038": "73272",
    "2039": "73024",
    "2040": "72792",
    "2041": "74208",
    "2042": "76774",
    "2043": "79486",
    "2044": "82956",
    "2045": "85503",
    "2046": "86652",
    "2047": "86115",
    "2048": "87435",
    "2049": "87934",
    "2050": "89506",
    "Age": "35-39"
  },
  {
    "2021": "64129",
    "2022": "65997",
    "2023": "68318",
    "2024": "70296",
    "2025": "73063",
    "2026": "75888",
    "2027": "78462",
    "2028": "79777",
    "2029": "79656",
    "2030": "80300",
    "2031": "80978",
    "2032": "82059",
    "2033": "83032",
    "2034": "84208",
    "2035": "83478",
    "2036": "81493",
    "2037": "79605",
    "2038": "76701",
    "2039": "75585",
    "2040": "74556",
    "2041": "73365",
    "2042": "72408",
    "2043": "72115",
    "2044": "71898",
    "2045": "71686",
    "2046": "73085",
    "2047": "75604",
    "2048": "78257",
    "2049": "81662",
    "2050": "84165",
    "Age": "40-44"
  },
  {
    "2021": "59269",
    "2022": "58171",
    "2023": "58518",
    "2024": "60073",
    "2025": "61333",
    "2026": "62581",
    "2027": "64388",
    "2028": "66644",
    "2029": "68566",
    "2030": "71261",
    "2031": "74015",
    "2032": "76531",
    "2033": "77831",
    "2034": "77731",
    "2035": "78388",
    "2036": "79077",
    "2037": "80160",
    "2038": "81134",
    "2039": "82310",
    "2040": "81628",
    "2041": "79726",
    "2042": "77931",
    "2043": "75129",
    "2044": "74082",
    "2045": "73110",
    "2046": "71976",
    "2047": "71072",
    "2048": "70810",
    "2049": "70625",
    "2050": "70435",
    "Age": "45-49"
  },
  {
    "2021": "43311",
    "2022": "48150",
    "2023": "51451",
    "2024": "53663",
    "2025": "55584",
    "2026": "57301",
    "2027": "56250",
    "2028": "56604",
    "2029": "58124",
    "2030": "59356",
    "2031": "60582",
    "2032": "62344",
    "2033": "64547",
    "2034": "66427",
    "2035": "69057",
    "2036": "71747",
    "2037": "74208",
    "2038": "75495",
    "2039": "75421",
    "2040": "76095",
    "2041": "76799",
    "2042": "77888",
    "2043": "78865",
    "2044": "80035",
    "2045": "79405",
    "2046": "77595",
    "2047": "75898",
    "2048": "73207",
    "2049": "72232",
    "2050": "71320",
    "Age": "50-54"
  },
  {
    "2021": "35974",
    "2022": "35785",
    "2023": "36470",
    "2024": "37549",
    "2025": "39050",
    "2026": "41255",
    "2027": "45868",
    "2028": "49003",
    "2029": "51105",
    "2030": "52936",
    "2031": "54594",
    "2032": "53634",
    "2033": "54016",
    "2034": "55507",
    "2035": "56717",
    "2036": "57929",
    "2037": "59644",
    "2038": "61787",
    "2039": "63623",
    "2040": "66175",
    "2041": "68789",
    "2042": "71178",
    "2043": "72448",
    "2044": "72407",
    "2045": "73102",
    "2046": "73831",
    "2047": "74929",
    "2048": "75909",
    "2049": "77065",
    "2050": "76493",
    "Age": "55-59"
  },
  {
    "2021": "30252",
    "2022": "31761",
    "2023": "32368",
    "2024": "32861",
    "2025": "33184",
    "2026": "33152",
    "2027": "33007",
    "2028": "33673",
    "2029": "34709",
    "2030": "36133",
    "2031": "38203",
    "2032": "42522",
    "2033": "45445",
    "2034": "47413",
    "2035": "49135",
    "2036": "50720",
    "2037": "49895",
    "2038": "50318",
    "2039": "51771",
    "2040": "52951",
    "2041": "54144",
    "2042": "55793",
    "2043": "57852",
    "2044": "59629",
    "2045": "62077",
    "2046": "64585",
    "2047": "66875",
    "2048": "68117",
    "2049": "68115",
    "2050": "68831",
    "Age": "60-64"
  },
  {
    "2021": "17652",
    "2022": "19005",
    "2023": "20884",
    "2024": "22923",
    "2025": "24702",
    "2026": "26535",
    "2027": "27882",
    "2028": "28442",
    "2029": "28918",
    "2030": "29250",
    "2031": "29283",
    "2032": "29210",
    "2033": "29861",
    "2034": "30850",
    "2035": "32182",
    "2036": "34090",
    "2037": "38032",
    "2038": "40700",
    "2039": "42507",
    "2040": "44099",
    "2041": "45594",
    "2042": "44935",
    "2043": "45401",
    "2044": "46798",
    "2045": "47938",
    "2046": "49101",
    "2047": "50664",
    "2048": "52614",
    "2049": "54308",
    "2050": "56611",
    "Age": "65-69"
  },
  {
    "2021": "10049",
    "2022": "10928",
    "2023": "11826",
    "2024": "12808",
    "2025": "13575",
    "2026": "14606",
    "2027": "15767",
    "2028": "17367",
    "2029": "19102",
    "2030": "20623",
    "2031": "22202",
    "2032": "23378",
    "2033": "23898",
    "2034": "24363",
    "2035": "24708",
    "2036": "24814",
    "2037": "24823",
    "2038": "25450",
    "2039": "26378",
    "2040": "27597",
    "2041": "29312",
    "2042": "32809",
    "2043": "35177",
    "2044": "36797",
    "2045": "38230",
    "2046": "39602",
    "2047": "39125",
    "2048": "39626",
    "2049": "40939",
    "2050": "42014",
    "Age": "70-74"
  },
  {
    "2021": "4281",
    "2022": "4551",
    "2023": "5050",
    "2024": "5677",
    "2025": "6711",
    "2026": "7482",
    "2027": "8175",
    "2028": "8868",
    "2029": "9618",
    "2030": "10244",
    "2031": "11074",
    "2032": "12019",
    "2033": "13304",
    "2034": "14692",
    "2035": "15918",
    "2036": "17203",
    "2037": "18176",
    "2038": "18641",
    "2039": "19078",
    "2040": "19422",
    "2041": "19593",
    "2042": "19679",
    "2043": "20262",
    "2044": "21101",
    "2045": "22173",
    "2046": "23649",
    "2047": "26598",
    "2048": "28591",
    "2049": "29962",
    "2050": "31180",
    "Age": "75-79"
  },
  {
    "2021": "3418",
    "2022": "3544",
    "2023": "3352",
    "2024": "2999",
    "2025": "2769",
    "2026": "2663",
    "2027": "2897",
    "2028": "3242",
    "2029": "3647",
    "2030": "4335",
    "2031": "4859",
    "2032": "5354",
    "2033": "5838",
    "2034": "6358",
    "2035": "6827",
    "2036": "7440",
    "2037": "8144",
    "2038": "9086",
    "2039": "10096",
    "2040": "10997",
    "2041": "11953",
    "2042": "12693",
    "2043": "13079",
    "2044": "13463",
    "2045": "13782",
    "2046": "13993",
    "2047": "14135",
    "2048": "14639",
    "2049": "15344",
    "2050": "16217",
    "Age": "80-84"
  },
  {
    "2021": "1470",
    "2022": "1589",
    "2023": "1714",
    "2024": "1850",
    "2025": "1945",
    "2026": "2161",
    "2027": "2281",
    "2028": "2236",
    "2029": "2116",
    "2030": "2051",
    "2031": "2130",
    "2032": "2350",
    "2033": "2537",
    "2034": "2714",
    "2035": "3089",
    "2036": "3448",
    "2037": "3871",
    "2038": "4264",
    "2039": "4670",
    "2040": "5166",
    "2041": "5739",
    "2042": "6408",
    "2043": "7206",
    "2044": "8054",
    "2045": "8887",
    "2046": "9807",
    "2047": "10647",
    "2048": "11342",
    "2049": "12073",
    "2050": "12756",
    "Age": "85+"
  }
]
# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_region, gender='erkak').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='erkak',
                    population=population
                )

print("Navoi male data import completed successfully!")
