import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_region, _ = Region.objects.get_or_create(name='Buxoro', defaults={'svg_id': 'bukhara'})

# Data to be imported
navoi_male_data =[
  {
    "2021": "990403",
    "2022": "1007282",
    "2023": "1023835",
    "2024": "1039869",
    "2025": "1055469",
    "2026": "1070529",
    "2027": "1085004",
    "2028": "1098946",
    "2029": "112291",
    "2030": "1125010",
    "2031": "1137058",
    "2032": "1148426",
    "2033": "1159133",
    "2034": "1169133",
    "2035": "1178539",
    "2036": "1187372",
    "2037": "1195736",
    "2038": "1203686",
    "2039": "1211294",
    "2040": "1218663",
    "2041": "1225928",
    "2042": "1233180",
    "2043": "1240457",
    "2044": "1247780",
    "2045": "1255201",
    "2046": "1262709",
    "2047": "1270282",
    "2048": "1277898",
    "2049": "1285503",
    "2050": "1293033",
    "Age": "Total"
  },
  {
    "2021": "103606",
    "2022": "107803",
    "2023": "109932",
    "2024": "111593",
    "2025": "112881",
    "2026": "113551",
    "2027": "112478",
    "2028": "111091",
    "2029": "109516",
    "2030": "107714",
    "2031": "105707",
    "2032": "103557",
    "2033": "101243",
    "2034": "98783",
    "2035": "96323",
    "2036": "93939",
    "2037": "91756",
    "2038": "89812",
    "2039": "88228",
    "2040": "86983",
    "2041": "86233",
    "2042": "85912",
    "2043": "86024",
    "2044": "86518",
    "2045": "87341",
    "2046": "88347",
    "2047": "89423",
    "2048": "90513",
    "2049": "91545",
    "2050": "92409",
    "Age": "0-4"
  },
  {
    "2021": "94180",
    "2022": "95491",
    "2023": "97687",
    "2024": "99352",
    "2025": "100514",
    "2026": "102715",
    "2027": "106825",
    "2028": "108890",
    "2029": "110514",
    "2030": "111779",
    "2031": "112449",
    "2032": "111404",
    "2033": "110060",
    "2034": "108535",
    "2035": "106788",
    "2036": "104840",
    "2037": "102754",
    "2038": "100506",
    "2039": "98114",
    "2040": "95722",
    "2041": "93404",
    "2042": "91282",
    "2043": "89393",
    "2044": "87857",
    "2045": "86667",
    "2046": "85933",
    "2047": "85633",
    "2048": "85758",
    "2049": "86256",
    "2050": "87078",
    "Age": "5-9"
  },
  {
    "2021": "84816",
    "2022": "85670",
    "2023": "87238",
    "2024": "88622",
    "2025": "90865",
    "2026": "93510",
    "2027": "94777",
    "2028": "96931",
    "2029": "98562",
    "2030": "99696",
    "2031": "101856",
    "2032": "105914",
    "2033": "107944",
    "2034": "109548",
    "2035": "110807",
    "2036": "11485",
    "2037": "110468",
    "2038": "109163",
    "2039": "107680",
    "2040": "105979",
    "2041": "104081",
    "2042": "102047",
    "2043": "99852",
    "2044": "97517",
    "2045": "95180",
    "2046": "92914",
    "2047": "90842",
    "2048": "88996",
    "2049": "87498",
    "2050": "86338",
    "Age": "10-14"
  },
  {
    "2021": "73200",
    "2022": "75055",
    "2023": "77850",
    "2024": "80841",
    "2025": "83259",
    "2026": "84165",
    "2027": "84989",
    "2028": "86528",
    "2029": "87885",
    "2030": "90097",
    "2031": "92706",
    "2032": "93945",
    "2033": "96075",
    "2034": "97688",
    "2035": "98810",
    "2036": "100943",
    "2037": "104958",
    "2038": "106961",
    "2039": "108553",
    "2040": "109804",
    "2041": "110488",
    "2042": "109497",
    "2043": "108229",
    "2044": "106786",
    "2045": "105128",
    "2046": "103275",
    "2047": "101289",
    "2048": "99143",
    "2049": "96857",
    "2050": "94569",
    "Age": "15-19"
  },
  {
    "2021": "71917",
    "2022": "70679",
    "2023": "69993",
    "2024": "70677",
    "2025": "71674",
    "2026": "72685",
    "2027": "74487",
    "2028": "77211",
    "2029": "80128",
    "2030": "82487",
    "2031": "83360",
    "2032": "84164",
    "2033": "85681",
    "2034": "87018",
    "2035": "89194",
    "2036": "91756",
    "2037": "92959",
    "2038": "95059",
    "2039": "96653",
    "2040": "97762",
    "2041": "99856",
    "2042": "103812",
    "2043": "105776",
    "2044": "107349",
    "2045": "108589",
    "2046": "109280",
    "2047": "108327",
    "2048": "107112",
    "2049": "105725",
    "2050": "104127",
    "Age": "20-24"
  },
  {
    "2021": "87835",
    "2022": "84647",
    "2023": "81479",
    "2024": "77289",
    "2025": "73427",
    "2026": "71441",
    "2027": "70250",
    "2028": "69586",
    "2029": "70260",
    "2030": "71232",
    "2031": "72210",
    "2032": "73958",
    "2033": "76600",
    "2034": "79431",
    "2035": "81724",
    "2036": "82567",
    "2037": "83356",
    "2038": "84851",
    "2039": "86159",
    "2040": "88285",
    "2041": "90789",
    "2042": "91952",
    "2043": "94019",
    "2044": "95588",
    "2045": "96677",
    "2046": "98722",
    "2047": "102602",
    "2048": "104517",
    "2049": "106064",
    "2050": "107290",
    "Age": "25-29"
  },
  {
    "2021": "88239",
    "2022": "89199",
    "2023": "89344",
    "2024": "90063",
    "2025": "89047",
    "2026": "86442",
    "2027": "83361",
    "2028": "80327",
    "2029": "76303",
    "2030": "72599",
    "2031": "70721",
    "2032": "69598",
    "2033": "68970",
    "2034": "69643",
    "2035": "70597",
    "2036": "71550",
    "2037": "73247",
    "2038": "75811",
    "2039": "78557",
    "2040": "80792",
    "2041": "81614",
    "2042": "82390",
    "2043": "83863",
    "2044": "85142",
    "2045": "87220",
    "2046": "89672",
    "2047": "90802",
    "2048": "92834",
    "2049": "94375",
    "2050": "95443",
    "Age": "30-34"
  },
  {
    "2021": "76633",
    "2022": "79890",
    "2023": "82258",
    "2024": "83504",
    "2025": "84891",
    "2026": "86344",
    "2027": "87239",
    "2028": "87353",
    "2029": "88060",
    "2030": "87095",
    "2031": "84605",
    "2032": "81669",
    "2033": "78794",
    "2034": "74953",
    "2035": "71416",
    "2036": "69648",
    "2037": "68596",
    "2038": "68009",
    "2039": "68686",
    "2040": "69625",
    "2041": "70556",
    "2042": "72208",
    "2043": "74699",
    "2044": "77369",
    "2045": "79550",
    "2046": "80357",
    "2047": "81126",
    "2048": "82579",
    "2049": "83828",
    "2050": "85858",
    "Age": "35-39"
  },
  {
    "2021": "62826",
    "2022": "64615",
    "2023": "66016",
    "2024": "68095",
    "2025": "71658",
    "2026": "74916",
    "2027": "78026",
    "2028": "80309",
    "2029": "81499",
    "2030": "82389",
    "2031": "84250",
    "2032": "85130",
    "2033": "85252",
    "2034": "85976",
    "2035": "85075",
    "2036": "82701",
    "2037": "79903",
    "2038": "77172",
    "2039": "73491",
    "2040": "70096",
    "2041": "68420",
    "2042": "67428",
    "2043": "66878",
    "2044": "67559",
    "2045": "68489",
    "2046": "69403",
    "2047": "71018",
    "2048": "73450",
    "2049": "76057",
    "2050": "78195",
    "Age": "40-44"
  },
  {
    "2021": "59303",
    "2022": "58199",
    "2023": "58982",
    "2024": "60291",
    "2025": "60982",
    "2026": "61349",
    "2027": "63077",
    "2028": "64423",
    "2029": "66429",
    "2030": "69883",
    "2031": "73035",
    "2032": "76064",
    "2033": "78276",
    "2034": "79438",
    "2035": "80759",
    "2036": "82151",
    "2037": "83032",
    "2038": "83171",
    "2039": "83909",
    "2040": "83069",
    "2041": "80799",
    "2042": "78121",
    "2043": "75513",
    "2044": "71973",
    "2045": "68707",
    "2046": "67114",
    "2047": "66179",
    "2048": "65664",
    "2049": "66350",
    "2050": "67273",
    "Age": "45-49"
  },
  {
    "2021": "51165",
    "2022": "53771",
    "2023": "54944",
    "2024": "56452",
    "2025": "57305",
    "2026": "57460",
    "2027": "56393",
    "2028": "57161",
    "2029": "58463",
    "2030": "59114",
    "2031": "59480",
    "2032": "61167",
    "2033": "62480",
    "2034": "64432",
    "2035": "67790",
    "2036": "70848",
    "2037": "73795",
    "2038": "75953",
    "2039": "77095",
    "2040": "78404",
    "2041": "79783",
    "2042": "80669",
    "2043": "80828",
    "2044": "81580",
    "2045": "80804",
    "2046": "78639",
    "2047": "76083",
    "2048": "73594",
    "2049": "70194",
    "2050": "67059",
    "Age": "50-54"
  },
  {
    "2021": "46372",
    "2022": "46272",
    "2023": "46483",
    "2024": "46195",
    "2025": "47052",
    "2026": "48916",
    "2027": "51411",
    "2028": "52529",
    "2029": "53966",
    "2030": "54792",
    "2031": "54978",
    "2032": "53990",
    "2033": "54761",
    "2034": "56011",
    "2035": "56688",
    "2036": "57070",
    "2037": "58716",
    "2038": "60003",
    "2039": "61903",
    "2040": "65155",
    "2041": "68110",
    "2042": "70963",
    "2043": "73089",
    "2044": "74179",
    "2045": "75479",
    "2046": "76847",
    "2047": "77741",
    "2048": "77923",
    "2049": "78686",
    "2050": "77981",
    "Age": "55-59"
  },
  {
    "2021": "39099",
    "2022": "41037",
    "2023": "42149",
    "2024": "43041",
    "2025": "42997",
    "2026": "43062",
    "2027": "42991",
    "2028": "43227",
    "2029": "42983",
    "2030": "43819",
    "2031": "45605",
    "2032": "47974",
    "2033": "49041",
    "2034": "50399",
    "2035": "51203",
    "2036": "51441",
    "2037": "50570",
    "2038": "51353",
    "2039": "52573",
    "2040": "53252",
    "2041": "53660",
    "2042": "55252",
    "2043": "56509",
    "2044": "58346",
    "2045": "61461",
    "2046": "64283",
    "2047": "67011",
    "2048": "69022",
    "2049": "70111",
    "2050": "71398",
    "Age": "60-64"
  },
  {
    "2021": "23905",
    "2022": "25400",
    "2023": "27623",
    "2024": "29732",
    "2025": "32261",
    "2026": "34852",
    "2027": "36590",
    "2028": "37614",
    "2029": "38446",
    "2030": "38455",
    "2031": "38578",
    "2032": "38571",
    "2033": "38856",
    "2034": "38689",
    "2035": "39511",
    "2036": "41204",
    "2037": "45422",
    "2038": "44441",
    "2039": "45716",
    "2040": "46503",
    "2041": "46805",
    "2042": "46078",
    "2043": "46869",
    "2044": "48051",
    "2045": "48734",
    "2046": "49173",
    "2047": "50698",
    "2048": "51915",
    "2049": "53669",
    "2050": "56605",
    "Age": "65-69"
  },
  {
    "2021": "13834",
    "2022": "15363",
    "2023": "16892",
    "2024": "18068",
    "2025": "19227",
    "2026": "20287",
    "2027": "21594",
    "2028": "23541",
    "2029": "25378",
    "2030": "27593",
    "2031": "29855",
    "2032": "31389",
    "2033": "32331",
    "2034": "33107",
    "2035": "33187",
    "2036": "33381",
    "2037": "33449",
    "2038": "33787",
    "2039": "33707",
    "2040": "34506",
    "2041": "36088",
    "2042": "38125",
    "2043": "39087",
    "2044": "40255",
    "2045": "41011",
    "2046": "41372",
    "2047": "40808",
    "2048": "41596",
    "2049": "42720",
    "2050": "43395",
    "Age": "70-74"
  },
  {
    "2021": "6807",
    "2022": "6977",
    "2023": "7417",
    "2024": "8461",
    "2025": "9594",
    "2026": "10787",
    "2027": "12010",
    "2028": "13229",
    "2029": "14180",
    "2030": "15139",
    "2031": "16017",
    "2032": "17120",
    "2033": "18755",
    "2034": "20285",
    "2035": "22141",
    "2036": "24025",
    "2037": "25322",
    "2038": "26166",
    "2039": "26868",
    "2040": "27019",
    "2041": "27280",
    "2042": "27422",
    "2043": "27805",
    "2044": "27815",
    "2045": "28573",
    "2046": "30011",
    "2047": "31815",
    "2048": "32694",
    "2049": "33717",
    "2050": "34416",
    "Age": "75-79"
  },
  {
    "2021": "5115",
    "2022": "5563",
    "2023": "5328",
    "2024": "5029",
    "2025": "4847",
    "2026": "4576",
    "2027": "4637",
    "2028": "5094",
    "2029": "5843",
    "2030": "6666",
    "2031": "7524",
    "2032": "8421",
    "2033": "9315",
    "2034": "10032",
    "2035": "10773",
    "2036": "11456",
    "2037": "12327",
    "2038": "13606",
    "2039": "14793",
    "2040": "16240",
    "2041": "17696",
    "2042": "18722",
    "2043": "19437",
    "2044": "20037",
    "2045": "20244",
    "2046": "20548",
    "2047": "20747",
    "2048": "21146",
    "2049": "21233",
    "2050": "21914",
    "Age": "80-84"
  },
  {
    "2021": "1551",
    "2022": "1830",
    "2023": "2221",
    "2024": "2584",
    "2025": "2988",
    "2026": "3471",
    "2027": "3858",
    "2028": "3901",
    "2029": "3900",
    "2030": "4010",
    "2031": "4123",
    "2032": "4392",
    "2033": "4698",
    "2034": "5167",
    "2035": "5756",
    "2036": "6367",
    "2037": "7105",
    "2038": "7864",
    "2039": "8610",
    "2040": "9452",
    "2041": "10267",
    "2042": "11298",
    "2043": "12618",
    "2044": "13860",
    "2045": "15348",
    "2046": "16819",
    "2047": "18138",
    "2048": "19444",
    "2049": "20615",
    "2050": "21683",
    "Age": "85+"
  }
]
# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_region, gender='erkak').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='erkak',
                    population=population
                )

print("Navoi male data import completed successfully!")
