import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_region, _ = Region.objects.get_or_create(name='Jizzax', defaults={'svg_id': 'jizzakh'})

# Data to be imported
navoi_male_data =[
  {
    "2021": "727602",
    "2022": "744769",
    "2023": "761866",
    "2024": "778711",
    "2025": "795308",
    "2026": "811578",
    "2027": "827454",
    "2028": "842966",
    "2029": "858026",
    "2030": "872577",
    "2031": "886544",
    "2032": "899911",
    "2033": "912688",
    "2034": "924843",
    "2035": "936487",
    "2036": "947649",
    "2037": "958440",
    "2038": "968933",
    "2039": "979226",
    "2040": "989453",
    "2041": "999772",
    "2042": "1010301",
    "2043": "1021094",
    "2044": "1032182",
    "2045": "1043617",
    "2046": "1055381",
    "2047": "1067444",
    "2048": "1079771",
    "2049": "1092294",
    "2050": "1104937",
    "Age": "Total"
  },
  {
    "2021": "91052",
    "2022": "96752",
    "2023": "101094",
    "2024": "104087",
    "2025": "105515",
    "2026": "105677",
    "2027": "105317",
    "2028": "104589",
    "2029": "103589",
    "2030": "102275",
    "2031": "100669",
    "2032": "98820",
    "2033": "96712",
    "2034": "94404",
    "2035": "92073",
    "2036": "89821",
    "2037": "87792",
    "2038": "86051",
    "2039": "84733",
    "2040": "83859",
    "2041": "83563",
    "2042": "83841",
    "2043": "84677",
    "2044": "86005",
    "2045": "87745",
    "2046": "89722",
    "2047": "91793",
    "2048": "93876",
    "2049": "95881",
    "2050": "97680",
    "Age": "0-4"
  },
  {
    "2021": "74362",
    "2022": "76148",
    "2023": "79124",
    "2024": "82199",
    "2025": "85525",
    "2026": "90162",
    "2027": "95722",
    "2028": "99955",
    "2029": "102884",
    "2030": "104291",
    "2031": "104467",
    "2032": "104140",
    "2033": "103456",
    "2034": "102511",
    "2035": "101260",
    "2036": "99724",
    "2037": "97951",
    "2038": "95925",
    "2039": "93702",
    "2040": "91456",
    "2041": "89286",
    "2042": "87334",
    "2043": "85661",
    "2044": "84402",
    "2045": "83575",
    "2046": "83313",
    "2047": "83612",
    "2048": "84457",
    "2049": "85783",
    "2050": "87513",
    "Age": "5-9"
  },
  {
    "2021": "67657",
    "2022": "68121",
    "2023": "67806",
    "2024": "68770",
    "2025": "71226",
    "2026": "73875",
    "2027": "75611",
    "2028": "78531",
    "2029": "81542",
    "2030": "84794",
    "2031": "89340",
    "2032": "94802",
    "2033": "98962",
    "2034": "101850",
    "2035": "103250",
    "2036": "103443",
    "2037": "103148",
    "2038": "102503",
    "2039": "101603",
    "2040": "100404",
    "2041": "98925",
    "2042": "97216",
    "2043": "95257",
    "2044": "93104",
    "2045": "90928",
    "2046": "88825",
    "2047": "86935",
    "2048": "85317",
    "2049": "84105",
    "2050": "83315",
    "Age": "10-14"
  },
  {
    "2021": "59342",
    "2022": "60441",
    "2023": "63082",
    "2024": "64925",
    "2025": "66154",
    "2026": "67149",
    "2027": "67601",
    "2028": "67289",
    "2029": "68242",
    "2030": "70665",
    "2031": "73277",
    "2032": "74977",
    "2033": "77853",
    "2034": "80816",
    "2035": "84015",
    "2036": "88491",
    "2037": "93871",
    "2038": "97964",
    "2039": "100814",
    "2040": "102206",
    "2041": "102415",
    "2042": "102150",
    "2043": "101543",
    "2044": "100687",
    "2045": "99537",
    "2046": "98111",
    "2047": "96460",
    "2048": "94561",
    "2049": "92470",
    "2050": "90365",
    "Age": "15-19"
  },
  {
    "2021": "59022",
    "2022": "57826",
    "2023": "57645",
    "2024": "57910",
    "2025": "58625",
    "2026": "59048",
    "2027": "60116",
    "2028": "62701",
    "2029": "64497",
    "2030": "65695",
    "2031": "66669",
    "2032": "67123",
    "2033": "66830",
    "2034": "67782",
    "2035": "70168",
    "2036": "72728",
    "2037": "74379",
    "2038": "77195",
    "2039": "80096",
    "2040": "83231",
    "2041": "87611",
    "2042": "92875",
    "2043": "96874",
    "2044": "99671",
    "2045": "101054",
    "2046": "101291",
    "2047": "101072",
    "2048": "100521",
    "2049": "99727",
    "2050": "98645",
    "Age": "20-24"
  },
  {
    "2021": "70436",
    "2022": "68202",
    "2023": "65583",
    "2024": "63556",
    "2025": "60753",
    "2026": "58861",
    "2027": "57738",
    "2028": "57593",
    "2029": "57871",
    "2030": "58586",
    "2031": "59007",
    "2032": "60044",
    "2033": "62563",
    "2034": "64302",
    "2035": "65468",
    "2036": "66426",
    "2037": "66891",
    "2038": "66627",
    "2039": "67574",
    "2040": "69908",
    "2041": "72403",
    "2042": "73998",
    "2043": "76747",
    "2044": "79575",
    "2045": "82625",
    "2046": "86883",
    "2047": "92005",
    "2048": "95894",
    "2049": "98633",
    "2050": "100012",
    "Age": "25-29"
  },
  {
    "2021": "68099",
    "2022": "69748",
    "2023": "70755",
    "2024": "70980",
    "2025": "70761",
    "2026": "69426",
    "2027": "67309",
    "2028": "64831",
    "2029": "62947",
    "2030": "60297",
    "2031": "58532",
    "2032": "57493",
    "2033": "57390",
    "2034": "57683",
    "2035": "58401",
    "2036": "58821",
    "2037": "59829",
    "2038": "62283",
    "2039": "63970",
    "2040": "65111",
    "2041": "66063",
    "2042": "66546",
    "2043": "66313",
    "2044": "67258",
    "2045": "69453",
    "2046": "71984",
    "2047": "73534",
    "2048": "76222",
    "2049": "78977",
    "2050": "81941",
    "Age": "30-34"
  },
  {
    "2021": "53308",
    "2022": "58413",
    "2023": "60227",
    "2024": "61789",
    "2025": "65052",
    "2026": "66668",
    "2027": "68238",
    "2028": "69204",
    "2029": "69435",
    "2030": "69263",
    "2031": "68023",
    "2032": "66045",
    "2033": "63716",
    "2034": "61978",
    "2035": "59478",
    "2036": "57837",
    "2037": "56816",
    "2038": "56816",
    "2039": "57125",
    "2040": "57848",
    "2041": "58272",
    "2042": "59258",
    "2043": "61655",
    "2044": "63301",
    "2045": "64426",
    "2046": "65379",
    "2047": "65886",
    "2048": "65688",
    "2049": "66632",
    "2050": "68871",
    "Age": "35-39"
  },
  {
    "2021": "41745",
    "2022": "41966",
    "2023": "44594",
    "2024": "47444",
    "2025": "48918",
    "2026": "52213",
    "2027": "57124",
    "2028": "58837",
    "2029": "60325",
    "2030": "63483",
    "2031": "65032",
    "2032": "66562",
    "2033": "67519",
    "2034": "67772",
    "2035": "67651",
    "2036": "66501",
    "2037": "64645",
    "2038": "62447",
    "2039": "60832",
    "2040": "58458",
    "2041": "56916",
    "2042": "56025",
    "2043": "55999",
    "2044": "56327",
    "2045": "57057",
    "2046": "57489",
    "2047": "58461",
    "2048": "60814",
    "2049": "62428",
    "2050": "63544",
    "Age": "40-44"
  },
  {
    "2021": "34583",
    "2022": "35160",
    "2023": "36298",
    "2024": "37835",
    "2025": "39428",
    "2026": "40879",
    "2027": "41071",
    "2028": "43610",
    "2029": "46361",
    "2030": "47765",
    "2031": "50940",
    "2032": "55689",
    "2033": "57334",
    "2034": "58773",
    "2035": "61848",
    "2036": "63355",
    "2037": "64860",
    "2038": "65811",
    "2039": "66084",
    "2040": "66008",
    "2041": "64935",
    "2042": "63185",
    "2043": "61099",
    "2044": "59586",
    "2045": "57324",
    "2046": "55871",
    "2047": "55044",
    "2048": "55050",
    "2049": "55396",
    "2050": "56133",
    "Age": "45-49"
  },
  {
    "2021": "27673",
    "2022": "28774",
    "2023": "30076",
    "2024": "31584",
    "2025": "32945",
    "2026": "33585",
    "2027": "34143",
    "2028": "36721",
    "2029": "36721",
    "2030": "38260",
    "2031": "39671",
    "2032": "39847",
    "2033": "42305",
    "2034": "44966",
    "2035": "46316",
    "2036": "49382",
    "2037": "53969",
    "2038": "55556",
    "2039": "56956",
    "2040": "59947",
    "2041": "61419",
    "2042": "62904",
    "2043": "63849",
    "2044": "64143",
    "2045": "64412",
    "2046": "63119",
    "2047": "61476",
    "2048": "59497",
    "2049": "58079",
    "2050": "55928",
    "Age": "50-54"
  },
  {
    "2021": "26263",
    "2022": "26082",
    "2023": "25675",
    "2024": "24916",
    "2025": "25195",
    "2026": "26519",
    "2027": "27574",
    "2028": "28809",
    "2029": "30233",
    "2030": "31533",
    "2031": "32161",
    "2032": "32710",
    "2033": "33769",
    "2034": "35189",
    "2035": "36674",
    "2036": "38045",
    "2037": "38211",
    "2038": "40582",
    "2039": "43144",
    "2040": "44441",
    "2041": "47390",
    "2042": "51782",
    "2043": "53310",
    "2044": "54670",
    "2045": "57563",
    "2046": "59004",
    "2047": "60469",
    "2048": "61405",
    "2049": "61717",
    "2050": "61734",
    "Age": "55-59"
  },
  {
    "2021": "22897",
    "2022": "23727",
    "2023": "24163",
    "2024": "24519",
    "2025": "24576",
    "2026": "24282",
    "2027": "24149",
    "2028": "23801",
    "2029": "23130",
    "2030": "23422",
    "2031": "24683",
    "2032": "25685",
    "2033": "26840",
    "2034": "28161",
    "2035": "29388",
    "2036": "30008",
    "2037": "30550",
    "2038": "31563",
    "2039": "32908",
    "2040": "34326",
    "2041": "35644",
    "2042": "35803",
    "2043": "38061",
    "2044": "40497",
    "2045": "41736",
    "2046": "44540",
    "2047": "48674",
    "2048": "50129",
    "2049": "51439",
    "2050": "54195",
    "Age": "60-64"
  },
  {
    "2021": "14811",
    "2022": "15819",
    "2023": "17034",
    "2024": "18147",
    "2025": "19156",
    "2026": "20114",
    "2027": "20863",
    "2028": "21267",
    "2029": "21613",
    "2030": "21697",
    "2031": "21477",
    "2032": "21408",
    "2033": "21143",
    "2034": "20587",
    "2035": "20896",
    "2036": "22078",
    "2037": "23017",
    "2038": "24080",
    "2039": "25285",
    "2040": "26425",
    "2041": "27034",
    "2042": "27566",
    "2043": "28522",
    "2044": "29778",
    "2045": "31113",
    "2046": "32364",
    "2047": "32525",
    "2048": "34640",
    "2049": "36915",
    "2050": "38079",
    "Age": "65-69"
  },
  {
    "2021": "8711",
    "2022": "9509",
    "2023": "10192",
    "2024": "10937",
    "2025": "11317",
    "2026": "12293",
    "2027": "13155",
    "2028": "14187",
    "2029": "15142",
    "2030": "16012",
    "2031": "16851",
    "2032": "17520",
    "2033": "17897",
    "2034": "18238",
    "2035": "18354",
    "2036": "18218",
    "2037": "18219",
    "2038": "18039",
    "2039": "17609",
    "2040": "17931",
    "2041": "19013",
    "2042": "19880",
    "2043": "20838",
    "2044": "21907",
    "2045": "22943",
    "2046": "23535",
    "2047": "24052",
    "2048": "24937",
    "2049": "26082",
    "2050": "27313",
    "Age": "70-74"
  },
  {
    "2021": "4235",
    "2022": "4338",
    "2023": "4593",
    "2024": "5164",
    "2025": "6101",
    "2026": "6551",
    "2027": "7170",
    "2028": "7692",
    "2029": "8279",
    "2030": "8615",
    "2031": "9394",
    "2032": "10098",
    "2033": "10928",
    "2034": "11708",
    "2035": "12425",
    "2036": "13131",
    "2037": "13706",
    "2038": "14048",
    "2039": "14372",
    "2040": "14514",
    "2041": "14461",
    "2042": "14527",
    "2043": "14432",
    "2044": "14137",
    "2045": "14463",
    "2046": "15421",
    "2047": "16195",
    "2048": "17019",
    "2049": "17917",
    "2050": "18816",
    "Age": "75-79"
  },
  {
    "2021": "2364",
    "2022": "2644",
    "2023": "2785",
    "2024": "2762",
    "2025": "2739",
    "2026": "2695",
    "2027": "2798",
    "2028": "2987",
    "2029": "3373",
    "2030": "4021",
    "2031": "4329",
    "2032": "4766",
    "2033": "5130",
    "2034": "5555",
    "2035": "5835",
    "2036": "6406",
    "2037": "6937",
    "2038": "7550",
    "2039": "8139",
    "2040": "8684",
    "2041": "9233",
    "2042": "9692",
    "2043": "9822",
    "2044": "10270",
    "2045": "10423",
    "2046": "10442",
    "2047": "10555",
    "2048": "10536",
    "2049": "10368",
    "2050": "10674",
    "Age": "80-84"
  },
  {
    "2021": "1042",
    "2022": "1100",
    "2023": "1139",
    "2024": "1186",
    "2025": "1322",
    "2026": "1579",
    "2027": "1753",
    "2028": "1841",
    "2029": "1843",
    "2030": "1902",
    "2031": "2021",
    "2032": "2181",
    "2033": "2341",
    "2034": "2569",
    "2035": "2988",
    "2036": "3235",
    "2037": "3587",
    "2038": "3893",
    "2039": "4281",
    "2040": "4697",
    "2041": "5187",
    "2042": "5719",
    "2043": "6275",
    "2044": "6867",
    "2045": "7450",
    "2046": "8088",
    "2047": "8695",
    "2048": "9208",
    "2049": "9746",
    "2050": "10189",
    "Age": "85+"
  }
]
# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_region, gender='erkak').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='erkak',
                    population=population
                )

print("Navoi male data import completed successfully!")
