import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_city_region, _ = Region.objects.get_or_create(name='Surxondaryo', defaults={'svg_id': 'surkhandarya'})

# Data to be imported
navoi_male_data = [
  {
    "Age": "Total",
    "2022": "1356217",
    "2023": "1389911",
    "2024": "1423562",
    "2025": "1456776",
    "2026": "1489487",
    "2027": "1521528",
    "2028": "1552791",
    "2029": "1583368",
    "2030": "1613179",
    "2031": "1642232",
    "2032": "1670474",
    "2033": "1697870",
    "2034": "1724409",
    "2035": "1749969",
    "2036": "1774743",
    "2037": "1798767",
    "2038": "1822243",
    "2039": "1845262",
    "2040": "1867978",
    "2041": "1890605",
    "2042": "1913419",
    "2043": "1936622",
    "2044": "1960304",
    "2045": "1984519",
    "2046": "2009358",
    "2047": "2034783",
    "2048": "2060719",
    "2049": "2087096",
    "2050": "2113781"
  },
  {
    "Age": "0-4",
    "2022": "165627",
    "2023": "175882",
    "2024": "185088",
    "2025": "191112",
    "2026": "194860",
    "2027": "196611",
    "2028": "195088",
    "2029": "192923",
    "2030": "190450",
    "2031": "187742",
    "2032": "184911",
    "2033": "182028",
    "2034": "178977",
    "2035": "175734",
    "2036": "172487",
    "2037": "169325",
    "2038": "166488",
    "2039": "164093",
    "2040": "162397",
    "2041": "161419",
    "2042": "161398",
    "2043": "162325",
    "2044": "164191",
    "2045": "166897",
    "2046": "170323",
    "2047": "174151",
    "2048": "178113",
    "2049": "182051",
    "2050": "185786"
  },
  {
    "Age": "5-9",
    "2022": "140069",
    "2023": "143024",
    "2024": "146895",
    "2025": "151654",
    "2026": "157230",
    "2027": "164219",
    "2028": "174271",
    "2029": "183304",
    "2030": "189228",
    "2031": "192943",
    "2032": "194725",
    "2033": "193289",
    "2034": "191237",
    "2035": "188885",
    "2036": "186299",
    "2037": "183590",
    "2038": "180829",
    "2039": "177901",
    "2040": "174782",
    "2041": "171660",
    "2042": "168621",
    "2043": "165903",
    "2044": "163618",
    "2045": "162019",
    "2046": "161120",
    "2047": "161158",
    "2048": "162123",
    "2049": "164006",
    "2050": "166710"
  },
  {
    "Age": "10-14",
    "2022": "124282",
    "2023": "128364",
    "2024": "129424",
    "2025": "132631",
    "2026": "136616",
    "2027": "139237",
    "2028": "142146",
    "2029": "145964",
    "2030": "150656",
    "2031": "156151",
    "2032": "163036",
    "2033": "172962",
    "2034": "181889",
    "2035": "187758",
    "2036": "191465",
    "2037": "193279",
    "2038": "191912",
    "2039": "189948",
    "2040": "187688",
    "2041": "185200",
    "2042": "182591",
    "2043": "179934",
    "2044": "177113",
    "2045": "174102",
    "2046": "171084",
    "2047": "168143",
    "2048": "165512",
    "2049": "163300",
    "2050": "161760"
  },
  {
    "Age": "15-19",
    "2022": "102039",
    "2023": "102641",
    "2024": "107799",
    "2025": "112672",
    "2026": "118013",
    "2027": "123501",
    "2028": "127503",
    "2029": "128531",
    "2030": "131710",
    "2031": "135660",
    "2032": "138267",
    "2033": "141160",
    "2034": "144938",
    "2035": "149583",
    "2036": "155030",
    "2037": "161844",
    "2038": "171662",
    "2039": "180478",
    "2040": "186279",
    "2041": "189962",
    "2042": "191794",
    "2043": "190495",
    "2044": "188629",
    "2045": "186473",
    "2046": "184088",
    "2047": "181581",
    "2048": "179019",
    "2049": "176287",
    "2050": "173361"
  },
  {
    "Age": "20-24",
    "2022": "108855",
    "2023": "105056",
    "2024": "103367",
    "2025": "102645",
    "2026": "101760",
    "2027": "103124",
    "2028": "103778",
    "2029": "108818",
    "2030": "113401",
    "2031": "118375",
    "2032": "123492",
    "2033": "127259",
    "2034": "128245",
    "2035": "131392",
    "2036": "135270",
    "2037": "137814",
    "2038": "140591",
    "2039": "144222",
    "2040": "148764",
    "2041": "154098",
    "2042": "160669",
    "2043": "170080",
    "2044": "178484",
    "2045": "184030",
    "2046": "187618",
    "2047": "189522",
    "2048": "188476",
    "2049": "186936",
    "2050": "185104"
  },
  {
    "Age": "25-29",
    "2022": "127311",
    "2023": "127645",
    "2024": "123334",
    "2025": "120611",
    "2026": "115391",
    "2027": "110567",
    "2028": "107339",
    "2029": "106039",
    "2030": "105623",
    "2031": "104970",
    "2032": "106449",
    "2033": "107043",
    "2034": "111778",
    "2035": "115978",
    "2036": "120595",
    "2037": "125400",
    "2038": "129028",
    "2039": "130007",
    "2040": "133069",
    "2041": "136814",
    "2042": "139304",
    "2043": "142076",
    "2044": "145660",
    "2045": "150058",
    "2046": "155147",
    "2047": "161336",
    "2048": "170243",
    "2049": "178214",
    "2050": "183531"
  },
  {
    "Age": "30-34",
    "2022": "122400",
    "2023": "123253",
    "2024": "125501",
    "2025": "125260",
    "2026": "126945",
    "2027": "125958",
    "2028": "126487",
    "2029": "122559",
    "2030": "120303",
    "2031": "115611",
    "2032": "111299",
    "2033": "108459",
    "2034": "107422",
    "2035": "107202",
    "2036": "106688",
    "2037": "108229",
    "2038": "108792",
    "2039": "113358",
    "2040": "117358",
    "2041": "121792",
    "2042": "126445",
    "2043": "130033",
    "2044": "131059",
    "2045": "134124",
    "2046": "137841",
    "2047": "140337",
    "2048": "143110",
    "2049": "146632",
    "2050": "150891"
  },
  {
    "Age": "35-39",
    "2022": "103742",
    "2023": "108777",
    "2024": "112722",
    "2025": "115697",
    "2026": "117469",
    "2027": "120211",
    "2028": "121000",
    "2029": "123235",
    "2030": "123038",
    "2031": "124790",
    "2032": "123922",
    "2033": "124643",
    "2034": "121028",
    "2035": "119124",
    "2036": "114820",
    "2037": "110870",
    "2038": "108296",
    "2039": "107434",
    "2040": "107349",
    "2041": "106942",
    "2042": "108546",
    "2043": "109123",
    "2044": "113611",
    "2045": "117509",
    "2046": "121848",
    "2047": "126415",
    "2048": "129974",
    "2049": "131016",
    "2050": "134047"
  },
  {
    "Age": "40-44",
    "2022": "80217",
    "2023": "83739",
    "2024": "87878",
    "2025": "91934",
    "2026": "97222",
    "2027": "101937",
    "2028": "106763",
    "2029": "110559",
    "2030": "113451",
    "2031": "115178",
    "2032": "117892",
    "2033": "118692",
    "2034": "120958",
    "2035": "120824",
    "2036": "122633",
    "2037": "121852",
    "2038": "122694",
    "2039": "119288",
    "2040": "117610",
    "2041": "113560",
    "2042": "109850",
    "2043": "107462",
    "2044": "106730",
    "2045": "106753",
    "2046": "106433",
    "2047": "108084",
    "2048": "108669",
    "2049": "113087",
    "2050": "116898"
  },
  {
    "Age": "45-49",
    "2022": "68316",
    "2023": "69288",
    "2024": "70833",
    "2025": "73232",
    "2026": "75962",
    "2027": "79027",
    "2028": "82427",
    "2029": "86432",
    "2030": "90351",
    "2031": "95483",
    "2032": "100058",
    "2033": "104763",
    "2034": "108478",
    "2035": "111329",
    "2036": "113043",
    "2037": "115744",
    "2038": "116560",
    "2039": "118842",
    "2040": "118753",
    "2041": "120601",
    "2042": "119895",
    "2043": "120828",
    "2044": "117583",
    "2045": "116065",
    "2046": "112207",
    "2047": "108674",
    "2048": "106420",
    "2049": "105770",
    "2050": "105848"
  },
  {
    "Age": "50-54",
    "2022": "59306",
    "2023": "61624",
    "2024": "62918",
    "2025": "64752",
    "2026": "65912",
    "2027": "67013",
    "2028": "67965",
    "2029": "69475",
    "2030": "71816",
    "2031": "74475",
    "2032": "77465",
    "2033": "80777",
    "2034": "84683",
    "2035": "88498",
    "2036": "93506",
    "2037": "97968",
    "2038": "102568",
    "2039": "106208",
    "2040": "109020",
    "2041": "110727",
    "2042": "113422",
    "2043": "114262",
    "2044": "116564",
    "2045": "116526",
    "2046": "118412",
    "2047": "117779",
    "2048": "118775",
    "2049": "115657",
    "2050": "114248"
  },
  {
    "Age": "55-59",
    "2022": "52698",
    "2023": "53063",
    "2024": "53823",
    "2025": "54443",
    "2026": "55572",
    "2027": "57598",
    "2028": "59835",
    "2029": "61086",
    "2030": "62867",
    "2031": "64007",
    "2032": "65105",
    "2033": "66058",
    "2034": "67544",
    "2035": "69834",
    "2036": "72427",
    "2037": "75342",
    "2038": "78561",
    "2039": "82353",
    "2040": "86059",
    "2041": "90933",
    "2042": "95275",
    "2043": "99760",
    "2044": "103321",
    "2045": "106092",
    "2046": "107802",
    "2047": "110490",
    "2048": "111354",
    "2049": "113657",
    "2050": "113652"
  },
  {
    "Age": "60-64",
    "2022": "43829",
    "2023": "45954",
    "2024": "47664",
    "2025": "48687",
    "2026": "49593",
    "2027": "49765",
    "2028": "50131",
    "2029": "50887",
    "2030": "51503",
    "2031": "52614",
    "2032": "54568",
    "2033": "56716",
    "2034": "57934",
    "2035": "59658",
    "2036": "60783",
    "2037": "61885",
    "2038": "62845",
    "2039": "64302",
    "2040": "66529",
    "2041": "69042",
    "2042": "71868",
    "2043": "74974",
    "2044": "78632",
    "2045": "82211",
    "2046": "86922",
    "2047": "91119",
    "2048": "95451",
    "2049": "98896",
    "2050": "101592"
  },
  {
    "Age": "65-69",
    "2022": "25662",
    "2023": "27888",
    "2024": "30888",
    "2025": "33848",
    "2026": "36989",
    "2027": "39621",
    "2028": "41541",
    "2029": "43115",
    "2030": "44078",
    "2031": "44963",
    "2032": "45187",
    "2033": "45582",
    "2034": "46355",
    "2035": "46987",
    "2036": "48088",
    "2037": "49958",
    "2038": "51996",
    "2039": "53177",
    "2040": "54826",
    "2041": "55935",
    "2042": "57043",
    "2043": "58014",
    "2044": "59441",
    "2045": "61591",
    "2046": "64003",
    "2047": "66714",
    "2048": "69670",
    "2049": "73140",
    "2050": "76539"
  },
  {
    "Age": "70-74",
    "2022": "15516",
    "2023": "16603",
    "2024": "17585",
    "2025": "18922",
    "2026": "19795",
    "2027": "21932",
    "2028": "23864",
    "2029": "26462",
    "2030": "29034",
    "2031": "31769",
    "2032": "34094",
    "2033": "35797",
    "2034": "37230",
    "2035": "38141",
    "2036": "39010",
    "2037": "39308",
    "2038": "39742",
    "2039": "40528",
    "2040": "41174",
    "2041": "42255",
    "2042": "44012",
    "2043": "45907",
    "2044": "47044",
    "2045": "48598",
    "2046": "49684",
    "2047": "50789",
    "2048": "51762",
    "2049": "53132",
    "2050": "55161"
  },
  {
    "Age": "75-79",
    "2022": "7666",
    "2023": "8163",
    "2024": "8890",
    "2025": "9807",
    "2026": "11295",
    "2027": "12072",
    "2028": "12960",
    "2029": "13749",
    "2030": "14836",
    "2031": "15589",
    "2032": "17346",
    "2033": "18947",
    "2034": "21083",
    "2035": "23209",
    "2036": "25471",
    "2037": "27437",
    "2038": "28883",
    "2039": "30138",
    "2040": "30972",
    "2041": "31799",
    "2042": "32162",
    "2043": "32619",
    "2044": "33400",
    "2045": "34045",
    "2046": "35081",
    "2047": "36678",
    "2048": "38371",
    "2049": "39427",
    "2050": "40824"
  },
  {
    "Age": "80-84",
    "2022": "5088",
    "2023": "5367",
    "2024": "5360",
    "2025": "5234",
    "2026": "5145",
    "2027": "5133",
    "2028": "5536",
    "2029": "6064",
    "2030": "6706",
    "2031": "7765",
    "2032": "8319",
    "2033": "8987",
    "2034": "9574",
    "2035": "10391",
    "2036": "11002",
    "2037": "12332",
    "2038": "13558",
    "2039": "15169",
    "2040": "16786",
    "2041": "18506",
    "2042": "20040",
    "2043": "21175",
    "2044": "22201",
    "2045": "22920",
    "2046": "23662",
    "2047": "24060",
    "2048": "24509",
    "2049": "25234",
    "2050": "25832"
  },
  {
    "Age": "85+",
    "2022": "3594",
    "2023": "3581",
    "2024": "3594",
    "2025": "3635",
    "2026": "3719",
    "2027": "4002",
    "2028": "4158",
    "2029": "4166",
    "2030": "4129",
    "2031": "4147",
    "2032": "4339",
    "2033": "4706",
    "2034": "5056",
    "2035": "5444",
    "2036": "6128",
    "2037": "6591",
    "2038": "7239",
    "2039": "7815",
    "2040": "8562",
    "2041": "9361",
    "2042": "10484",
    "2043": "11651",
    "2044": "13022",
    "2045": "14505",
    "2046": "16084",
    "2047": "17752",
    "2048": "19169",
    "2049": "20651",
    "2050": "21995"
  }
]

# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_city_region, gender='ayol').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_city_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='ayol',
                    population=population
                )

print("Navoi female data import completed successfully!")
