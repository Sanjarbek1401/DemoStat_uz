import os
import django

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from dashboard_app.models import Region, StatisticsData
from django.db import transaction

# First, get or create the Navoi region
tashkent_city_region, _ = Region.objects.get_or_create(name='Samarqand', defaults={'svg_id': 'samarkand'})

# Data to be imported
navoi_male_data =[
  {
    "Age": "Total",
    "2022": "4031324",
    "2023": "4120850",
    "2024": "4209687",
    "2025": "4297013",
    "2026": "4382984",
    "2027": "4467428",
    "2028": "4550136",
    "2029": "4631276",
    "2030": "4710270",
    "2031": "4786755",
    "2032": "4860456",
    "2033": "4931340",
    "2034": "4999496",
    "2035": "5064652",
    "2036": "5127250",
    "2037": "5187336",
    "2038": "5245506",
    "2039": "5302065",
    "2040": "5357419",
    "2041": "5412171",
    "2042": "5467131",
    "2043": "5522867",
    "2044": "5579647",
    "2045": "5637662",
    "2046": "5697243",
    "2047": "5758354",
    "2048": "5820854",
    "2049": "5884622",
    "2050": "5949368"
  },
  {
    "Age": "0-4",
    "2022": "476579",
    "2023": "504078",
    "2024": "524686",
    "2025": "540921",
    "2026": "552640",
    "2027": "557581",
    "2028": "554944",
    "2029": "551195",
    "2030": "546620",
    "2031": "540749",
    "2032": "533500",
    "2033": "525076",
    "2034": "515415",
    "2035": "504830",
    "2036": "494136",
    "2037": "483699",
    "2038": "474157",
    "2039": "465727",
    "2040": "459127",
    "2041": "454488",
    "2042": "452565",
    "2043": "453314",
    "2044": "456706",
    "2045": "462520",
    "2046": "470490",
    "2047": "479774",
    "2048": "489678",
    "2049": "499826",
    "2050": "509729"
  },
  {
    "Age": "5-9",
    "2022": "414759",
    "2023": "421465",
    "2024": "432269",
    "2025": "441053",
    "2026": "453484",
    "2027": "472552",
    "2028": "499647",
    "2029": "519936",
    "2030": "535968",
    "2031": "547587",
    "2032": "552545",
    "2033": "550024",
    "2034": "546431",
    "2035": "542031",
    "2036": "536354",
    "2037": "529320",
    "2038": "521125",
    "2039": "511709",
    "2040": "501377",
    "2041": "490937",
    "2042": "480749",
    "2043": "471444",
    "2044": "463232",
    "2045": "456824",
    "2046": "452346",
    "2047": "450546",
    "2048": "451377",
    "2049": "454813",
    "2050": "460636"
  },
  {
    "Age": "10-14",
    "2022": "376032",
    "2023": "383721",
    "2024": "384580",
    "2025": "393638",
    "2026": "402500",
    "2027": "412078",
    "2028": "418672",
    "2029": "429366",
    "2030": "438041",
    "2031": "450334",
    "2032": "469194",
    "2033": "496036",
    "2034": "516127",
    "2035": "532036",
    "2036": "543604",
    "2037": "548593",
    "2038": "546173",
    "2039": "542711",
    "2040": "538453",
    "2041": "532934",
    "2042": "526075",
    "2043": "518071",
    "2044": "508859",
    "2045": "498739",
    "2046": "488509",
    "2047": "478521",
    "2048": "469401",
    "2049": "461352",
    "2050": "455083"
  },
  {
    "Age": "15-19",
    "2022": "313663",
    "2023": "320171",
    "2024": "339257",
    "2025": "352958",
    "2026": "366591",
    "2027": "373333",
    "2028": "380918",
    "2029": "381742",
    "2030": "390755",
    "2031": "399555",
    "2032": "409072",
    "2033": "415604",
    "2034": "426225",
    "2035": "434844",
    "2036": "447059",
    "2037": "465767",
    "2038": "492389",
    "2039": "512296",
    "2040": "528082",
    "2041": "539582",
    "2042": "544584",
    "2043": "542268",
    "2044": "538949",
    "2045": "534846",
    "2046": "529492",
    "2047": "522806",
    "2048": "514982",
    "2049": "505955",
    "2050": "496020"
  },
  {
    "Age": "20-24",
    "2022": "311250",
    "2023": "302193",
    "2024": "301369",
    "2025": "300474",
    "2026": "303374",
    "2027": "311145",
    "2028": "317430",
    "2029": "336094",
    "2030": "349314",
    "2031": "362523",
    "2032": "368978",
    "2033": "376457",
    "2034": "377362",
    "2035": "386399",
    "2036": "395094",
    "2037": "404427",
    "2038": "410773",
    "2039": "421260",
    "2040": "429814",
    "2041": "441899",
    "2042": "460246",
    "2043": "486326",
    "2044": "505755",
    "2045": "521195",
    "2046": "532500",
    "2047": "537555",
    "2048": "535521",
    "2049": "532560",
    "2050": "528814"
  },
  {
    "Age": "25-29",
    "2022": "373731",
    "2023": "366022",
    "2024": "351383",
    "2025": "339523",
    "2026": "321855",
    "2027": "308881",
    "2028": "300377",
    "2029": "299854",
    "2030": "299138",
    "2031": "302055",
    "2032": "309673",
    "2033": "315626",
    "2034": "333704",
    "2035": "346371",
    "2036": "359212",
    "2037": "365513",
    "2038": "372980",
    "2039": "373922",
    "2040": "382842",
    "2041": "391346",
    "2042": "400555",
    "2043": "406853",
    "2044": "417258",
    "2045": "425690",
    "2046": "437517",
    "2047": "455340",
    "2048": "480727",
    "2049": "499600",
    "2050": "514697"
  },
  {
    "Age": "30-34",
    "2022": "356486",
    "2023": "363109",
    "2024": "364977",
    "2025": "368942",
    "2026": "372457",
    "2027": "367597",
    "2028": "360341",
    "2029": "346382",
    "2030": "335280",
    "2031": "318444",
    "2032": "306194",
    "2033": "298182",
    "2034": "297915",
    "2035": "297348",
    "2036": "300280",
    "2037": "307786",
    "2038": "313508",
    "2039": "331166",
    "2040": "343455",
    "2041": "356050",
    "2042": "362261",
    "2043": "369738",
    "2044": "370750",
    "2045": "379640",
    "2046": "388068",
    "2047": "397227",
    "2048": "403490",
    "2049": "413799",
    "2050": "422099"
  },
  {
    "Age": "35-39",
    "2022": "306309",
    "2023": "319470",
    "2024": "331737",
    "2025": "337706",
    "2026": "343394",
    "2027": "349497",
    "2028": "355915",
    "2029": "357721",
    "2030": "361663",
    "2031": "365249",
    "2032": "360691",
    "2033": "353930",
    "2034": "340612",
    "2035": "330182",
    "2036": "314060",
    "2037": "302413",
    "2038": "294805",
    "2039": "294741",
    "2040": "294305",
    "2041": "297262",
    "2042": "304698",
    "2043": "310273",
    "2044": "327621",
    "2045": "339640",
    "2046": "352065",
    "2047": "358227",
    "2048": "365714",
    "2049": "366780",
    "2050": "375610"
  },
  {
    "Age": "40-44",
    "2022": "236641",
    "2023": "247748",
    "2024": "258161",
    "2025": "270959",
    "2026": "285454",
    "2027": "300338",
    "2028": "313065",
    "2029": "325014",
    "2030": "330839",
    "2031": "336435",
    "2032": "342448",
    "2033": "348808",
    "2034": "350660",
    "2035": "354641",
    "2036": "358312",
    "2037": "354014",
    "2038": "347653",
    "2039": "334848",
    "2040": "324933",
    "2041": "309371",
    "2042": "298189",
    "2043": "290906",
    "2044": "291011",
    "2045": "290702",
    "2046": "293699",
    "2047": "301091",
    "2048": "306565",
    "2049": "323655",
    "2050": "335455"
  },
  {
    "Age": "45-49",
    "2022": "197628",
    "2023": "202529",
    "2024": "209254",
    "2025": "216386",
    "2026": "223755",
    "2027": "231968",
    "2028": "242772",
    "2029": "252897",
    "2030": "265367",
    "2031": "279502",
    "2032": "294041",
    "2033": "306485",
    "2034": "318212",
    "2035": "323955",
    "2036": "329510",
    "2037": "335483",
    "2038": "341815",
    "2039": "343721",
    "2040": "347734",
    "2041": "351473",
    "2042": "347413",
    "2043": "341394",
    "2044": "329022",
    "2045": "319538",
    "2046": "304474",
    "2047": "293700",
    "2048": "286712",
    "2049": "286943",
    "2050": "286734"
  },
  {
    "Age": "50-54",
    "2022": "167441",
    "2023": "171375",
    "2024": "174623",
    "2025": "181288",
    "2026": "186711",
    "2027": "192596",
    "2028": "197366",
    "2029": "203924",
    "2030": "210884",
    "2031": "218078",
    "2032": "226110",
    "2033": "236658",
    "2034": "246541",
    "2035": "258719",
    "2036": "272521",
    "2037": "286733",
    "2038": "298912",
    "2039": "310411",
    "2040": "316078",
    "2041": "321596",
    "2042": "327549",
    "2043": "333861",
    "2044": "335842",
    "2045": "339892",
    "2046": "343699",
    "2047": "339888",
    "2048": "334201",
    "2049": "322242",
    "2050": "313155"
  },
  {
    "Age": "55-59",
    "2022": "164669",
    "2023": "162415",
    "2024": "161124",
    "2025": "158555",
    "2026": "158548",
    "2027": "161144",
    "2028": "164979",
    "2029": "168137",
    "2030": "174577",
    "2031": "179829",
    "2032": "185580",
    "2033": "190246",
    "2034": "196639",
    "2035": "203424",
    "2036": "210437",
    "2037": "218283",
    "2038": "228535",
    "2039": "238144",
    "2040": "249981",
    "2041": "263394",
    "2042": "277223",
    "2043": "289089",
    "2044": "300307",
    "2045": "305886",
    "2046": "311368",
    "2047": "317311",
    "2048": "323595",
    "2049": "325652",
    "2050": "329710"
  },
  {
    "Age": "60-64",
    "2022": "143884",
    "2023": "149773",
    "2024": "153087",
    "2025": "154441",
    "2026": "154956",
    "2027": "153948",
    "2028": "151952",
    "2029": "150922",
    "2030": "148649",
    "2031": "148812",
    "2032": "151419",
    "2033": "155164",
    "2034": "158249",
    "2035": "164411",
    "2036": "169464",
    "2037": "175056",
    "2038": "179603",
    "2039": "185788",
    "2040": "192348",
    "2041": "199124",
    "2042": "206732",
    "2043": "216592",
    "2044": "225846",
    "2045": "237237",
    "2046": "250133",
    "2047": "263453",
    "2048": "274892",
    "2049": "285703",
    "2050": "291136"
  },
  {
    "Age": "65-69",
    "2022": "90165",
    "2023": "97107",
    "2024": "106484",
    "2025": "114975",
    "2026": "122661",
    "2027": "128768",
    "2028": "134162",
    "2029": "137284",
    "2030": "138677",
    "2031": "139355",
    "2032": "138680",
    "2033": "137101",
    "2034": "136457",
    "2035": "134620",
    "2036": "135036",
    "2037": "137669",
    "2038": "141308",
    "2039": "144319",
    "2040": "150129",
    "2041": "154940",
    "2042": "160319",
    "2043": "164715",
    "2044": "170627",
    "2045": "176895",
    "2046": "183363",
    "2047": "190649",
    "2048": "199983",
    "2049": "208759",
    "2050": "219539"
  },
  {
    "Age": "70-74",
    "2022": "53742",
    "2023": "57653",
    "2024": "61141",
    "2025": "65406",
    "2026": "69148",
    "2027": "76487",
    "2028": "82515",
    "2029": "90638",
    "2030": "98036",
    "2031": "104777",
    "2032": "110232",
    "2033": "115094",
    "2034": "118037",
    "2035": "119513",
    "2036": "120401",
    "2037": "120127",
    "2038": "119044",
    "2039": "118833",
    "2040": "117499",
    "2041": "118182",
    "2042": "120813",
    "2043": "124299",
    "2044": "127215",
    "2045": "132579",
    "2046": "137081",
    "2047": "142168",
    "2048": "146349",
    "2049": "151884",
    "2050": "157749"
  },
  {
    "Age": "75-79",
    "2022": "26624",
    "2023": "28289",
    "2024": "30886",
    "2025": "34608",
    "2026": "39253",
    "2027": "41410",
    "2028": "44583",
    "2029": "47378",
    "2030": "50865",
    "2031": "54034",
    "2032": "60014",
    "2033": "64993",
    "2034": "71644",
    "2035": "77763",
    "2036": "83385",
    "2037": "88057",
    "2038": "92255",
    "2039": "94952",
    "2040": "96470",
    "2041": "97538",
    "2042": "97673",
    "2043": "97122",
    "2044": "97351",
    "2045": "96562",
    "2046": "97505",
    "2047": "100071",
    "2048": "103298",
    "2049": "106030",
    "2050": "110765"
  },
  {
    "Age": "80-84",
    "2022": "15271",
    "2023": "16780",
    "2024": "17175",
    "2025": "17083",
    "2026": "17361",
    "2027": "17608",
    "2028": "18940",
    "2029": "20789",
    "2030": "23381",
    "2031": "26670",
    "2032": "28223",
    "2033": "30592",
    "2034": "32659",
    "2035": "35294",
    "2036": "37794",
    "2037": "42264",
    "2038": "46060",
    "2039": "51069",
    "2040": "55730",
    "2041": "60057",
    "2042": "63769",
    "2043": "67142",
    "2044": "69455",
    "2045": "70913",
    "2046": "72064",
    "2047": "72535",
    "2048": "72466",
    "2049": "73044",
    "2050": "72763"
  },
  {
    "Age": "85+",
    "2022": "6450",
    "2023": "6954",
    "2024": "7494",
    "2025": "8098",
    "2026": "8841",
    "2027": "10495",
    "2028": "11560",
    "2029": "12004",
    "2030": "12216",
    "2031": "12768",
    "2032": "13862",
    "2033": "15265",
    "2034": "16605",
    "2035": "18272",
    "2036": "20588",
    "2037": "22134",
    "2038": "24411",
    "2039": "26448",
    "2040": "29060",
    "2041": "31997",
    "2042": "35719",
    "2043": "39460",
    "2044": "43844",
    "2045": "48365",
    "2046": "52870",
    "2047": "57493",
    "2048": "61902",
    "2049": "66024",
    "2050": "69676"
  }
]
# Convert age ranges to min/max values
def get_age_min_max(age_str):
    if age_str == "Total":
        return 0, None  # For total population, use 0 as min age
    elif age_str == "85+":
        return 85, None
    elif '-' in age_str:
        age_parts = age_str.split('-')
        return int(age_parts[0]), int(age_parts[1])
    return None, None

# Delete existing Navoi male data
StatisticsData.objects.filter(region=tashkent_city_region, gender='jami').delete()

# Import new data
with transaction.atomic():
    for entry in navoi_male_data:
        age_min, age_max = get_age_min_max(entry['Age'])
        for year in range(2021, 2051):
            year_str = str(year)
            if year_str in entry:
                population = int(entry[year_str])
                StatisticsData.objects.create(
                    region=tashkent_city_region,
                    year=year,
                    age_min=age_min,
                    age_max=age_max,
                    gender='jami',
                    population=population
                )

print("Navoi female data import completed successfully!")
